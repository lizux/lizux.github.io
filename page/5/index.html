<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Personal Blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Lizux">
<meta property="og:url" content="http://example.com/page/5/index.html">
<meta property="og:site_name" content="Lizux">
<meta property="og:description" content="Personal Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="可口可乐">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Lizux</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Lizux</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Just go on</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/30/15.http/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="可口可乐">
      <meta itemprop="description" content="Personal Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lizux">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/09/30/15.http/" class="post-title-link" itemprop="url">AngularJS 的 跨域请求</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2015-09-30 00:00:00" itemprop="dateCreated datePublished" datetime="2015-09-30T00:00:00+08:00">2015-09-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-10-26 10:32:58" itemprop="dateModified" datetime="2023-10-26T10:32:58+08:00">2023-10-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>前端开发中经常用到跨域请求，我们目前有这几种实现方式：</p>
<ul>
<li>CORS：支持 POST 请求，需要服务器端设置（<code>Access-Control-Allow-Origin: *</code>），使用 AJAX</li>
<li>JSONP：仅支持 GET 请求，需要服务器返回 callback 封装，不使用 AJAX</li>
<li>iframe：目前比较少用，主流使用上述两种</li>
<li>反向代理：利用 Apache、Nginx 服务器，需要配置，适合本地开发调试</li>
</ul>
<p>现在重点讲讲前两种方式在 AngularJS 中的实现方式：</p>
<h2 id="CORS-之-GET-方式"><a href="#CORS-之-GET-方式" class="headerlink" title="CORS 之 GET 方式"></a>CORS 之 GET 方式</h2><p>通过 GET 方式查询，查询数据用字符串序列的方式附加在 URL 地址后</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$http(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;http://api.openweathermap.org/data/2.5/find&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: &#123;</span><br><span class="line">        <span class="attr">q</span>: $scope.<span class="property">locate</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;).<span class="title function_">success</span>(<span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="CORS-之-POST-方式"><a href="#CORS-之-POST-方式" class="headerlink" title="CORS 之 POST 方式"></a>CORS 之 POST 方式</h2><p>通过 POST 方式查询，AngularJS 默认使用请求头——<code>Content-Type: application/json</code>，查询数据使用 JSON 格式对象来传递，这样很多服务器无法正确接受数据。<br>我们可以修改为 jQuery 常用的请求头——<code>Content-Type: x-www-form-urlencodedand</code> 和数据格式——字符串序列（”foo&#x3D;bar&amp;baz&#x3D;moe”）</p>
<p>全局方式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myApp = angular.<span class="title function_">module</span>(<span class="string">&#x27;myApp&#x27;</span>, [])</span><br><span class="line">    .<span class="title function_">config</span>([<span class="string">&#x27;$httpProvider&#x27;</span>, <span class="keyword">function</span>(<span class="params">$httpProvider</span>) &#123;</span><br><span class="line">        $httpProvider.<span class="property">defaults</span>.<span class="property">headers</span>.<span class="property">post</span>[<span class="string">&#x27;Content-Type&#x27;</span>] = <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>;</span><br><span class="line">        $httpProvider.<span class="property">defaults</span>.<span class="property">transformRequest</span> = [</span><br><span class="line">            <span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> angular.<span class="title function_">isObject</span>(data) &amp;&amp; <span class="title class_">String</span>(data) !== <span class="string">&#x27;[object File]&#x27;</span> ? $.<span class="title function_">param</span>(data) : data;</span><br><span class="line">            &#125;</span><br><span class="line">        ];</span><br><span class="line">    &#125;]);</span><br></pre></td></tr></table></figure>

<p>局部方式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$http(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 用来跨域提交 POST 参数（并序列化）</span></span><br><span class="line">    <span class="attr">headers</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">transformRequest</span>: <span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> $.<span class="title function_">param</span>(data);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;http://www.geonames.org/postalCodeLookupJSON&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">country</span>: <span class="string">&#x27;US&#x27;</span>,</span><br><span class="line">        <span class="attr">postalcode</span>: <span class="number">10504</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;).<span class="title function_">success</span>(<span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="JSONP-方式"><a href="#JSONP-方式" class="headerlink" title="JSONP 方式"></a>JSONP 方式</h2><p>AngularJS 的 JSOP 方式只需要按 API 接口的要求填写回调对应的字段名（如下文 callback）即可，回调函数名必须为 “JSON_CALLBACK”，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$http(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;JSONP&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;http://api.openweathermap.org/data/2.5/find&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: &#123;</span><br><span class="line">        <span class="attr">callback</span>: <span class="string">&#x27;JSON_CALLBACK&#x27;</span>,</span><br><span class="line">        <span class="attr">q</span>: $scope.<span class="property">locate</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;).<span class="title function_">success</span>(<span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/29/14.css-tips/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="可口可乐">
      <meta itemprop="description" content="Personal Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lizux">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/09/29/14.css-tips/" class="post-title-link" itemprop="url">CSS 技巧及最佳实践汇总</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2015-09-29 00:00:00" itemprop="dateCreated datePublished" datetime="2015-09-29T00:00:00+08:00">2015-09-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-10-26 10:32:58" itemprop="dateModified" datetime="2023-10-26T10:32:58+08:00">2023-10-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="CSS-选择符优先级"><a href="#CSS-选择符优先级" class="headerlink" title="CSS 选择符优先级"></a>CSS 选择符优先级</h2><p>!important 声明＞内联样式（style）＞ id 选择符（#id）＞类选择符（.class）＝伪类选择符（:hover ）＝属性选择符（[attr] ）＞类型选择符（标签）＝伪元素选择符（:first-child）</p>
<h2 id="sticky-定位问题"><a href="#sticky-定位问题" class="headerlink" title="sticky 定位问题"></a>sticky 定位问题</h2><p>sticky 定位的元素受父级块级元素影响，其宽度继承的是父级的宽度，另外其只能显示在父级的内容区，当滚动距离超过其父级的高度时，即超过内容区后，其也会相应得被推出可视区域，使用时要注意。<br>注：sticky 元素的父级元素不能含有 overflow:hidden 和 overflow:auto 属性。</p>
<h2 id="display-inline-block-详解及兼容性方法"><a href="#display-inline-block-详解及兼容性方法" class="headerlink" title="display:inline-block 详解及兼容性方法"></a>display:inline-block 详解及兼容性方法</h2><p>2002 年 W3C 推出 CSS2.1 规范时，给 <a target="_blank" rel="noopener" href="http://www.w3.org/TR/CSS21/visuren.html#display-prop">元素的 display 属性增加了 inline-block 值</a>。其作用是 “这个值导致一个元素产生一个块状盒模型（block box），而本身作为单一的内联盒模型（inline box）流动排列（flow）”。即 display 为 inline-block 的元素既可以像块状元素一样定义高度宽度，又可以和内联元素（比如文字）排列在一行。<br>这个效果在页面设计的时候，很多地方都可以带来便利，最常见的莫过于在对链接进行 “以图换字” 时，既可以像内联元素那样实现一行排列，又可以设置像块状元素那样设置单个链接大小，还可以通过 text-indent 来隐藏文字显示背景图片。<br>现在对于 inline-block 属性运用的需求也越来越多，可惜依旧只有 Firefox、Safari&#x2F;Chrome、Opera、IE8+ 支持。但 IE6、7 可以通过触发 hasLayout 属性来模拟（因为 inline-block 会触发 IE 的 hasLayout，从而使内联元素具有类似 inline-block 元素的属性）。<del>Firefox2 有 -moz-inline-box 和 -moz-inline-stack 私有属性，在实际应用中两者都有一些 bug：-moz-inline-box 会存在 text-align（无法水平居中 &#x2F; 居右，使用 -moz-box-pack:center&#x2F;end 来修正）、line-height（无法垂直居中，使用 -moz-box-align:center 来修正）等属性无效的问题; 而相对来说 -moz-inline-stack 的表现好些，但也有 bug：如果元素的父级元素具有 display:inline 属性则会使 Firefox 中其包含的链接不可点击，这个需要对元素用 position:relative 来解决，另外 text-align、line-height 等属性无效，目前无法修正）。</del></p>
<p>兼容实现方法：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">display</span>: inline-block; <span class="comment">/* 支持现代浏览器、IE8+，另外也能让 IE6、7 触发内联元素的 hasLayout */</span></span><br><span class="line">*<span class="attribute">display</span>: inline;</span><br><span class="line">zoom: <span class="number">1</span>; <span class="comment">/* 这两个属性在 IE6、7 中让块状元素实现 display:inline-block 的效果 */</span></span><br><span class="line"><span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">100px</span>; <span class="comment">/* 这两个属性为任意非 auto 值 */</span></span><br><span class="line"><span class="attribute">text-indent</span>: -<span class="number">999em</span>; <span class="comment">/* 现代浏览器中隐藏文字 */</span></span><br><span class="line"><span class="attribute">font</span>: <span class="number">0</span>/<span class="number">0</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="attribute">overflow</span>: hidden; <span class="comment">/* 这两个属性任选其一配合上文，实现 IE 隐藏文字 */</span></span><br><span class="line"><span class="attribute">vertical-align</span>: middle; <span class="comment">/* 垂直居中，防止与其他内联元素有比较大的偏离 */</span></span><br></pre></td></tr></table></figure>

<h2 id="“垂直居中”-之研究"><a href="#“垂直居中”-之研究" class="headerlink" title="“垂直居中” 之研究"></a>“垂直居中” 之研究</h2><p>使用一个 100% 高的隐藏元素来辅助，设置 vertical-align 迫使内容区垂直居中，支持图片、多行文字（不固定高度），是目前兼容性最好的方法</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;vertical-center&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;text-wrap&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>text<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>text<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;vertical-center&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.vertical-center</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.text-wrap</span> &#123;</span><br><span class="line">    <span class="comment">/* 对于文本需要多包一层 */</span></span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    *<span class="attribute">display</span>: inline;</span><br><span class="line">    *zoom: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="纯-CSS-实现自适应布局下的宽高固定比例"><a href="#纯-CSS-实现自适应布局下的宽高固定比例" class="headerlink" title="纯 CSS 实现自适应布局下的宽高固定比例"></a>纯 CSS 实现自适应布局下的宽高固定比例</h2><p>在某些场景下，在宽度自适应的情况下需要高度和宽度成比例缩放，比如 1：1 的正方形图片展示之类。</p>
<h3 id="针对纯图片展示的简单解决方案："><a href="#针对纯图片展示的简单解决方案：" class="headerlink" title="针对纯图片展示的简单解决方案："></a>针对纯图片展示的简单解决方案：</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;some&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">padding-bottom</span>: <span class="number">75%</span>; // <span class="number">4</span>:<span class="number">3</span></span><br><span class="line">    content: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="针对其他场景的完全解决方案："><a href="#针对其他场景的完全解决方案：" class="headerlink" title="针对其他场景的完全解决方案："></a>针对其他场景的完全解决方案：</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span>Aspect ratio of 1:1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">padding-bottom</span>: <span class="number">100%</span>; // <span class="number">1</span>:<span class="number">1</span></span><br><span class="line">    content: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.content</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="iOS-设备下-iframe-内容无法滚动的问题"><a href="#iOS-设备下-iframe-内容无法滚动的问题" class="headerlink" title="iOS 设备下 iframe 内容无法滚动的问题"></a>iOS 设备下 iframe 内容无法滚动的问题</h2><p>很长时间以来，iOS 设备上 Safari 中超出边界的元素将不能滚动，这时候需要用个小技巧来解决这个问题。<br>html 代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ios-scroll&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">height</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">frameborder</span>=<span class="string">&quot;0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注：外部包围 iframe 的容器必须有明确的高度值</p>
</blockquote>
<p>css 代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.ios-scroll</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">overflow</span>-scrolling: touch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="禁止双击时选择页面内容"><a href="#禁止双击时选择页面内容" class="headerlink" title="禁止双击时选择页面内容"></a>禁止双击时选择页面内容</h2><p>在做图片滚动时，在双击左右箭头，快速切换图片滚动时，会选择附近区域的文字，感觉不是很好。<br>针对这个问题可以对相应的元素添加 <code>onselectstart=&quot;return false;&quot;</code>（IE、Chrome），另外针对火狐添加 <code>-moz-user-select:none</code>，即代码如下所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onselectstart</span>=<span class="string">&quot;return false;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;-moz-user-select:none;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="如何去除点击链接或按钮时出现的虚线？"><a href="#如何去除点击链接或按钮时出现的虚线？" class="headerlink" title="如何去除点击链接或按钮时出现的虚线？"></a>如何去除点击链接或按钮时出现的虚线？</h2><p>有时候在点击链接或者按钮的时，总有一个虚线框在触发元素上，显得特别刺眼（如用 a 标签 做 Tab 切换），那如何去除这个虚线框呢？</p>
<p>在 IE 中，需要在元素的 html 代码中加入 hidefocus&#x3D;”true” 属性。即：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://www.china.com&quot;</span> <span class="attr">hidefocus</span>=<span class="string">&quot;true&quot;</span>&gt;</span>china<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>或者在直接给元素定义样式：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">position</span>: relative; <span class="comment">/* 这是 IE 下的一个 bug，在自身或父级元素定义该样式会导致按钮或链接点击时失去虚线，刚好实现了我们需要的效果，有时无效 */</span></span><br><span class="line">blr: <span class="built_in">expression</span>(this.onFocus=this.<span class="built_in">blur</span>()); <span class="comment">/* 会反复执行，有严重的效率问题，不推荐使用 */</span></span><br></pre></td></tr></table></figure>

<p>而在 Firefox 等浏览器中则相对比较容易，直接给元素定义样式 <code>outline:none;</code> 就可以了，另外针对 Firefox 的 input&#x2F;button 元素要通过私有属性特别处理：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">button</span>::-moz-focus-inner,</span><br><span class="line">input::-moz-focus-inner &#123;</span><br><span class="line">    <span class="attribute">border-color</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="多行文字两端对齐"><a href="#多行文字两端对齐" class="headerlink" title="多行文字两端对齐"></a>多行文字两端对齐</h2><p>多行文字尤其是表单的 label 标签，因为字数不一，却要两端排版对齐。</p>
<p>正确的做法是 text-align:justify。但是还需要加上 CSS3 草案的 text-justify:distribute 。<br>这种做法存在的问题是：除了 IE 之外，尚无浏览器实现 text-justify:distribute。且 IE 必须还加上 text-align-last:justify。<br>是的，尽管 IE 常为我们所不齿，但是在文字排版和国际化方面，IE 是做的最好的。仅就两端分布对齐这个特例而言，IE 领先了其他浏览器 10 年以上。</p>
<p>这样综合下来，有如下代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">display</span>: block;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">5em</span>;</span><br><span class="line"><span class="attribute">text-align</span>: justify;</span><br><span class="line"><span class="attribute">text-align</span>: end; <span class="comment">/* 对于除了 IE 之外的浏览器用尾对齐覆盖之前的两端对齐方式 */</span></span><br><span class="line"><span class="attribute">text-align-last</span>: justify;</span><br><span class="line"><span class="attribute">text-justify</span>: distribute;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在 IE 和将来正确实现 CSS3-text 模块的浏览器中将两端分布对齐。<br>在当前除 IE 以外的主流浏览器中将右对齐，作为合理的 fallback。</p>
</blockquote>
<h2 id="以图换字的思路及方法"><a href="#以图换字的思路及方法" class="headerlink" title="以图换字的思路及方法"></a>以图换字的思路及方法</h2><p>做网页的时候经常会遇到个问题：想让普通文字链接显示个性化的图片，就要对链接使用背景图片，同时让链接里的文字消失，这就需要用到 “以图换字”（Fahrner Image Replacement），就是用图片替换文字表现。</p>
<p>具体方法是位置移动：也就是让内容进行位置移动，移出显示区之外。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;logo&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;URL&quot;</span> <span class="attr">title</span>=<span class="string">&quot;标题&quot;</span>&gt;</span>标题内容<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.logo</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.logo</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">background</span>: URL;</span><br><span class="line">    <span class="attribute">text-indent</span>: -<span class="number">999em</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>扩展阅读：<a target="_blank" rel="noopener" href="http://www.mezzoblue.com/tests/revised-image-replacement/">Revised Image Replacement</a> 上有更丰富的方法。</p>
<h2 id="用-CSS-Border-实现三角形的思路及方法"><a href="#用-CSS-Border-实现三角形的思路及方法" class="headerlink" title="用 CSS Border 实现三角形的思路及方法"></a>用 CSS Border 实现三角形的思路及方法</h2><p>在盒模型中，上下左右边框交界处出会呈现平滑的斜线。利用这个特点，通过设置不同的上下左右边框宽度或者颜色可以得到小三角，小梯形等。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;triangle&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;triangle2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">font</span>: <span class="number">0</span>/<span class="number">0</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="attribute">border</span>: <span class="number">10px</span> dashed transparent; <span class="comment">/* IE6 下，设置边框的 border-style 为 dashed，即可达到透明的效果 */</span></span><br><span class="line"><span class="attribute">border-bottom</span>: <span class="number">10px</span> solid <span class="number">#ff9600</span>;</span><br></pre></td></tr></table></figure>

<h2 id="用-CSS-实现梯形角标时在-Firefox-下出现奇异白线的问题及解决方法"><a href="#用-CSS-实现梯形角标时在-Firefox-下出现奇异白线的问题及解决方法" class="headerlink" title="用 CSS 实现梯形角标时在 Firefox 下出现奇异白线的问题及解决方法"></a>用 CSS 实现梯形角标时在 Firefox 下出现奇异白线的问题及解决方法</h2><p>利用上条的思路，可以实现在容器上显示梯形角标：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#f60</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">left</span>: -<span class="number">27px</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">60px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">18px</span> solid transparent;</span><br><span class="line">    <span class="attribute">border-bottom-color</span>: <span class="number">#f60</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">45deg</span>);</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是在 Firefox 下会在梯形两端各出现一条白线，经确认是 Firefox 对 rotate 支持的 bug。<br>可以使用如下代码修复：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">45deg</span>) <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1px</span>);</span><br></pre></td></tr></table></figure>

<h2 id="清除（闭合）浮动"><a href="#清除（闭合）浮动" class="headerlink" title="清除（闭合）浮动"></a>清除（闭合）浮动</h2><p>按照 CSS 规范，浮动元素（floats）会被移出文档流，不会影响到块状元素的布局而只会影响内联元素（通常是文本）的排列。因此当其高度超出父级元素时，一般父级元素不会自动伸展以适应内容的高度，从而造成内容溢出影响破坏布局的现象。这种现象叫“浮动溢出”或者“高度塌陷”，如何避免？</p>
<p>解决方法：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zoom: <span class="number">1</span>; <span class="comment">/* 针对 IE，触发 hasLayout */</span></span><br><span class="line"><span class="attribute">overflow</span>: hidden; <span class="comment">/* 针对现代浏览器 */</span></span><br></pre></td></tr></table></figure>

<p>注：overflow:hidden 用来布局容易出问题，一是很可能造成其内部的浮动层显示不全（致命伤）；二是在某些情况下会造成双击空白处全选（没总结出规律，偶尔会出现）。此外，某些时候还会造成性能问题。</p>
<p>这时，现代浏览器可以使用以下方法</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.clear</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-class">.clear</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: table; <span class="comment">/* 不用 block，而是用 table 的原因是用于 :before 可以触发 BFC，从而避免父级与第一个子级元素外边界合并。 */</span></span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27; &#x27;</span>; <span class="comment">/* 为了避免 Opera 的 bug，否则它会在被清除浮动的元素的顶部和底部产生一个可见空格 */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clear</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">    <span class="attribute">clear</span>: both;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另一种方法就是在父级元素内最后面插入一个额外的标签，并令其清除浮动以撑开父级元素。这种方法优点是兼容性好，缺点是需要额外的无语义的标签</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.clear</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">clear</span>: both;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="强制文本自动换行和不换行的方法"><a href="#强制文本自动换行和不换行的方法" class="headerlink" title="强制文本自动换行和不换行的方法"></a>强制文本自动换行和不换行的方法</h2><p>防止文本撑破页面，强制自动换行：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">word-wrap</span>: break-word; <span class="comment">/* 可以把长单词强行断句；首先起一个新行来放置长单词，新的行还是放不下这个长单词则会对长单词进行强制断句（IE、Firefox3.5、Chrome、Opera 支持）。CSS3 中已经改名为 overflow-wrap（Chrome、Opera 支持）。 */</span></span><br><span class="line"><span class="attribute">word-break</span>: break-all; <span class="comment">/* 可以把长单词强行断句；不会把长单词放在一个新行里，当这一行放不下的时候就直接强制断句（IE、Firefox15、Chrome 支持）。 */</span></span><br><span class="line"><span class="attribute">table-layout</span>: fixed; <span class="comment">/* 针对 table 上使用，但是有副作用，会导致 td 宽度平均分配 */</span></span><br></pre></td></tr></table></figure>

<p>强制&lt;pre&gt;换行：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pre &#123;</span><br><span class="line">    <span class="attribute">word-wrap</span>: break-word; <span class="comment">/* IE6+ */</span></span><br><span class="line">    <span class="attribute">white-space</span>: pre-wrap; <span class="comment">/* CSS3 属性, Firefox、Safari/Chrome、Opera、IE8 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注：强制文本不换行可以使用：<code>white-space:nowrap;</code></p>
<h2 id="IE-的-“hasLayout”-模式研究"><a href="#IE-的-“hasLayout”-模式研究" class="headerlink" title="IE 的 “hasLayout” 模式研究"></a>IE 的 “hasLayout” 模式研究</h2><h3 id="“hasLayout”-模式"><a href="#“hasLayout”-模式" class="headerlink" title="“hasLayout” 模式"></a>“hasLayout” 模式</h3><p>hasLayout 是 Windows Internet Explorer 渲染引擎的一个内部组成部分。在 IE 中，一个元素要么自己对自身的内容进行计算尺寸和组织，要么依赖于父元素来计算尺寸和组织内容。为了调节这两个不同的概念，渲染引擎采用了 hasLayout 的属性，属性值可以为 true 或 false。<br>当一个元素的 hasLayout 属性值为 true 时，我们说这个元素有一个布局（Layout）。当一个元素有一个布局时，它负责对自己和可能的子孙元素进行尺寸计算和定位，而不是依赖于祖先元素来完成这些工作。<br>IE6、7 上的很多布局方面 Bug 都是和这个属性有关或者可以用这个属性解决的。</p>
<h3 id="触发-“hasLayout”"><a href="#触发-“hasLayout”" class="headerlink" title="触发 “hasLayout”"></a>触发 “hasLayout”</h3><ul>
<li>body、img、table、tr、th、td 等元素的 hasLayout 一直为 true。</li>
<li>type 为 text、button、file 或 select 的 input 的 hasLayout 一直为 true。</li>
<li>设置 {position:absolute} 的元素的 hasLayout 为 true。</li>
<li>设置 {float:left|right} 的元素的 hasLayout 为 true。</li>
<li>设置 {display:inline-block} 的元素的 hasLayout 为 true。</li>
<li>设置 {height:xx} 或 {width:xx} 的元素必须具备以下两个条件之一，其 hasLayout 才能为 true：<ol>
<li>IE8 兼容模式和 IE8 以前的浏览器中，在标准 (strict) 模式下其 display 的值是 block。</li>
<li>元素在怪异模式（Quirks mode）下。</li>
</ol>
</li>
<li>设置了 {zoom:xx} 的元素在 IE8 的兼容模式或 IE8 之前的浏览器中其 hasLayout 为 true，但在 IE8 的标准模式下则不会触发 hasLayout。</li>
<li>设置了 {writing-mode:tb-rl} 的元素的 hasLayout 为 true。</li>
<li>元素的 contentEditable 的属性值为 true。</li>
<li>在 IE8 标准模式下设置了 {display:block} 的元素的 hasLayout 一直为 true。</li>
</ul>
<h2 id="防止链接变成一次链接"><a href="#防止链接变成一次链接" class="headerlink" title="防止链接变成一次链接"></a>防止链接变成一次链接</h2><p>所谓伪类就是指依赖于浏览器或是用户的状态。对于链接来讲，存在 link，hover，visited，active 四种状态，即四种伪类选择器：a:link（存在链接，但无鼠标动作），a:visited（被点击或访问过），a:hover（鼠标悬停于链接上时的状态），a:active（鼠标点击与释放之间的状态）。<br>CSS 便是以这几个伪类选择器实现了其为数不多的动态效果。目前最为常用的就是导航条和按钮的动态显示。</p>
<p>在使用链接的伪类选择器时，一般会发现链接点击一次后，会永远显示 visited 状态，没有办法表示 hover、active 了，所以我们要解决这个 “一次性按钮” 问题。<br>将样式表里面链接四种伪类选择器顺序修改成为：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">link</span><br><span class="line">visited</span><br><span class="line">hover</span><br><span class="line">active</span><br></pre></td></tr></table></figure>

<p>顺序这样，后面的优先级大于前面的，就行了。</p>
<p>之所以排在后面的优先级大，是因为浏览器读取 CSS 文件时是自上而下的。<br>但这并不是充分条件。visited，hover，active 这三种状态不是独立的，它们存在交集。<br>比方说一个按钮，如果它被点击过，而且你正点击这个按钮，那么这个按钮既是 visited，也是 active，而且因为鼠标悬于按钮之上，所以它也处在 hover 的状态。那么这个时候，你把 CSS 文件中的 visited 置于最后的话，那么 hover 和 active 两种状态的属性都会被 visited 的属性所覆盖而不显示。<br>同理，active 必须置于 hover 之后才能显示其属性。</p>
<p>要点：</p>
<ol>
<li>visited 必须置于 hover 和 active 之上；</li>
<li>active 必须置于 hover 之后；</li>
<li>link 的位置无所谓，所以你只需保证 VHA 的顺序即可。</li>
</ol>
<p>所以我们一般设置 a 的样式时候，都是按照 LVHA（简记为 LoVeHAte）的顺序来进行设置，可以避免出现上述的 bug。</p>
<h2 id="导航按钮下划线动画"><a href="#导航按钮下划线动画" class="headerlink" title="导航按钮下划线动画"></a>导航按钮下划线动画</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.btn-hover</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">    &amp;<span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">z-index</span>: -<span class="number">1</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">2px</span>;</span><br><span class="line">        <span class="attribute">background</span>: <span class="number">#3fa7d6</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale3d</span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="attribute">transform-origin</span>: <span class="number">100%</span> <span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">transition</span>: transform <span class="number">0.5s</span>;</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        &amp;<span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">            <span class="attribute">transform</span>: <span class="built_in">scale3d</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="attribute">transform-origin</span>: <span class="number">0%</span> <span class="number">50%</span>;</span><br><span class="line">            <span class="attribute">transition-timing-function</span>: ease-in;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="扩展到全屏的过渡动画"><a href="#扩展到全屏的过渡动画" class="headerlink" title="扩展到全屏的过渡动画"></a>扩展到全屏的过渡动画</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.enter-page</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1000</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#3fa7d6</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">transform-origin</span>: <span class="number">30%</span> <span class="number">5%</span>;</span><br><span class="line">    <span class="attribute">animation</span>: full-page-from <span class="number">0.5s</span> ease-in <span class="number">0s</span> both;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.enter-page</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: full-page-to <span class="number">0.5s</span> ease-out <span class="number">0s</span> both;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> full-page-to &#123;</span><br><span class="line">    <span class="number">0%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> full-page-from &#123;</span><br><span class="line">    <span class="number">0%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="隐藏滚动条，鼠标移上再显示"><a href="#隐藏滚动条，鼠标移上再显示" class="headerlink" title="隐藏滚动条，鼠标移上再显示"></a>隐藏滚动条，鼠标移上再显示</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">600px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid green;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 方案1 */</span></span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: auto;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">padding-right</span>: <span class="number">17px</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: content-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 方案2 */</span></span><br><span class="line"><span class="selector-class">.container-anthor</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: auto;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: -<span class="number">17px</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>; <span class="comment">/* 方案2 */</span></span><br><span class="line">    <span class="attribute">padding-right</span>: <span class="number">0</span>; <span class="comment">/* 方案1 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="表头固定"><a href="#表头固定" class="headerlink" title="表头固定"></a>表头固定</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">table</span><span class="selector-class">.fixed_header</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">border-collapse</span>: collapse;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">table</span><span class="selector-class">.fixed_header</span> <span class="selector-tag">thead</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">table</span><span class="selector-class">.fixed_header</span> <span class="selector-tag">tbody</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">overflow</span>: auto;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">table</span><span class="selector-class">.fixed_header</span> <span class="selector-tag">tr</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: table;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">table</span><span class="selector-class">.fixed_header</span> <span class="selector-tag">th</span>,</span><br><span class="line"><span class="selector-tag">table</span><span class="selector-class">.fixed_header</span> <span class="selector-tag">td</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">20%</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="毛玻璃效果"><a href="#毛玻璃效果" class="headerlink" title="毛玻璃效果"></a>毛玻璃效果</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;mainWrap&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>1. 对元素直接使用模糊滤镜会影响其内部文本，所以为了保证文字清晰需要多加一个层(伪元素)单独应用模糊滤镜。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>2. 模糊滤镜并不会应用到其背后的元素上，所以需要把内容元素设置成与主体元素相同的背景图并进行模糊。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.mainWrap</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">900px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.mainWrap</span>,</span><br><span class="line"><span class="selector-class">.content</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">&#x27;http://csssecrets.io/images/tiger.jpg&#x27;</span>) center; <span class="comment">/* 主体元素和内容元素设置相同的背景图 */</span></span><br><span class="line">    <span class="attribute">background-size</span>: cover;</span><br><span class="line">    <span class="attribute">background-attachment</span>: fixed; <span class="comment">/* 为了解决主体元素和内容元素背景图拼接的问题，但是带来的副作用就是图片不能 cover 适配主体元素，而是适配视窗了 */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.content</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden; <span class="comment">/* 为了解决在扩大伪元素模糊效果的同时超出内容元素范围的问题 */</span></span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">0</span>; <span class="comment">/* 为了不使内容元素隐藏到伪元素背景图的后面 */</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">800px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: -<span class="number">200px</span> <span class="number">0</span> <span class="number">0</span> -<span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>);</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.content</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>; <span class="comment">/* 伪元素不能通过 width/height:100% 来继承宿主（内容元素）的尺寸，所以通过上述方式来继承 */</span></span><br><span class="line">    <span class="attribute">z-index</span>: -<span class="number">1</span>; <span class="comment">/* 为了使伪元素位于宿主的下面 */</span></span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">20px</span>); <span class="comment">/* 模糊滤镜 */</span></span><br><span class="line">    <span class="attribute">margin</span>: -<span class="number">30px</span>; <span class="comment">/* 为了解决边缘模糊效果减弱的问题，将伪元素的范围扩大 */</span></span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="左栏定宽，右栏自适应的布局"><a href="#左栏定宽，右栏自适应的布局" class="headerlink" title="左栏定宽，右栏自适应的布局"></a>左栏定宽，右栏自适应的布局</h2><p>方法一：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto <span class="number">0</span> <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.sidebar</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>方法二：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">padding-right</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> -<span class="number">200px</span> <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.sidebar</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="两个根元素的视口高度和内容高度必须在-height-100-情况下才有效"><a href="#两个根元素的视口高度和内容高度必须在-height-100-情况下才有效" class="headerlink" title="两个根元素的视口高度和内容高度必须在 height:100% 情况下才有效"></a>两个根元素的视口高度和内容高度必须在 height:100% 情况下才有效</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">console.log(1, document.documentElement.scrollHeight, document.body.scrollHeight);</span><br><span class="line">console.log(2, document.documentElement.clientHeight, document.body.clientHeight, window.innerHeight);</span><br></pre></td></tr></table></figure>

<h2 id="让元素绕着圆形弧线旋转"><a href="#让元素绕着圆形弧线旋转" class="headerlink" title="让元素绕着圆形弧线旋转"></a>让元素绕着圆形弧线旋转</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@keyframes spin &#123;</span><br><span class="line">    from &#123;</span><br><span class="line">    	transform: rotate(0turn) translateY(-100px) translateY(50%) rotate(1turn);</span><br><span class="line">    &#125;</span><br><span class="line">    to &#123;</span><br><span class="line">    	transform: rotate(1turn) translateY(-100px) translateY(50%) rotate(0turn);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">.clock &#123;</span><br><span class="line">	animation: spin 5s infinite linear;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="页面所有元素随机加彩色边框"><a href="#页面所有元素随机加彩色边框" class="headerlink" title="页面所有元素随机加彩色边框"></a>页面所有元素随机加彩色边框</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[].forEach.call($$(&#x27;*&#x27;),function(a)&#123;a.style.outline=&quot;1px solid #&quot;+(~~(Math.random()*(1&lt;&lt;24))).toString(16)&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>对于没有设置 z-index 的普通层来说，如果设置了小于 1 的 opacity 属性，该层就会显示在其他层上面。</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/28/13.css/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="可口可乐">
      <meta itemprop="description" content="Personal Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lizux">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/09/28/13.css/" class="post-title-link" itemprop="url">CSS Filters(过滤器) 兼容性列表</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2015-09-28 00:00:00" itemprop="dateCreated datePublished" datetime="2015-09-28T00:00:00+08:00">2015-09-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-10-26 10:32:58" itemprop="dateModified" datetime="2023-10-26T10:32:58+08:00">2023-10-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>CSS 浏览器兼容性列表，可以根据不同浏览器的表现写出针对性的语句以解决不统一不兼容的问题。<br>这些规则都是我根据多年的工作实践总结、并验证过的。<br>希望随着现代浏览器的发展以及 IE 浏览器市场份额的减少，这份表的作用越来越小。</p>
<blockquote>
<p>注：规则 &#x3D; 选择器 {声明 &#x3D; 属性：值}<br>rules &#x3D; selector {declaration &#x3D; property:value}</p>
</blockquote>
<table>
<thead>
<tr>
<th></th>
<th>IE6</th>
<th>IE7</th>
<th>IE8</th>
<th>IE9&#x2F;10&#x2F;11</th>
<th>Firefox</th>
<th>Chrome</th>
<th>Safari</th>
</tr>
</thead>
<tbody><tr>
<td>_<i>property:value</i></td>
<td>&#10004;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>* html <i>rules</i></td>
<td>&#10004;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>*+html <i>rules</i></td>
<td>&nbsp;</td>
<td>&#10004;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>*<i>property:value</i><sup>1</sup></td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>html* <i>rules</i></td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&#10004;</td>
</tr>
<tr>
<td><i>property:value</i>\9</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>○<sup>7</sup></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td><i>property:value</i>\0</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td><i>property:value</i>\0&#x2F;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&#10004;</td>
<td>○<sup>6</sup></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td><i>property:value</i> !important</td>
<td>○<sup>2</sup></td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
</tr>
<tr>
<td><i>property</i> &#x2F;**&#x2F;<i>:value</i></td>
<td>&nbsp;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
</tr>
<tr>
<td>*+body <i>rules</i></td>
<td>&nbsp;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
</tr>
<tr>
<td>:root <i>rules</i><sup>3</sup></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
</tr>
<tr>
<td>body:last-child <i>rules</i></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
<td>&#10004;</td>
</tr>
<tr>
<td>@media all and (min-width:0px) {<i>rules</i>}</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&#10004;</td>
<td>&#10004;<sup>4</sup></td>
<td>&#10004;</td>
<td>&#10004;</td>
</tr>
<tr>
<td>@media all and (-webkit-min-device-pixel-ratio:0) {<i>rules</i>}</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&#10004;</td>
<td>&#10004;</td>
</tr>
<tr>
<td>html*~&#x2F;**&#x2F;body <i>rules</i></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&#10004;</td>
</tr>
<tr>
<td><i>selector</i>,x:-moz-any-link {<i>property:value</i>}</td>
<td>&nbsp;</td>
<td>&#10004;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&#10004;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td><i>selector</i>,x:-moz-any-link,x:default {<i>property:value</i>}</td>
<td>&nbsp;</td>
<td>&#10004;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&#10004;<sup>5</sup></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody></table>
<ul>
<li>注 [1]：此处的 * 号其实也可以是. 号、&gt; 号、+ 号和 #号。由于它们都不属于 CSS2.1 规范合法属性名的一部分，所以不能通过 W3C 验证</li>
<li>注 [2]：IE6 对 !important 的支持比较怪异，它首先在同一规则中，按声明的先后顺序计算优先级，然后在不同规则中认为使用 !important 的声明优先级最大</li>
<li>注 [3]：该规则有优先级，其低于类（class）选择符，高于类型（标签）选择符</li>
<li>注 [4]：FF3 不支持，FF3.5+ 支持</li>
<li>注 [5]：FF2 不支持，FF3+ 支持</li>
<li>注 [6]：不支持 background 属性</li>
<li>注 [7]：IE11 不支持</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/25/12.ecma09/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="可口可乐">
      <meta itemprop="description" content="Personal Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lizux">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/09/25/12.ecma09/" class="post-title-link" itemprop="url">JavaScript 读书心得之九：数据检索（XMLHttpRequest）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2015-09-25 00:00:00" itemprop="dateCreated datePublished" datetime="2015-09-25T00:00:00+08:00">2015-09-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-10-26 10:32:58" itemprop="dateModified" datetime="2023-10-26T10:32:58+08:00">2023-10-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="不刷新页面之-AJAX"><a href="#不刷新页面之-AJAX" class="headerlink" title="不刷新页面之 AJAX"></a>不刷新页面之 AJAX</h2><p>有时候，我们需要在不刷新页面的情况下从服务器检索数据，这就用到了 XMLHttpRequest 对象，所有浏览器都支持它（IE6- 把它作为一个 ActiveX 对象，其他浏览器则把它作为原生对象，内建了对它的支持），我们把这种技术叫 AJAX（Asynchronous Javascript And XML）</p>
<blockquote>
<p>注：XMLHttpRequest 是 Ajax 应用程序中使用的基本对象。听起来它似乎是为通过 HTTP 请求发送 XML 或者以某种 XML 格式发出 HTTP 请求而设计的。但实际上它要做的只不过是为客户端脚本提供一种发送 HTTP 请求的方式，仅此而已。XMLHttpRequest 对象更多的是在不重新加载页面的情况下发出请求，而不会太多地涉及 XML 甚至 HTTP。所以它的更准确的名称应该为 HttpRequest。</p>
</blockquote>
<h2 id="不刷新页面之-iframe"><a href="#不刷新页面之-iframe" class="headerlink" title="不刷新页面之 iframe"></a>不刷新页面之 iframe</h2><p>不刷新页面检索数据也可以使用隐藏帧技术（包括 frame 和 iframe），实现原理就是创建一个包含用于客户端—服务器通信的隐藏帧，当主页面进行数据提交时，通过对隐藏帧的 JavaScript 函数调用，使得隐藏帧对服务器进行请求和处理响应，并把响应数据返回给主页面。</p>
<p>优点：它可以维护浏览器的历史，使用户仍然能够使用浏览器上的后退和前进按钮。浏览器由于并不知道隐藏帧实际上被隐藏了，但对于其所发出的请求仍然是记录在案的。由于主页面没有修改，而只有在隐藏帧中的修改，这意味着后退和前进按钮将依据该隐藏帧的访问历史而非主页面而变化。这也是为什么 Gmail 和 Google Maps 仍然使用该技术的理由。注：iframe 并非一直会存储浏览器的历史记录。尽管 IE 始终会存储 iframe 的历史记录，但 Firefox 只对使用 HTML 定义（也就是不包括使用 JavaScript 动态创建）的 iframe 保存历史记录。Safari 从不为 iframe 保存历史记录，不管它们是如何包含在该页面中的。</p>
<p>缺点：对其背后发生的事了解甚少。它完全依赖于返回的正确页面。如果隐藏帧的页面载入失败，并不会向用户提示出错消息，主页面将继续等待直到调用适当的 JavaScript 函数。必须通过设置一个较长周期（可能是 5 分钟）的超时时间，然后如果页面仍然没有成功载入则显示一条消息，以给用户一个安慰。但这一切都只是一个变通方法，最主要的问题是，对于后台发生的 HTTP 请求缺乏充足的信息。这是它不如 XMLHttpRequest 的地方。</p>
<h2 id="HTTP-请求"><a href="#HTTP-请求" class="headerlink" title="HTTP 请求"></a>HTTP 请求</h2><p>通过 XMLHttpRequest 对象发送 HTTP 请求需要以下四个步骤：<br>0. 创建一个 XMLHttpRequest 对象<br>0. 指示该对象打开一个新请求（调用 open() 方法）<br>0. 指示该对象如何处理服务器的返回数据（绑定 readystatechange 事件处理函数）<br>0. 指示该对象发送请求（调用 send() 方法）</p>
<h3 id="创建-XMLHttpRequest-对象"><a href="#创建-XMLHttpRequest-对象" class="headerlink" title="创建 XMLHttpRequest 对象"></a>创建 XMLHttpRequest 对象</h3><p>首先创建一个数组，它包含了创建 XMLHttpRequest 对象的所有可能方式所对应的函数。首先尝试创建原生对象，其次尝试创建 ActiveX 对象，MSXML2、MSXML3、Microsoft 都是对象可能的名字，它们哪个可用取决于用户的系统配置而不是浏览器</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">XMLHttps</span> = [</span><br><span class="line">    <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>() &#125;,</span><br><span class="line">    <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;MSXML2.XMLHTTP&quot;</span>) &#125;,</span><br><span class="line">    <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;MSXML3.XMLHTTP&quot;</span>) &#125;,</span><br><span class="line">    <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;Microsoft.XMLHTTP&quot;</span>) &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>其次使用函数遍历数组尝试每种方式，如果其中之一成功就会创建一个 XMLHttpRequest 对象，而所有都失败的话，返回 false</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createXMLHttp</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> xmlhttp = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="title class_">XMLHttps</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            xmlhttp = <span class="title class_">XMLHttps</span>[i]();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> xmlhttp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注：最近学习到 jquery 的写法，可以一行创建 XMLHttpRequest 对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xmlhttp = <span class="variable language_">window</span>.<span class="property">ActiveXObject</span> ? <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;Microsoft.XMLHTTP&quot;</span>) : <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br></pre></td></tr></table></figure>

<h3 id="打开新请求"><a href="#打开新请求" class="headerlink" title="打开新请求"></a>打开新请求</h3><p>使用 open() 方法打开一个新请求，这是为发送请求而做的准备</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlhttp.<span class="title function_">open</span>(method,url,<span class="literal">true</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>method 参数定义请求的方法：GET、POST 或 HEAD。GET 是把数据作为查询字符串追加在 URL 上；POST 是让数据随着 HTTP 请求的正文发送；HEAD 是请求只返回 HTTP 响应的头信息，而不是文件本身，偶尔会用到它</li>
<li>url 参数定义将被下载的文件路径</li>
<li>最后一个参数是告诉浏览器使用异步请求（true）还是同步请求（false）</li>
</ul>
<h3 id="指定数据返回时的处理动作"><a href="#指定数据返回时的处理动作" class="headerlink" title="指定数据返回时的处理动作"></a>指定数据返回时的处理动作</h3><p>调用 open() 方法后，应该指定当返回数据（响应信息）时浏览器的处理动作，这时要使用 <code>readystatechange</code> 事件来绑定事件处理函数<br>这时需要了解 HTTP 就绪状态，它表示请求的状态或情形。用于确定该请求是否已经开始、是否得到了响应或者请求 &#x2F; 响应模型是否已经完成。还可以帮助确定读取服务器提供的响应文本或数据是否安全。</p>
<blockquote>
<p>共有五种就绪状态：</p>
</blockquote>
<table>
<thead>
<tr>
<th>值</th>
<th>传统值</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>uninitialized</td>
<td>未初始化（已创建对象，但还没有调用 open() 方法）</td>
</tr>
<tr>
<td>1</td>
<td>loading</td>
<td>加载中（已调用 open() 方法，但还没有调用 send() 方法）</td>
</tr>
<tr>
<td>2</td>
<td>loaded</td>
<td>已加载（已调用 send() 方法，但服务器还没有响应即状态和头信息不可用）</td>
</tr>
<tr>
<td>3</td>
<td>interactive</td>
<td>交互（已经接收到部分响应信息）注：IE 不支持</td>
</tr>
<tr>
<td>4</td>
<td>complete</td>
<td>完成（所有响应信息接收完毕）</td>
</tr>
</tbody></table>
<p>每当 HTTP 就绪状态改变时它都会触发 readystatechange 事件</p>
<blockquote>
<p>注：readystatechange 事件的 type 属性在 IE 中为 load，而不是 readystatechange</p>
</blockquote>
<h3 id="发送请求"><a href="#发送请求" class="headerlink" title="发送请求"></a>发送请求</h3><p>调用 open() 方法并设置了 readystatechange 事件处理函数后，就可以发送请求了<br><code>xmlhttp.send(date);</code><br>请求时需要一个参数。如果使用 POST 方法，参数就是传递的数据；如果是 GET 方法，参数为 null</p>
<h3 id="上述四步的综合应用"><a href="#上述四步的综合应用" class="headerlink" title="上述四步的综合应用"></a>上述四步的综合应用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhrStates = [<span class="string">&quot;正在初始化……&quot;</span>,<span class="string">&quot;正在初始化请求…… 成功！&quot;</span>,<span class="string">&quot;正在发送请求…… 成功！&quot;</span>,<span class="string">&quot;正在接收数据…… 完成！&quot;</span>,<span class="string">&quot;正在解析数据…… 完成！&quot;</span>];</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendRequest</span>(<span class="params">url, callback, postData</span>) &#123;</span><br><span class="line">    <span class="comment">// 首先创建一个 XMLHttpRequest 对象</span></span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="variable language_">window</span>.<span class="property">ActiveXObject</span> ? <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;Microsoft.XMLHTTP&quot;</span>) : <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">    <span class="keyword">if</span> (!xhr) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 检查 postData 参数是否存在。存在，设置请求方法为 POST；不存在，设置为 GET</span></span><br><span class="line">    <span class="keyword">var</span> method = (postData) ? <span class="string">&quot;POST&quot;</span> : <span class="string">&quot;GET&quot;</span>;</span><br><span class="line">    xhr.<span class="title function_">open</span>(method,url,<span class="literal">true</span>);</span><br><span class="line">    <span class="comment">// 使用 setRequestHeader() 方法可以设置 HTTP 请求的头信息：http://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html#sec5.3</span></span><br><span class="line">    <span class="comment">// 这里设置 User-Agent 头信息为 XMLHTTP，便于服务器端的脚本分辨出 XMLHttp 请求和其他普通请求</span></span><br><span class="line">    xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;User-Agent&#x27;</span>,<span class="string">&#x27;XMLHTTP&#x27;</span>);</span><br><span class="line">    <span class="comment">// 使用 POST 方法时，必须设置如下一个头信息</span></span><br><span class="line">    <span class="keyword">if</span> (postData) &#123;</span><br><span class="line">        xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;Content-type&#x27;</span>,<span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 绑定 readystatechange 事件处理函数来处理响应信息</span></span><br><span class="line">    xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">// 该对象请求的就绪状态发生变化时，处理程序被触发，首先就是查看 readyState 值，如果响应未完成（不为 4），则返回</span></span><br><span class="line">        <span class="keyword">if</span> (xhr.<span class="property">readyState</span> != <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="comment">//return;</span></span><br><span class="line">            <span class="title function_">alert</span>(xhrStates[xhr.<span class="property">readyState</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 其次查看 status 属性，它包含服务器返回的 HTTP 响应的状态码，正常时返回值为 200（Opera 中有时为 304），本地测试时返回值为 0：http://www.w3.org/Protocols/rfc2616/rfc2616-sec6.html#sec6.1.1、http://en.wikipedia.org/wiki/List_of_HTTP_status_codes</span></span><br><span class="line">        <span class="comment">// 如果不正常，则返回</span></span><br><span class="line">        <span class="keyword">if</span> (xhr.<span class="property">status</span> != <span class="number">200</span> &amp;&amp; xhr.<span class="property">status</span> != <span class="number">304</span> &amp;&amp; xhr.<span class="property">status</span> != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&#x27;HTTP error &#x27;</span> + xhr.<span class="property">status</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">callback</span>(xhr);</span><br><span class="line">        <span class="comment">// 销毁，防止内存泄漏</span></span><br><span class="line">        xhr = <span class="literal">null</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 检查 XMLHttpRequest 对象的 readyState 值，如果等于 4，说明文档已经存在于浏览器的缓存中，就不需要发送请求了。因为在 IE 中，请求一个存在于浏览器缓存中的文件时，会在发送请求前触发事件处理函数</span></span><br><span class="line">    <span class="keyword">if</span> (xhr.<span class="property">readyState</span> == <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    xhr.<span class="title function_">send</span>(postData);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="取消-HTTP-请求"><a href="#取消-HTTP-请求" class="headerlink" title="取消 HTTP 请求"></a>取消 HTTP 请求</h2><p>当对一个已经正在下载响应信息的 XMLHttpRequest 对象进行其他操作时，它会忽略之前的工作状态而开始下载新响应信息。唯一例外的是 Firefox，它需要先调用 abort() 方法<br>在调用 abort() 方法前，应该先移除 readystatechange 事件处理函数，因为 IE 和 Firefox 即使在取消请求后也会触发这个事件处理函数</p>
<blockquote>
<p> 注：在 IE 中，不能设置为 null，只能设置为空函数</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xmlhttp.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;;</span><br><span class="line">xmlhttp.<span class="title function_">abort</span>();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：当使用了 abort() 方法，Firefox 中的 responseXML 属性就会消失，所以不推荐使用 abort() 方法</p>
</blockquote>
<h2 id="处理响应信息"><a href="#处理响应信息" class="headerlink" title="处理响应信息"></a>处理响应信息</h2><p>发送请求后，等待事件响应，一旦服务器返回响应信息且被正常接受时，指定的事件处理函数就被触发，执行其处理动作。</p>
<blockquote>
<p>如下，发送一个 GET 请求到 ajax.php，并附带参数 queryString 作为查询字符串，tackleData() 作为事件处理函数：<br><code>sendRequest(&#39;ajax.php&#39;+queryString,tackleData);</code></p>
</blockquote>
<p>处理响应信息时，首先要读取数据，XMLHttpRequest 对象有两个属性：<code>responseText</code>、<code>responseXML</code>，分别以文本和 XML 文档的形式保存数据，它们都可以使用 W3C DOM 方法来读取。</p>
<p>另外，XMLHttpRequest 对象还有两个方法：<code>getResponseHeader()</code>、<code>getAllResponseHeaders()</code>，可以分别读取服务器返回的某个指定的 HTTP 响应的头信息或完整列表。HTTP 头信息完整列表（包括 HTTP 请求和 HTTP 响应）：<a target="_blank" rel="noopener" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html">W3C</a>、<a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/List_of_HTTP_headers">WIKI</a>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> lastModified = xmlhttp.<span class="title function_">getResponseHeader</span>(<span class="string">&quot;Last-Modified&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> allHeaders = xmlhttp.<span class="title function_">getAllResponseHeaders</span>();</span><br></pre></td></tr></table></figure>

<h3 id="响应信息的格式"><a href="#响应信息的格式" class="headerlink" title="响应信息的格式"></a>响应信息的格式</h3><p>一共有四种：XML、HTML、JSON、CSV</p>
<ol start="0">
<li><p>使用 responseXML 返回 XML 文档<br> 必须在返回文档是 XML 时可用，即声明它的 MIME 文件类型为 “text&#x2F;xml” 注，现在不推荐使用，而是用 “<a target="_blank" rel="noopener" href="http://annevankesteren.nl/2004/08/mime-types">application&#x2F;xml</a>”）<br> 当把所有 HTML 文档都设置为 “text&#x2F;xml” 时，会遇到问题，因为，任何非 XMLHttp 请求的 HTML 文档必须设置为 “text&#x2F;html” 才能被浏览器正确显示<br> 这也就是前面设置 User-Agent 头信息为 XMLHTTP 的原因：服务器端的脚本如果识别出该头信息，就能以 text&#x2F;xml 格式返回 HTML 文档，而不是 text&#x2F;html</p>
<p> 优点：对 XML 文件可以完全沿用 W3C DOM 方法和属性，而不需要学习新知识<br> 缺点：创建包含这些数据的 HTML 结构时，服务器端的响应脚本和浏览器端的解析脚本变得相当冗长</p>
<p> XML 文档格式</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">message</span>&gt;</span>You are make a mistake!<span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">speed</span>&gt;</span>200<span class="tag">&lt;/<span class="name">speed</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xml</span>&gt;</span></span><br></pre></td></tr></table></figure>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">tackleData</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> returnData = obj.<span class="property">responseXML</span>;</span><br><span class="line">    <span class="keyword">if</span> (!returnData) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 可以使用 W3C DOM 方法来读取响应信息</span></span><br><span class="line">    <span class="keyword">var</span> message = returnData.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;message&#x27;</span>)[<span class="number">0</span>].<span class="property">firstChild</span>;</span><br><span class="line">    <span class="keyword">var</span> speed = returnData.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;speed&#x27;</span>)[<span class="number">0</span>].<span class="property">firstChild</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 responseText 返回 HTML 文档<br> 优点：最具可访问性的格式<br> 缺点：不适合需要脚本操作响应信息而不是直接显示结果的应用</p>
<p> HTML 文档格式</p>
 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>You are make a mistake!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">tackleData</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> returnData = obj.<span class="property">responseText</span>;</span><br><span class="line">    <span class="keyword">if</span> (!returnData) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 可以方便把响应信息加入到 HTML 文档中去</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;msg&quot;</span>).<span class="property">innerHTML</span> = returnData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 responseText 返回 JSON 文档<br> 它返回一个解释为 JavaScript 对象的字符串，该字符串是使用对象字面量方式创建的</p>
<p> 优点：更为便捷的数据访问途径；非冗长性<br> 缺点：JSON 丢失了 XML 具有的一些特性如命名空间；由于 JSON 采用冒号赋值，这将导致当 XML 转化为 JSON 时，在标识符与实际属性值之间很难区分谁应该被当作文本考虑；对语法要求严格</p>
<p> JSON 文档格式</p>
 <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span><span class="string">&quot;You are make a mistake!&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span><span class="number">200</span>;</span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">tackleData</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> returnData = <span class="built_in">eval</span>(<span class="string">&quot;(&quot;</span>+obj.<span class="property">responseText</span>+<span class="string">&quot;)&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!returnData) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 可以方便读取响应信息</span></span><br><span class="line">    <span class="keyword">var</span> message = returnData.<span class="property">message</span>;</span><br><span class="line">    <span class="keyword">var</span> speed = returnData.<span class="property">speed</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 responseText 返回 CSV 文档<br> 它返回一个以逗号为分隔符的字符串<br> CSV（Comma-Separated Values），逗号分隔文本，是一种经常用来作为不同程序之间的数据交互格式</p>
<p> 优点：最简短和高效的数据格式，各类编程语言都支持它<br> 缺点：数据读取时无法包含数据的提示或元数据，如 message、speed 之类的标签或属性名，只能靠位置来读取它们，要求服务器端和浏览器端的配合度比较高</p>
<p> CSV 文档格式</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You are make a mistake!,200</span><br></pre></td></tr></table></figure>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">tackleData</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> returnData = obj.<span class="property">responseText</span>.<span class="title function_">split</span>(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!returnData) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 只能靠位置来读取响应信息</span></span><br><span class="line">    <span class="keyword">var</span> message = returnData[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">var</span> speed = returnData[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="一般规则"><a href="#一般规则" class="headerlink" title="一般规则"></a>一般规则</h3><p>注：可以统一访问 XMLHttpRequest.response 属性获得响应信息。</p>
<ul>
<li>需要添加大块数据到 HTML 文档中，使用 HTML 格式，它是最简单的格式</li>
<li>如果项目庞大复杂，需要多位程序员紧密协作，使用 XML 格式，它是最通用的格式</li>
<li>需要遍历一段冗长的响应信息去搜索一块很小的数据，使用 XML 或 JSON 格式，它是最快速的格式</li>
<li>不推荐使用 CSV 格式，因为它缺少元数据</li>
<li>注：在目前流行的 RESTful 架构中，推荐使用 JSON 格式，数据简洁，处理快速。</li>
</ul>
<h2 id="可访问性"><a href="#可访问性" class="headerlink" title="可访问性"></a>可访问性</h2><p>随着 Ajax 的广泛应用，在可访问性方面面临一个问题：在 JavaScript 被禁用的情况下，保持该应用能够被访问是一项艰苦的工作</p>
<p>HTML 格式是仅有的一个具有可访问性及可自我访问的。可以使用：先按普通方法来构建应用，然后用 JavaScript 截获请求，改用 XMLHttp 请求来实现的方法，以此缓解响应信息和可访问性的关系<br>参看：Jeremy Keith 发明的 <a target="_blank" rel="noopener" href="http://domscripting.com/blog/display/41">Hijax 方法</a></p>
<p>而对其他三种格式的，由于它们都不是可自我访问的，所以只能采取折衷的方案：</p>
<ol>
<li>保证使用 XMLHttp 请求的都是锦上添花的内容，而把基本的功能都留在 HTML 中，使任何人都可以访问</li>
<li>创建两个服务器端的脚本：一个针对 XMLHttp 请求返回 XML（或 JSON），另外一个针对普通请求返回纯文本的 HTML 文档；通过检查 User-Agent 头信息的值是否是 “XMLHTTP” 就可以区分这两种请求</li>
</ol>
<p>对没有使用 HTML 的 XMLHttpRequest 应用，目前没有什么好的提高可访问性的方法</p>
<h2 id="跨域请求实现的方式"><a href="#跨域请求实现的方式" class="headerlink" title="跨域请求实现的方式"></a>跨域请求实现的方式</h2><ul>
<li><p>JSONP：仅支持 GET 请求，需要服务器返回 callback 封装（Firefox-&gt;console 无法查看，因为没有使用 XMLHttpRequest 对象）</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">jsonp</span>(<span class="params">url, callback, params</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> callbackName = <span class="string">&#x27;jsonp_callback_&#x27;</span> + <span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="number">100000</span> * <span class="title class_">Math</span>.<span class="title function_">random</span>());</span><br><span class="line">    <span class="variable language_">window</span>[callbackName] = <span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">        <span class="keyword">delete</span> <span class="variable language_">window</span>[callbackName];</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(script);</span><br><span class="line">        <span class="title function_">callback</span>(data);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">    params[params.<span class="property">callback_name</span>] = callbackName;</span><br><span class="line">    script.<span class="property">src</span> = url + (url.<span class="title function_">indexOf</span>(<span class="string">&#x27;?&#x27;</span>) &gt;= <span class="number">0</span> ? <span class="string">&#x27;&amp;&#x27;</span> : <span class="string">&#x27;?&#x27;</span>) + <span class="title function_">param</span>(params);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">jsonp</span>(<span class="string">&#x27;http://openapi.baidu.com/public/2.0/bmt/translate&#x27;</span>, <span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data.<span class="property">trans_result</span>[<span class="number">0</span>]);</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    <span class="attr">callback_name</span>: <span class="string">&#x27;callback&#x27;</span>, <span class="comment">//API 接口的回调函数名称，封装用</span></span><br><span class="line">    <span class="attr">client_id</span>: <span class="string">&#x27;2ALMz6WqUEcsBg4BS91Eppq3&#x27;</span>,</span><br><span class="line">    <span class="attr">from</span>: <span class="string">&#x27;auto&#x27;</span>,</span><br><span class="line">    <span class="attr">to</span>: <span class="string">&#x27;auto&#x27;</span>,</span><br><span class="line">    <span class="attr">q</span>: <span class="string">&#x27;show&#x27;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>CORS：支持 POST 请求，需要服务器端设置 Access-Control-Allow-Origin: *（Firebug-&gt; 响应头信息）</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createCORSRequest</span>(<span class="params">method, url</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;withCredentials&quot;</span> <span class="keyword">in</span> xhr) &#123;</span><br><span class="line">        xhr.<span class="title function_">open</span>(method, url, <span class="literal">true</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="title class_">XDomainRequest</span> != <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">        xhr = <span class="keyword">new</span> <span class="title class_">XDomainRequest</span>();</span><br><span class="line">        xhr.<span class="title function_">open</span>(method, url);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        xhr = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> xhr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">makeCorsRequest</span>(<span class="params">url, callback, postData</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> method = (postData) ? <span class="string">&quot;POST&quot;</span> : <span class="string">&quot;GET&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="title function_">createCORSRequest</span>(method, url + <span class="string">&#x27;?&#x27;</span> + <span class="title function_">param</span>(postData));</span><br><span class="line">    <span class="keyword">if</span> (!xhr) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;CORS not supported&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    xhr.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">callback</span>(xhr.<span class="property">response</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.<span class="property">onerror</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.<span class="title function_">send</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">makeCorsRequest</span>(<span class="string">&#x27;http://api.openweathermap.org/data/2.5/find&#x27;</span>, <span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    <span class="attr">q</span>: <span class="string">&#x27;beijing&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>iframe</p>
</li>
<li><p>window.name</p>
</li>
<li><p>window.postMessage：HTML5 新增方法</p>
</li>
<li><p>Apache 和 Nginx：反向代理</p>
</li>
</ul>
<blockquote>
<p>转换参数对象为字符串格式 {a:1,b:2} &#x3D;&gt; a&#x3D;1&amp;b&#x3D;2</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> param = <span class="keyword">function</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> query = <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        name, value, fullSubName, subName, subValue, innerObj, i;</span><br><span class="line">    <span class="keyword">for</span> (name <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        value = obj[name];</span><br><span class="line">        <span class="keyword">if</span> (value <span class="keyword">instanceof</span> <span class="title class_">Array</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; value.<span class="property">length</span>; ++i) &#123;</span><br><span class="line">                subValue = value[i];</span><br><span class="line">                fullSubName = name + <span class="string">&#x27;[&#x27;</span> + i + <span class="string">&#x27;]&#x27;</span>;</span><br><span class="line">                innerObj = &#123;&#125;;</span><br><span class="line">                innerObj[fullSubName] = subValue;</span><br><span class="line">                query += <span class="title function_">param</span>(innerObj) + <span class="string">&#x27;&amp;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value <span class="keyword">instanceof</span> <span class="title class_">Object</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (subName <span class="keyword">in</span> value) &#123;</span><br><span class="line">                subValue = value[subName];</span><br><span class="line">                fullSubName = name + <span class="string">&#x27;[&#x27;</span> + subName + <span class="string">&#x27;]&#x27;</span>;</span><br><span class="line">                innerObj = &#123;&#125;;</span><br><span class="line">                innerObj[fullSubName] = subValue;</span><br><span class="line">                query += <span class="title function_">param</span>(innerObj) + <span class="string">&#x27;&amp;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value !== <span class="literal">undefined</span> &amp;&amp; value !== <span class="literal">null</span>)</span><br><span class="line">            query += <span class="built_in">encodeURIComponent</span>(name) + <span class="string">&#x27;=&#x27;</span> + <span class="built_in">encodeURIComponent</span>(value) + <span class="string">&#x27;&amp;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> query.<span class="property">length</span> ? query.<span class="title function_">substr</span>(<span class="number">0</span>, query.<span class="property">length</span> - <span class="number">1</span>) : query;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/24/11.ecma08/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="可口可乐">
      <meta itemprop="description" content="Personal Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lizux">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/09/24/11.ecma08/" class="post-title-link" itemprop="url">JavaScript 读书心得之八：CSS 修改（CSS DOM）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2015-09-24 00:00:00" itemprop="dateCreated datePublished" datetime="2015-09-24T00:00:00+08:00">2015-09-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-10-26 10:32:58" itemprop="dateModified" datetime="2023-10-26T10:32:58+08:00">2023-10-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>修改 CSS 有四种方法：</p>
<ol>
<li>修改元素的 style 属性</li>
<li>改变元素的 class 或 id</li>
<li>向文档中写入新的 CSS</li>
<li>改变整个文档的样式表<br>一般规则：③在特殊的可访问性场合使用，④很少用到；推荐使用②，因为这个符合表现和行为分离的原则，而①在某些情况下有用：隐藏或显示元素、动画</li>
</ol>
<h2 id="CSS-读写"><a href="#CSS-读写" class="headerlink" title="CSS 读写"></a>CSS 读写</h2><h3 id="内联样式"><a href="#内联样式" class="headerlink" title="内联样式"></a>内联样式</h3><ul>
<li>当需要读取内联样式和修改样式时使用 style 属性</li>
<li>style 对象对每个内联的 CSS 声明都有一个对应的属性，但是它不能读取外部样式表的 CSS 属性，所以 style 属性更适合设置样式，而不是读取它们</li>
<li>style 属性和 CSS 属性对应的规则是把 CSS 属性名移除破折号 “-”，然后相邻首字母大写，也就是 Camel 驼峰命名法。如 <code>font-size=&gt;style.fontSize</code>、<code>border-left-width=&gt;style.borderLeftWidth</code><blockquote>
<p>  注：对于 float 属性，在 IE8- 中使用 styleFloat，在其他浏览器中使用 cssFloat<br>  注：设置复合属性时使用 cssText 属性，如 <code>elem.style.cssText = &quot;font-weight:bold; color:red;&quot;;</code><br>  注：修改 style 的属性为数值（除 0 以外）时，必须加上单位，如 “px”、“em”</p>
</blockquote>
</li>
</ul>
<h3 id="非内联样式"><a href="#非内联样式" class="headerlink" title="非内联样式"></a>非内联样式</h3><p>当需要读取非内联样式时：</p>
<ol>
<li>IE 使用 <code>currentStyle</code> 属性，它可以读取应用在元素上的实际样式，另外它是只读的</li>
<li>IE9+、现代浏览器使用 <code>window.getComputedStyle()</code> 方法<blockquote>
<p>  注：在读取尺寸值时，总是返回 px 值，尽管原来的样式可能是 1em<br> 注：另外返回 color 值时使用 rgb(255,255,255) 这样的语法<br> 注：当样式采用简写方式（如 <code>border:1px solid #F00</code>）时，不同浏览器的返回数值会有差异<br>     如：Firefox 无法读取 border-width 的值，只能读取 border-left-width 的值</p>
</blockquote>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 读取元素 CSS 样式 by John Resig</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getStyle</span>(<span class="params">elem, name</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> (elem.<span class="property">style</span>[name]) &#123;</span><br><span class="line">        <span class="keyword">return</span> elem.<span class="property">style</span>[name];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (elem.<span class="property">currentStyle</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> elem.<span class="property">currentStyle</span>[name];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">defaultView</span> &amp;&amp; <span class="variable language_">document</span>.<span class="property">defaultView</span>.<span class="property">getComputedStyle</span>) &#123;</span><br><span class="line">        name = name.<span class="title function_">replace</span>(<span class="regexp">/([A-Z])/g</span>, <span class="string">&#x27;-$1&#x27;</span>);</span><br><span class="line">        name = name.<span class="title function_">toLowerCase</span>();</span><br><span class="line">        <span class="keyword">var</span> s = <span class="variable language_">document</span>.<span class="property">defaultView</span>.<span class="title function_">getComputedStyle</span>(elem, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> s &amp;&amp; s.<span class="title function_">getPropertyValue</span>(name);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">testStyle</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> elem = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;testdiv&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> scolor = <span class="title function_">getStyle</span>(elem, <span class="string">&quot;color&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> sbwidth = <span class="title function_">getStyle</span>(elem, <span class="string">&quot;borderLeftWidth&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> sfont = <span class="title function_">getStyle</span>(elem, <span class="string">&quot;fontSize&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> smargin = <span class="title function_">getStyle</span>(elem, <span class="string">&quot;marginTop&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> swidth = <span class="title function_">getStyle</span>(elem, <span class="string">&quot;width&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(scolor+<span class="string">&quot;：&quot;</span>+sbwidth+<span class="string">&quot;：&quot;</span>+sfont+<span class="string">&quot;：&quot;</span>+smargin+<span class="string">&quot;：&quot;</span>+swidth);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="CSS-模块的侦测"><a href="#CSS-模块的侦测" class="headerlink" title="CSS 模块的侦测"></a>CSS 模块的侦测</h3><p>CSS 的规格发展太快，新的模块层出不穷。不同浏览器的不同版本，对 CSS 模块的支持情况都不一样。有时候，需要知道当前浏览器是否支持某个模块，这就叫做 “CSS 模块的侦测”。<br>一个比较普遍适用的方法是，判断某个 DOM 元素的 style 对象的某个属性值是否为字符串。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> element.<span class="property">style</span>.<span class="property">transform</span> === <span class="string">&#x27;string&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="改变-class-和-id"><a href="#改变-class-和-id" class="headerlink" title="改变 class 和 id"></a>改变 class 和 id</h2><p>通过改变元素的 class 或 id，浏览器会自动更新元素的样式，JavaScript 使用 className 来读取 class 属性</p>
<blockquote>
<p>注：由于 id 具有唯一性，而且还可能作为脚本的钩子，所以不建议改变它<br>注：因为元素通常已经拥有 classs 属性了，所以一般是给元素添加或移除一个 class 值，而不是直接重新设置 class 值</p>
</blockquote>
<p>辅助移除 class 函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">removeClass</span>(<span class="params">elem, sClass</span>) &#123;</span><br><span class="line">    elem.<span class="property">className</span> = elem.<span class="property">className</span>.<span class="title function_">replace</span>(sClass, <span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">testClass</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> elem = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;testdiv&quot;</span>).<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;p&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>,obj; obj=elem[i++];) &#123;</span><br><span class="line">        obj.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (superClass(<span class="variable language_">this</span>, <span class="string">&quot;has&quot;</span>, <span class="string">&quot;error&quot;</span>)) &#123;</span><br><span class="line">                superClass(<span class="variable language_">this</span>,<span class="string">&quot;remove&quot;</span>,<span class="string">&quot;error&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                superClass(<span class="variable language_">this</span>,<span class="string">&quot;add&quot;</span>,<span class="string">&quot;error&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="向文档写入-CSS"><a href="#向文档写入-CSS" class="headerlink" title="向文档写入 CSS"></a>向文档写入 CSS</h2><ul>
<li><p>这个方法比较特别，应该只用来增强页面的可访问性：当 JavaScript 可用时，定义样式（通常是隐藏页面元素）；如果 JavaScript 不可用或对象检测失败，不应用该样式<br>  注：这种解决方案可能会影响某些可用性，但是从技术上说，对于高级的、可执行脚本的界面来说，这是最正确的隐藏元素的处理方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;style&gt;.show&#123;color:#F00&#125;&lt;/style&gt;&quot;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;link rel=&#x27;stylesheet&#x27; href=&#x27;style.css&#x27;&gt;&quot;</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用这个方法时，尽快应用特定的样式很重要。因为如果等待 load 事件的话，用户会看到页面闪烁或跳动（由于某些可见的元素在 onload 后隐藏或者显示）；另外在页面加载完后，执行 <code>document.write()</code>，浏览器会默认移除当前文档内容，并写入新的内容，从而破坏掉页面。所以要把 <code>document.write()</code> 放在 JavaScript 文件的顶端，并在任何函数之外</p>
</li>
<li><p>正确地使用这个方法，它就是很有用的可访问性工具，否则会引发一系列问题。在使用 <code>document.write()</code> 添加样式之前，需要整体考虑，并在禁用 JavaScript 的情况下测试页面</p>
</li>
</ul>
<h2 id="改变整个样式表"><a href="#改变整个样式表" class="headerlink" title="改变整个样式表"></a>改变整个样式表</h2><p>只有 Windows 平台下的 IE 和 Firefox 支持改变样式表，所以这个方法也遇到了兼容性问题；另外除了某些特定情况（比如目前博客网站流行的允许用户自定义样式表），改变页面的整个样式表也没有什么意义</p>
<p>原理：文档包含一系列样式表文件，样式表包含一系列规则，规则包含一系列样式声明，声明包含属性和对应值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">changeStyle</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 支持样式表编辑的首要条件是支持 document.styleSheets 节点列表，列表的索引数字按样式表文件在文档中出现的顺序排列</span></span><br><span class="line">    <span class="keyword">var</span> sheets = <span class="variable language_">document</span>.<span class="property">styleSheets</span>;</span><br><span class="line">    <span class="keyword">if</span> (!sheets || !sheets.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查找链接地址是 style.css 的对应样式表对象</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; sheets.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!sheets[i].<span class="property">href</span>) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> ssName = sheets[i].<span class="property">href</span>.<span class="title function_">substring</span>(sheets[i].<span class="property">href</span>.<span class="title function_">lastIndexOf</span>(<span class="string">&#x27;/&#x27;</span>)+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (ssName == <span class="string">&#x27;style.css&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> currentSheet = sheets[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 或者直接设置文档的第一个样式表为样式表对象</span></span><br><span class="line">    <span class="keyword">var</span> currentSheet = sheets[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取样式表的所有规则，Firefox 使用 W3C 标准的 cssRules[]，IE 使用微软标准的 rules[]，其他现代浏览器都支持；它们除了名字不同外几乎没有差别</span></span><br><span class="line">    <span class="keyword">var</span> sheetRules = currentSheet.<span class="property">cssRules</span> || currentSheet.<span class="property">rules</span>;</span><br><span class="line">    <span class="keyword">if</span> (!sheetRules) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 每个规则都有 selectorText 属性，以字符串类型保存着规则的选择符，注：IE/Safari 返回大写字符，现代浏览器返回小写字符</span></span><br><span class="line">    <span class="keyword">var</span> sText = sheetRules[<span class="number">2</span>].<span class="property">selectorText</span>;</span><br><span class="line">    <span class="comment">// 每个规则都有 style 属性，这个和元素的 style 属性类似</span></span><br><span class="line">    <span class="keyword">var</span> sStyle = sheetRules[<span class="number">2</span>].<span class="property">style</span>.<span class="property">font</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(sText+<span class="string">&quot; 的 font 样式是 &quot;</span>+sStyle);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取样式表的完整文本要用 cssText 属性，但是全文的（cssText1）只有 IE 支持，单个规则的（cssText2）则只有 IE9+、现代浏览器支持，单个规则并不包含选择符的（cssText3）所有浏览器都支持</span></span><br><span class="line">    <span class="comment">// 对于简写方式的样式，Firefox 返回实际值，IE/Opera 返回拆分成单个条目后的值</span></span><br><span class="line">    <span class="keyword">var</span> cssText1 = currentSheet.<span class="property">cssText</span>;</span><br><span class="line">    <span class="keyword">if</span> (currentSheet.<span class="property">cssRules</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> cssText2 = currentSheet.<span class="property">cssRules</span>[<span class="number">0</span>].<span class="property">cssText</span>;</span><br><span class="line">        <span class="keyword">var</span> cssText3 = currentSheet.<span class="property">cssRules</span>[<span class="number">0</span>].<span class="property">style</span>.<span class="property">cssText</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentSheet.<span class="property">rules</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> cssText2 = currentSheet.<span class="property">rules</span>[<span class="number">0</span>].<span class="property">cssText</span>;</span><br><span class="line">        <span class="keyword">var</span> cssText3 = currentSheet.<span class="property">rules</span>[<span class="number">0</span>].<span class="property">style</span>.<span class="property">cssText</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;IE 支持的 &quot;</span>+cssText1);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;现代浏览器支持的 &quot;</span>+cssText2);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;都支持的 &quot;</span>+cssText3);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加和移除规则，Firefox 使用 W3C 标准的 insertRule() 和 deleteRule() 方法，IE 使用微软标准的 addRule() 和 removeRule() 方法</span></span><br><span class="line">    <span class="comment">// 通用添加和移除样式表规则函数</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">addCSS</span>(<span class="params">obj, selector, declaration, index</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (obj.<span class="property">insertRule</span>) &#123;</span><br><span class="line">            obj.<span class="title function_">insertRule</span>(selector+<span class="string">&quot;&#123;&quot;</span>+declaration+<span class="string">&quot;&#125;&quot;</span>,index);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (obj.<span class="property">addRule</span>) &#123;</span><br><span class="line">            obj.<span class="title function_">addRule</span>(selector,declaration,index);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">removeCSS</span>(<span class="params">obj, index</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (obj.<span class="property">deleteRule</span>) &#123;</span><br><span class="line">            obj.<span class="title function_">deleteRule</span>(index);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (obj.<span class="property">removeRule</span>) &#123;</span><br><span class="line">            obj.<span class="title function_">removeRule</span>(index);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">addCSS</span>(currentSheet,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;color:#F00;font-weight:bold;&quot;</span>,<span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="隐藏或显示元素"><a href="#隐藏或显示元素" class="headerlink" title="隐藏或显示元素"></a>隐藏或显示元素</h2><ul>
<li>使用 style 属性设置内联样式，这样可以通过 <code>style.display</code> 来读取当前元素的 display 值</li>
<li>使用 JavaScript 设置关键的 <code>display:none</code>，而不是在 CSS 里面，这样当用户禁用脚本时，所有内容还是显示的，并可以访问</li>
<li>页面加载完后建立标题和关联内容之间的关系</li>
</ul>
<p>下面的函数遍历文档的 h3，并把其后面的内容放入一个新创建的 div 隐藏起来，然后添加切换显示的脚本</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">initToggle</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> header = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;h3&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; header.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> nDiv = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">        nDiv.<span class="property">className</span> = <span class="string">&quot;toggle&quot;</span>;</span><br><span class="line">        <span class="comment">//nDiv.style.display = &quot;none&quot;;</span></span><br><span class="line">        <span class="title function_">insertAfter</span>(nDiv,header[i]);</span><br><span class="line">        <span class="keyword">while</span> (nDiv.<span class="property">nextSibling</span> != header[i+<span class="number">1</span>]) &#123;</span><br><span class="line">            nDiv.<span class="title function_">appendChild</span>(nDiv.<span class="property">nextSibling</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        superClass(header[i],<span class="string">&quot;add&quot;</span>,<span class="string">&quot;clickable&quot;</span>);</span><br><span class="line">        header[i].<span class="property">relatedCont</span> = nDiv;</span><br><span class="line">        header[i].<span class="property">onclick</span> = toggleCont;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toggleCont</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> currentValue = <span class="variable language_">this</span>.<span class="property">relatedCont</span>.<span class="property">style</span>.<span class="property">display</span>;</span><br><span class="line">    <span class="keyword">var</span> newValue = (currentValue == <span class="string">&quot;none&quot;</span>) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">relatedCont</span>.<span class="property">style</span>.<span class="property">display</span> = newValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h2><p>动画就是反复改变元素的某一样式，这也是一个改变 style 属性优于改变 class 属性的场合</p>
<p>动画通常涉及到两个函数 setTimeout()、setInterval()，而二者选用其一的原则是：前者适合有确定起点和终点的动画，后者适合在不确定的时间内（如等待用户行为）持续进行的动画</p>
<blockquote>
<p>注：现在更推荐使用 CSS3 中的 transition、animation 属性来实现</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">initMotion</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> obj = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;linkList&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!obj) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> show = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">    show.<span class="property">id</span> = <span class="string">&quot;slideShow&quot;</span>;</span><br><span class="line">    show.<span class="property">innerHTML</span> = <span class="string">&quot;&lt;img src=&#x27;images/topics.gif&#x27; id=&#x27;linkPic&#x27;&gt;&quot;</span>;</span><br><span class="line">    <span class="title function_">insertAfter</span>(show,obj);</span><br><span class="line">    <span class="keyword">var</span> link = obj.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; link.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        link[i].<span class="property">newId</span> = i;</span><br><span class="line">        link[i].<span class="property">onmouseover</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">motion</span>(<span class="string">&quot;linkPic&quot;</span>,-<span class="number">100</span>*(<span class="variable language_">this</span>.<span class="property">newId</span>+<span class="number">1</span>),<span class="number">0</span>,<span class="number">10</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 通用移动元素位置函数 by Jeremy Keith</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">motion</span>(<span class="params">objId, posX, posY, interval</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> k = <span class="number">0.1</span>;</span><br><span class="line">    <span class="keyword">var</span> obj = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(objId);</span><br><span class="line">    <span class="keyword">if</span> (!obj) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (obj.<span class="property">movement</span>) &#123;</span><br><span class="line">        <span class="built_in">clearTimeout</span>(obj.<span class="property">movement</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    obj.<span class="property">style</span>.<span class="property">left</span> = obj.<span class="property">style</span>.<span class="property">left</span> || <span class="string">&quot;0px&quot;</span>;</span><br><span class="line">    obj.<span class="property">style</span>.<span class="property">top</span> = obj.<span class="property">style</span>.<span class="property">top</span> || <span class="string">&quot;0px&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> nowX = <span class="built_in">parseInt</span>(obj.<span class="property">style</span>.<span class="property">left</span>);</span><br><span class="line">    <span class="keyword">var</span> nowY = <span class="built_in">parseInt</span>(obj.<span class="property">style</span>.<span class="property">top</span>);</span><br><span class="line">    <span class="keyword">if</span> (nowX == posX &amp;&amp; nowY == posY) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (nowX &lt; posX) &#123;</span><br><span class="line">        nowX += <span class="title class_">Math</span>.<span class="title function_">ceil</span>((posX-nowX)*k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (nowX &gt; posX) &#123;</span><br><span class="line">        nowX -= <span class="title class_">Math</span>.<span class="title function_">ceil</span>((nowX-posX)*k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (nowY &lt; posY) &#123;</span><br><span class="line">        nowY += <span class="title class_">Math</span>.<span class="title function_">ceil</span>((posY-nowY)*k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (nowY &gt; posY) &#123;</span><br><span class="line">        nowY -= <span class="title class_">Math</span>.<span class="title function_">ceil</span>((nowY-posY)*k);</span><br><span class="line">    &#125;</span><br><span class="line">    obj.<span class="property">style</span>.<span class="property">left</span> = nowX+<span class="string">&quot;px&quot;</span>;</span><br><span class="line">    obj.<span class="property">style</span>.<span class="property">top</span> = nowY+<span class="string">&quot;px&quot;</span>;</span><br><span class="line">    <span class="comment">// 闭包的应用</span></span><br><span class="line">    obj.<span class="property">movement</span> = <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">motion</span>(objId, posX, posY, interval);</span><br><span class="line">    &#125;, interval);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="元素的尺寸和位置"><a href="#元素的尺寸和位置" class="headerlink" title="元素的尺寸和位置"></a>元素的尺寸和位置</h2><h3 id="clientWidth、clientHeight-属性"><a href="#clientWidth、clientHeight-属性" class="headerlink" title="clientWidth、clientHeight 属性"></a>clientWidth、clientHeight 属性</h3><p>元素的可视尺寸（相当于 CSS 中的 content+padding 再减去 scrollbar），不包括边框 border 和滚动条 scrollbar。</p>
<blockquote>
<p>IE6 中该尺寸包括滚动条 scrollbar。<br>  若 CSS 中设置 box-sizing:content-box 时，设置的 width&#x2F;height 就等于 content 的尺寸。<br>  若 CSS 中没有指定元素的高度和宽度 (即自适应)，则 IE6 中显示 0，而其他浏览器则显示实际值。</p>
</blockquote>
<p>为了读取文档视口的尺寸，需要查询 clientWidth&#x2F;Height 时的兼容性方案：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> windowWidth = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientWidth</span> || <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span>;</span><br><span class="line"><span class="keyword">var</span> windowHeight = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span> || <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientHeight</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>document.documentElement.clientWidth/clientHeight</code>，基本上与 <code>window.innerWidth/innerHeight</code> 同义。只有一个区别，前者不将滚动条计算在内，而后者包括了滚动条的高度和宽度。</p>
</blockquote>
<h3 id="offsetWidth、offsetHeight-属性"><a href="#offsetWidth、offsetHeight-属性" class="headerlink" title="offsetWidth、offsetHeight 属性"></a>offsetWidth、offsetHeight 属性</h3><p>元素的布局尺寸，包括边框和滚动条。我们在浏览器中看到的元素物理尺寸就是这个。</p>
<blockquote>
<p>若 CSS 中设置 box-sizing:border-box 时，设置的 width&#x2F;height 就等于 offsetWidth&#x2F;offsetHeight。</p>
</blockquote>
<h3 id="scrollWidth、scrollHeight-属性"><a href="#scrollWidth、scrollHeight-属性" class="headerlink" title="scrollWidth、scrollHeight 属性"></a>scrollWidth、scrollHeight 属性</h3><p>元素的实际尺寸；如果该属性大于 clientWidth&#x2F;Height，就会出现滚动条。</p>
<h3 id="三者之间的关系"><a href="#三者之间的关系" class="headerlink" title="三者之间的关系"></a>三者之间的关系</h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><pre><code>屏幕尺寸 screen.width/height
窗口尺寸 window.outerWidth/outerHeight

视口宽度 window.innerWidth
视口高度 window.innerHeight
// 注：由于 IE11 的滚动条自动隐藏（尺寸为 0），所以它的视口尺寸和可视尺寸是相等的

可视宽度 clientWidth  = 视口宽度 - 滚动条
可视高度 clientHeight = 视口高度 - 滚动条
// 定义明确，与视口尺寸关联

布局宽度 offsetWidth
布局高度 offsetHeight
// 不同浏览器、不同标签下差异较大，见下文公式辨析

实际宽度 scrollWidth  = 内容宽度
实际高度 scrollHeight = 内容高度
// 定义明确，与内容尺寸关联（除了两个例外情况）

// 注：以上对 PC端有效，对移动端而言
    screen.width = window.outerWidth = (document.documentElement.clientWidth = window.innerWidth) / scale
    screen.height = window.outerHeight = (document.documentElement.clientHeight = window.innerHeight) / scale
    // scale 是视口的缩放比，取决于 &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, maximum-scale=1&quot;&gt; 中的设置值
    // scale 取值范围最大为 1，最小为 .25。
</code></pre>
<h4 id="公式"><a href="#公式" class="headerlink" title="公式"></a>公式</h4><pre><code>对 &lt;html&gt; 标签（document.documentElement）来说：
// 宽度
    // 布局宽度 = 可视宽度 IE8+、Chrome、Firefox
    // 布局宽度 = 视口宽度 IE6
// 高度
    // 布局高度 = 内容高度 Chrome、Firefox
    // 布局高度 = 可视高度 IE8+
    // 布局高度 = 视口高度 IE6
    // 实际高度 = Math.max(内容高度, 可视高度) Firefox 唯一例外

对 &lt;body&gt; 标签（document.body）来说：
// 宽度
    // 布局宽度 = 可视宽度 IE8+、Chrome、Firefox
    // 视口宽度 = 布局宽度 = 实际宽度 = 内容宽度 IE6
// 高度
    // 可视高度 = 布局高度 = 实际高度 = 内容高度
    // 实际高度 = Math.max(内容高度, 视口高度 - 滚动条) Chrome 唯一例外
</code></pre>
<blockquote>
<p>注：由于 &lt;html&gt; 和 &lt;body&gt; 有了 margin、padding、border 的话，Firefox 和 IE 会产生很多不兼容问题，所以 &lt;html&gt;、&lt;body&gt; 一般都重置为 0</p>
</blockquote>
<h3 id="offsetLeft、offsetTop-属性"><a href="#offsetLeft、offsetTop-属性" class="headerlink" title="offsetLeft、offsetTop 属性"></a>offsetLeft、offsetTop 属性</h3><p>元素相对参考点的偏移量</p>
<h3 id="offsetParent-属性"><a href="#offsetParent-属性" class="headerlink" title="offsetParent 属性"></a>offsetParent 属性</h3><p>指向参考点，即当前 HTML 元素的最靠近的、并且 CSS 的 position 属性不等于 static 的祖先元素。IE6 则是查找拥有 “layout” 的祖先元素。</p>
<ul>
<li>最终 offsetParent（即最终参考点），一般指向 &lt;body&gt; 标签；另外由于 &lt;html&gt; 和 &lt;body&gt; 标签没有 offsetParent，所以它们也没有 offsetLeft&#x2F;Top</li>
<li>position:relative 和 absolute 的元素，IE6 按正常原则查找 offsetParent，但其最终的 offsetParent 会跳过 &lt;body&gt; 标签，直接指向 &lt;html&gt; 标签</li>
<li>position:fixed 的元素，IE6 浏览器按正常原则查找，其他浏览器的 offsetParent 为 null。</li>
<li>display:none 的元素，IE6 浏览器按正常原则查找，IE8 浏览器的 offsetParent 为 &lt;body&gt; 标签，其他浏览器为 null。</li>
</ul>
<h3 id="scrollLeft、scrollTop-属性"><a href="#scrollLeft、scrollTop-属性" class="headerlink" title="scrollLeft、scrollTop 属性"></a>scrollLeft、scrollTop 属性</h3><p>页面的滚动偏移量</p>
<blockquote>
<p>只有在有滚动条的元素或页面中才有值<br>  对 IE6+、Firefox、Opera 来说，<code>document.documentElement</code> 有此属性；对 Safari、Chrome 来说，则 <code>document.body</code> 有此属性</p>
</blockquote>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 读取元素坐标（相对于页面） by John Resig</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">pageX</span>(<span class="params">elem</span>)&#123;</span><br><span class="line">     <span class="keyword">return</span> elem.<span class="property">offsetParent</span> ? (elem.<span class="property">offsetLeft</span> + <span class="title function_">pageX</span>(elem.<span class="property">offsetParent</span>)) : elem.<span class="property">offsetLeft</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">pageY</span>(<span class="params">elem</span>)&#123;</span><br><span class="line">     <span class="keyword">return</span> elem.<span class="property">offsetParent</span> ? (elem.<span class="property">offsetTop</span> + <span class="title function_">pageY</span>(elem.<span class="property">offsetParent</span>)) : elem.<span class="property">offsetTop</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">// 注：现代浏览器有个原生方法 getBoundingClientRect()，可以直接获取元素相对于视口的 left、top、right、bottom、width、height（最后两项 IE8- 不支持）</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// 读取元素坐标（相对于父元素） by John Resig</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">parentX</span>(<span class="params">elem</span>)&#123;</span><br><span class="line">     <span class="keyword">return</span> elem.<span class="property">parentNode</span> == elem.<span class="property">offsetParent</span> ? elem.<span class="property">offsetLeft</span> : <span class="title function_">pageX</span>(elem) - <span class="title function_">pageX</span>(elem.<span class="property">parentNode</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">parentY</span>(<span class="params">elem</span>)&#123;</span><br><span class="line">     <span class="keyword">return</span> elem.<span class="property">parentNode</span> == elem.<span class="property">offsetParent</span> ? elem.<span class="property">offsetTop</span> : <span class="title function_">pageY</span>(elem) - <span class="title function_">pageY</span>(elem.<span class="property">parentNode</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>&#x2F;&#x2F; 下面这个函数显示了 不同浏览器和不同设备 在读取页面元素的各种尺寸上的差异</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 读取页面及视口尺寸</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getPageSize</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> xScroll, yScroll;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollHeight</span> &gt; <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) &#123;</span><br><span class="line">        xScroll = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollWidth</span>;</span><br><span class="line">        yScroll = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollHeight</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        xScroll = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetWidth</span>;</span><br><span class="line">        yScroll = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> windowWidth, windowHeight;</span><br><span class="line">    <span class="keyword">if</span> (self.<span class="property">innerHeight</span>) &#123;</span><br><span class="line">        windowWidth = self.<span class="property">innerWidth</span>;</span><br><span class="line">        windowHeight = self.<span class="property">innerHeight</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">documentElement</span> &amp;&amp; <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span>) &#123;</span><br><span class="line">        windowWidth = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientWidth</span>;</span><br><span class="line">        windowHeight = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">body</span>) &#123;</span><br><span class="line">        windowWidth = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span>;</span><br><span class="line">        windowHeight = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientHeight</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    pageWidth = xScroll &lt; windowWidth ? windowWidth : xScroll;</span><br><span class="line">    pageHeight = yScroll &lt; windowHeight ? windowHeight : yScroll;</span><br><span class="line">    <span class="keyword">return</span> [pageWidth, pageHeight, windowWidth, windowHeight];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">elemDimension</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> w = <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">width</span>;</span><br><span class="line">    <span class="keyword">var</span> h = <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">height</span>;</span><br><span class="line">    <span class="keyword">var</span> aw = <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">availWidth</span>;</span><br><span class="line">    <span class="keyword">var</span> ah = <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">availHeight</span>;</span><br><span class="line">    <span class="keyword">var</span> ow = <span class="variable language_">window</span>.<span class="property">outerWidth</span>;</span><br><span class="line">    <span class="keyword">var</span> oh = <span class="variable language_">window</span>.<span class="property">outerHeight</span>;</span><br><span class="line">    <span class="keyword">var</span> iw = <span class="variable language_">window</span>.<span class="property">innerWidth</span>;</span><br><span class="line">    <span class="keyword">var</span> ih = <span class="variable language_">window</span>.<span class="property">innerHeight</span>;</span><br><span class="line">    <span class="keyword">var</span> dpr = <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    str += <span class="string">&quot;屏幕宽度 Window.screen.width = &quot;</span>+w;</span><br><span class="line">    str += <span class="string">&quot;&lt;br&gt; 屏幕高度 Window.screen.height = &quot;</span>+h;</span><br><span class="line">    str += <span class="string">&quot;&lt;br&gt; 屏幕有效宽度 Window.screen.availWidth = &quot;</span>+aw;</span><br><span class="line">    str += <span class="string">&quot;&lt;br&gt; 屏幕有效高度 Window.screen.availHeight = &quot;</span>+ah;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">outerWidth</span>) &#123;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 窗口宽度 Window.outerWidth = &quot;</span>+ow;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 窗口高度 Window.outerHeight = &quot;</span>+oh;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">innerWidth</span>) &#123;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 视口宽度 Window.innerWidth = &quot;</span>+iw;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 视口高度 Window.innerHeight = &quot;</span>+ih;</span><br><span class="line">    &#125;</span><br><span class="line">    str += <span class="string">&quot;&lt;br&gt; 设备像素比 Window.devicePixelRatio = &quot;</span>+dpr;</span><br><span class="line">    str += <span class="string">&quot;\n&lt;br&gt; 页面宽度 = &quot;</span>+<span class="title function_">getPageSize</span>()[<span class="number">0</span>];</span><br><span class="line">    str += <span class="string">&quot;\n&lt;br&gt; 页面高度 = &quot;</span>+<span class="title function_">getPageSize</span>()[<span class="number">1</span>];</span><br><span class="line">    str += <span class="string">&quot;\n&lt;br&gt; 可视宽度 = &quot;</span>+<span class="title function_">getPageSize</span>()[<span class="number">2</span>];</span><br><span class="line">    str += <span class="string">&quot;\n&lt;br&gt; 可视高度 = &quot;</span>+<span class="title function_">getPageSize</span>()[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">documentElement</span>) &#123;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt;&lt;br&gt; 可视宽度 document.documentElement.clientWidth = &quot;</span>+<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientWidth</span>;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 可视高度 document.documentElement.clientHeight = &quot;</span>+<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span>;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 布局宽度 document.documentElement.offsetWidth = &quot;</span>+<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">offsetWidth</span>;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 布局高度 document.documentElement.offsetHeight = &quot;</span>+<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">offsetHeight</span>;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 实际宽度 document.documentElement.scrollWidth = &quot;</span>+<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollWidth</span>;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 实际高度 document.documentElement.scrollHeight = &quot;</span>+<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollHeight</span>;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 水平滚动 document.documentElement.scrollLeft = &quot;</span>+<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollLeft</span>;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 垂直滚动 document.documentElement.scrollTop = &quot;</span>+<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">body</span>) &#123;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt;&lt;br&gt; 可视宽度 document.body.clientWidth = &quot;</span>+<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span>;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 可视高度 document.body.clientHeight = &quot;</span>+<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientHeight</span>;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 布局宽度 document.body.offsetWidth = &quot;</span>+<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetWidth</span>;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 布局高度 document.body.offsetHeight = &quot;</span>+<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 实际宽度 document.body.scrollWidth = &quot;</span>+<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollWidth</span>;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 实际高度 document.body.scrollHeight = &quot;</span>+<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollHeight</span>;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt;&lt;br&gt;CSS 宽度 document.body.style.width = &quot;</span>+<span class="title function_">getStyle</span>(<span class="variable language_">document</span>.<span class="property">body</span>,<span class="string">&quot;width&quot;</span>);</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt;CSS 高度 document.body.style.height = &quot;</span>+<span class="title function_">getStyle</span>(<span class="variable language_">document</span>.<span class="property">body</span>,<span class="string">&quot;height&quot;</span>);</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 水平滚动 document.body.scrollLeft = &quot;</span>+<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollLeft</span>;</span><br><span class="line">        str += <span class="string">&quot;&lt;br&gt; 垂直滚动 document.body.scrollTop = &quot;</span>+<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollTop</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">innerHTML</span> = str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/23/10.ecma07/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="可口可乐">
      <meta itemprop="description" content="Personal Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lizux">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/09/23/10.ecma07/" class="post-title-link" itemprop="url">JavaScript 读书心得之七：文档对象模型（DOM）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2015-09-23 00:00:00" itemprop="dateCreated datePublished" datetime="2015-09-23T00:00:00+08:00">2015-09-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-10-26 10:32:58" itemprop="dateModified" datetime="2023-10-26T10:32:58+08:00">2023-10-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>为了便于阅读本部分文档，定义一些常见概念：</p>
<ul>
<li>静态定位：position:static（position 属性的默认值）</li>
<li>动态定位：position:relative、absolute、fixed</li>
<li>祖先节点：任意包含该节点的节点。（元素节点）</li>
<li>父节点：直接包含该节点的祖先节点。（元素节点，且唯一）</li>
<li>兄弟节点：拥有共同的父节点的节点。（不一定为元素节点）</li>
<li>子节点：该节点下直接包含的所有节点，该节点为这些节点的父节点。（不一定为元素节点）</li>
<li>后代节点：该节点下包含的所有节点，该节点为这些节点的祖先节点。（不一定为元素节点）</li>
</ul>
<p>文档对象模型（DOM）是一个平台，一个中立于语言的应用程序编程接口（API），允许程序读取并更改文档的内容、结构和样式，主要由 <a target="_blank" rel="noopener" href="http://www.w3.org/DOM/Activity">W3C（万维网联盟）</a> 来负责制定标准</p>
<h2 id="W3C-DOM"><a href="#W3C-DOM" class="headerlink" title="W3C DOM"></a>W3C DOM</h2><p>W3C DOM 按内容分为：<br>0. DOM Core：用于任何结构化文档包括 XML 的标准模型，适用于任何支持 DOM 的语言<br>0. HTML DOM：用于 HTML 文档的标准模型，适用于 JavaScript，它把文档中的 HTML 元素都作为 HTML DOM 对象，它的属性、方法和事件也对应到 HTML DOM 的对象属性、方法和事件<br>0. CSS DOM：HTML DOM 中的细分领域，用于对 HTML 文档的样式表对象进行操作</p>
<p>W3C DOM 按级别分为：<br>0. DOM Level 1 专注于 HTML 和 XML 文档模型。它含有文档读取和操作功能<br>0. DOM Level 2 添加了样式表对象模型，并定义了操作附于文档之上的样式信息的功能性。同时还定义了一个事件模型，并提供了对 XML 命名空间的支持<br>    DOM Level 2 Core：规定了读取和更改文档内容及结构的一个 API，此 API 同时包含用于 XML 的接口<br>    DOM Level 2 HTML：规定了操作 HTML 文档结构和内容的 API<br>    DOM Level 2 Views：规定了对文档视图进行读取和更改的 API。视图是与原文档相关联的表现形式或某种备用的表现形式<br>    DOM Level 2 Style：规定了动态读取及更改内容样式表的 API<br>    DOM Level 2 Events：规定了读取文档事件的 API<br>    DOM Level 2 Traversal &amp; Range：规定了动态遍历和识别文档中内容范围的 API<br>0. DOM Level 3 规定了内容模型（DTD 和 Schemas）和文档验证。同时规定了文档加载和保存、文档查看、文档格式化和关键事件<br>    DOM Level 3 Core：规定了读取和更改文档内容、结构及样式的一个 API<br>    DOM Level 3 Load &amp; Save：规定了用于内容加载和保存、内容模型（DTD 和 Schemas）和文档验证支持的 API<br>    DOM Level 3 Validation<br>        以下还属于 W3C 草案，并不是 W3C 标准<br>        DOM Level 3 Requirements<br>        DOM Level 3 Abstract Schemas<br>        DOM Level 3 Events：通过增加新的接口和新的事件集，对 Level 2 Event API 的功能进行了扩展<br>        DOM Level 3 XPath<br>        DOM Level 3 Views and Formatting：规定了对文档视图进行读取和更改的 API。视图是与原文档相关联的表现形式或某种备用的表现形式<br>        DOM Level 4</p>
<p>另外，还有 0 级 DOM（DOM Level 0），但它并不是 W3C 标准，只是约定俗成的叫法，是对在 Netscape3 和 IE3 中的等价功能性的一种定义，包括了原始的 HTML DOM</p>
<p>目前浏览器都支持 W3C DOM：Firefox 支持几乎所有的 Level 2 和部分 Level 3；Opera7.2+ 支持几乎所有的 Level 1 和大部分 Level 2；而 IE5.5+&#x2F;Safari1.0+ 只支持 Level 1</p>
<h2 id="DOM-中的节点"><a href="#DOM-中的节点" class="headerlink" title="DOM 中的节点"></a>DOM 中的节点</h2><p>DOM 的最小组成单位叫做节点（node），一个文档的树形结构（DOM 树），就是由各种不同类型的节点组成。<br>对于 HTML 文档，节点主要有以下六种类型：Document 节点（文档）、DocumentType 节点（文档类型）、Element 节点（元素）、Attribute 节点（属性）、Text 节点（文本）和 DocumentFragment 节点（文档碎片）。<br>浏览器原生提供一个 Node 对象，上表所有类型的节点都是 Node 对象派生出来的。也就是说，它们都继承了 Node 的属性和方法。</p>
<ol start="0">
<li>文档（Document）节点，表示整个 HTML 文档，即 DOM 中的 D（Document 对象）<br>文档类型（DocumentType）节点，表示文档的类型，如 <!DOCTYPE html></li>
<li>元素（Element）节点，表示 HTML 元素，如 a 或 img</li>
<li>属性（Attribute）节点，表示 HTML 元素的属性，如 href（a 元素）或 src（img 元素）<br>属性节点比较特殊，它并不是文档树中特性齐全的一部分，比如它不会出现在父元素的 childNodes[] 列表中<br>另外许多常见的 HTML 属性（即特性，Attribute）有着对应的 DOM 属性（Property），所以对它们的操作不需要 DOM Core 方法也可以（使用 HTML DOM 方法），这里也是容易出兼容性问题的地方<br>使用 HTML DOM 方法（. 属性）时，常见的属性都是同名一一对应，除了几个例外：class&#x2F;className、for&#x2F;htmlFor，因为这些 HTML 属性名在 JavaScript 中是保留关键字</li>
<li>文本（Text）节点，表示 HTML 文档中的文本，它是出现在 p、a 或 h2 这些元素中的文字</li>
<li>注释（Comment）节点，表示 HTML 文档中的注释语句<br>文档碎片（DocumentFragment）节点，表示文档的片段</li>
</ol>
<h2 id="DOM-常用节点属性"><a href="#DOM-常用节点属性" class="headerlink" title="DOM 常用节点属性"></a>DOM 常用节点属性</h2><ul>
<li>nodeName 节点名称；元素节点为元素标签（注：全部大写），属性节点为属性名，文本节点为 #text，注释节点为 #comment，文档节点为 #document</li>
<li>nodeValue 节点值；文本和注释节点为其中的文本，属性节点为属性值，元素节点无此属性</li>
<li>nodeType 返回当前节点的类型（注：1、2、3、8、9 会经常用到）<br>  值  说明<br>  1   元素节点<br>  2   属性节点<br>  3   文本节点<br>  4   CDATA 选择节点<br>  5   实体引用节点<br>  6   实体节点<br>  7   处理指令节点<br>  8   注释节点<br>  9   文档节点<br>  10  文档类型节点<br>  11  文档片断节点<br>  12  符号节点</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">countChild</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;节点名称&quot;</span> + <span class="variable language_">document</span>.<span class="property">nodeName</span> + <span class="string">&quot;，节点类型&quot;</span> + <span class="variable language_">document</span>.<span class="property">nodeType</span>);</span><br><span class="line">    <span class="keyword">var</span> docElem = <span class="variable language_">document</span>.<span class="property">documentElement</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;节点名称&quot;</span> + docElem.<span class="property">nodeName</span> + <span class="string">&quot;，节点类型&quot;</span> + docElem.<span class="property">nodeType</span>);</span><br><span class="line">    <span class="keyword">var</span> bodyElem = <span class="variable language_">document</span>.<span class="property">body</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;节点名称&quot;</span> + bodyElem.<span class="property">nodeName</span> + <span class="string">&quot;，节点类型&quot;</span> + bodyElem.<span class="property">nodeType</span>);</span><br><span class="line">    <span class="keyword">var</span> orgChild = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;firstbq&quot;</span>).<span class="property">childNodes</span>;</span><br><span class="line">    <span class="keyword">var</span> realChild = <span class="title function_">extractNodes</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;firstbq&quot;</span>));</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;原始节点有：&quot;</span> + orgChild.<span class="property">length</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; orgChild.<span class="property">length</span>; j++) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;节点名称：&quot;</span> + orgChild[j].<span class="property">nodeName</span>);</span><br><span class="line">        <span class="keyword">if</span> (orgChild[j].<span class="property">nodeType</span> == <span class="number">3</span> || orgChild[j].<span class="property">nodeType</span> == <span class="number">8</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;节点值：&quot;</span> + orgChild[j].<span class="property">nodeValue</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;元素节点有：&quot;</span> + realChild.<span class="property">length</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; realChild.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;节点名称：&quot;</span> + realChild[i].<span class="property">nodeName</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> attribute = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;firstbq&quot;</span>).<span class="title function_">getAttributeNode</span>(<span class="string">&quot;cite&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;属性节点名&quot;</span> + attribute.<span class="property">nodeName</span> + <span class="string">&quot;，属性节点值&quot;</span> + attribute.<span class="property">nodeValue</span> + <span class="string">&quot;，属性节点类型&quot;</span> + attribute.<span class="property">nodeType</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="DOM-常用查找节点方法"><a href="#DOM-常用查找节点方法" class="headerlink" title="DOM 常用查找节点方法"></a>DOM 常用查找节点方法</h2><ul>
<li><p>getElementById()<br>  只能使用于 Document 对象</p>
<blockquote>
<p>注：在 XML 文档中不能使用，它会默认搜索类型属性而不是 id 属性，而且该类型必须在文档类型定义（DTD）中被定义，这是唯一一个不通用的 DOM Core 方法</p>
</blockquote>
</li>
<li><p>getElementsByTagName()<br>  返回一个指定元素标签的后代元素节点列表（HTMLCollection 类型的对象），元素节点的变化实时反映在返回结果中。这个方法不仅可以在 Document 对象上调用，也可以在任何元素节点上调用。</p>
<blockquote>
<p>注：<code>getElementsByTagName(&quot;*&quot;)</code> 可以遍历出所有的后代元素节点</p>
</blockquote>
</li>
<li><p>getElementsByClassName()<br>  返回一个 class 名字符合指定条件的后代元素节点列表（HTMLCollection 类型的对象）。这个方法不仅可以在 Document 对象上调用，也可以在任何元素节点上调用。<br>  IE9+ 支持</p>
</li>
<li><p>querySelector()<br>  返回匹配指定的 CSS 选择器的元素节点。如果有多个节点满足匹配条件，则返回第一个匹配的节点。如果没有发现匹配的节点，则返回 null。<br>  IE8+ 支持；无法选中 CSS 伪元素</p>
</li>
<li><p>querySelectorAll()<br>  返回一个匹配指定的 CSS 选择器的所有元素节点列表（NodeList 类型的对象）。NodeList 对象不是动态集合，所以元素节点的变化无法实时反映在返回结果中。<br>  参数可以是逗号分隔的多个 CSS 选择器，返回所有匹配其中一个选择器的元素节点。<br>  IE8+ 支持；无法选中 CSS 伪元素</p>
</li>
<li><p>ownerDocument<br>  返回当前节点所在的顶层文档对象，即 Document 对象</p>
</li>
<li><p>parentNode<br>  父节点，浏览器的 parentNode 最终路线是 Element -&gt; body -&gt; html -&gt; #document；父节点只可能是三种类型：Element 节点、document 节点和 documentfragment 节点；对于 document 节点和 documentfragment 节点，它们的父节点都是 null。另外，对于那些生成后还没插入 DOM 树的节点（存在于 DOM 超空间），父节点也是 null。</p>
</li>
<li><p>parentElement<br>  父 Element 节点。如果当前节点没有父节点，或者父节点类型不是 Element 节点，则返回 null。在 IE 浏览器中，只有 Element 节点才有该属性，其他浏览器则是所有类型的节点都有该属性。</p>
</li>
<li><p>childNodes<br>  遍历出所有的子节点，包括 Element 节点、Text 节点、Comment 节点，但不包括属性节点；如果不包含任何节点，则返回空数组</p>
<blockquote>
<p>注：现代浏览器把 Element 节点间的换行看为一个 Text 节点，IE8- 则忽略它</p>
</blockquote>
</li>
<li><p>firstChild<br>  第一子节点，相当于 childNodes[0]</p>
</li>
<li><p>lastChild<br>  最终子节点，相当于 childNodes[length-1]</p>
</li>
<li><p>previousSibling<br>  前一兄弟节点</p>
</li>
<li><p>nextSibling<br>  后一兄弟节点，注意，该属性还包括 Text 节点和 Comment 节点。</p>
</li>
<li><p>children<br>  遍历出所有的子 Element 节点，IE8- 还包括 Comment 节点。</p>
</li>
<li><p>childElementCount<br>  返回当前节点的所有子 Element 节点的数目。IE9+ 支持</p>
</li>
<li><p>firstElementChild<br>  返回第一个子 Element 节点，如果没有，则返回 null。IE9+ 支持</p>
</li>
<li><p>lastElementChild<br>  返回最后一个子 Element 节点，如果没有，则返回 null。IE9+ 支持</p>
</li>
<li><p>textContent<br>  返回当前节点和它的所有后代节点的文本内容。自动忽略当前节点内部的 HTML 标签<br>  该属性是可读写的，设置该属性的值，会用一个新的 Text 节点，替换所有它原来的子节点。它还有一个好处，就是自动对 HTML 标签转义。<br>  对于 Text 节点和 Comment 节点，该属性的值与 nodeValue 属性相同。</p>
</li>
<li><p>hasChildNodes()<br>  返回一个布尔值，表示当前节点是否有子节点。相当于 childNodes.length &lt; 1</p>
</li>
<li><p>hasAttribute()<br>  返回一个布尔值，表示 Element 对象是否有该属性。</p>
</li>
<li><p>getAttribute()<br>  读取特性值（包括自定义属性）<br>  关于 Property 和 Attribute 的区别见下文：<br>  Property：属性，DOM 属性层面，所有的 HTML 元素都由 HTMLElement 类型表示，HTMLElement 类型直接继承自 Element 并添加了一些属性，添加的这些属性分别对应于每个 HTML 元素都有下面的这 5 个标准特性: id,title,lang,dir,class。DOM 节点是一个对象，因此，他可以和其他的 JavaScript 对象一样添加自定义的属性以及方法。property 的值可以是任何的数据类型，对大小写敏感，自定义的 property 不会出现在 html 代码中，只存在 Javascript 中。<br>  Attribute：特性，HTML 属性层面，区别于 property，attribute 只能是字符串，大小写不敏感，出现在 HTML 中，通过类数组 attributes 可以罗列所有的 attribute。<br><br>  标准的 properties 与 attributes 是同步的。非自定义的特性会被以属性的形式添加到 DOM 对象中。这时候操作 property 或者使用操作特性的 DOM 方法如 getAttribute() 都可以操作属性。不过传递给 getAttribute() 的特性名与实际的特性名相同。因此对于 class 的特性值获取的时候要传入 “class”。<br><br>  注 1：对于 style 和 onclick 等属性：getAttribute() 方法访问时会返回字符串，而 HTML DOM 方法返回的是相应的对象和事件处理函数。<br>       href：getAttribute 获取的是 href 的字面量值，而 HTML DOM 方法获取的是计算后的完整 url，存在浏览器差异。<br>  注 2：在 IE6 中，读取 for 和 class 属性时，使用 htmlFor 和 className；所以读取这些属性时为了兼容要分别对 IE 和其他浏览器写不同的语句，不如使用 HTML DOM 方便<br>  注 3：在 IE6&#x2F;Safari 中，将 HTML 属性 等同于 DOM 属性，即允许不加区别地使用 x.getAttribute(“属性”)（DOM Core）和 x. 属性（HTML DOM），而其他浏览器将这两者视为不同的个体<br>  注 4：getAttributeNode() 方法用来读取属性节点，通过此方法获得的才是节点对象，才有 nodeName、nodeValue、nodeType 等属性<br>  注 5：jQuery 中，attr() 获取 Attribute 值，prop() 获取 Property 值，对于 autofocus、checked、disabled、readOnly 和 selected 值，一般用 prop() 方法，其他用 attr() 方法</p>
</li>
<li><p>tagName<br>  该属性返回指定元素的大写的标签名，与 nodeName 属性的值相等。</p>
</li>
</ul>
<h3 id="两个根节点"><a href="#两个根节点" class="headerlink" title="两个根节点"></a>两个根节点</h3><ul>
<li><p>document.documentElement 指文档的 &lt;html&gt; 标签</p>
<blockquote>
<p>注：该节点在 HTML 代码加载时就存在；对现代浏览器来说，以此为页面根节点</p>
</blockquote>
</li>
<li><p>document.body 指文档的 &lt;body&gt; 标签</p>
<blockquote>
<p>注：该节点在 HTML DOM 构造完才存在</p>
</blockquote>
</li>
</ul>
<h3 id="NodeList"><a href="#NodeList" class="headerlink" title="NodeList"></a>NodeList</h3><p>是一组节点的集合，会包含文档中的所有节点，如 Element、Text 和 Comment 等。比如 Node.childNodes、document.querySelectorAll()。它们返回的都是一个部署了 NodeList 接口的对象。<br>NodeList 接口有时返回一个动态集合，有时返回一个静态集合。<br>所谓动态集合就是一个活的集合，DOM 树删除或新增一个相关节点，都会立刻反映在 NodeList 接口之中。Node.childNodes 返回的，就是一个动态集合。<br>document.querySelectorAll 方法返回的是一个静态集合，DOM 内部的变化，并不会实时反映在该方法的返回结果之中。<br>NodeList 接口提供 length 属性和数字索引，因此可以像数组那样，使用数字索引取出每个节点，但是它本身并不是数组，只是一个类似于数组的对象（简称类数组），不能使用 pop 或 push 等数组特有的方法。</p>
<blockquote>
<p>注：NodeList 对象比 HTMLCollection 对象 多提供了一个 forEach() 方法（仅现代浏览器，IE 不支持）。<br>    属于 DOM Core 规范。</p>
</blockquote>
<h3 id="HTMLCollection"><a href="#HTMLCollection" class="headerlink" title="HTMLCollection"></a>HTMLCollection</h3><p>与 NodeList 接口类似，也是节点的集合，但是集合成员都是 Element 节点。该接口都是动态集合，节点的变化会实时反映在集合中。document.links、document.forms、document.images 等属性，返回的都是 HTMLCollection 接口对象。<br>部署了该接口的对象，具有 length 属性和数字索引，因此是一个类似于数组的对象。</p>
<p>与 NodeList 接口类似，也是节点的集合，但是集合成员都是 Element 节点。该接口都是动态集合，节点的变化会实时反映在集合中。document.links、document.forms、document.images 等属性和 getElementsBy 系列方法，返回的都是 HTMLCollection 接口对象。<br>部署了该接口的对象，具有 length 属性和数字索引，也是一个类数组对象。</p>
<blockquote>
<p>注：HTMLCollection 对象比 NodeList 对象 多提供了一个 namedItem() 方法。<br>属于 DOM HTML 规范。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">findNode</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> obj = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;testdiv&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">className</span> + <span class="string">&quot;；&quot;</span> + obj.<span class="title function_">getAttribute</span>(<span class="string">&quot;className&quot;</span>) + <span class="string">&quot;；&quot;</span> + obj.<span class="title function_">getAttribute</span>(<span class="string">&quot;class&quot;</span>));</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">style</span> + <span class="string">&quot;；&quot;</span> + obj.<span class="title function_">getAttribute</span>(<span class="string">&quot;style&quot;</span>));</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">onclick</span> + <span class="string">&quot;；&quot;</span> + obj.<span class="title function_">getAttribute</span>(<span class="string">&quot;onclick&quot;</span>));</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">length</span> + <span class="string">&quot;；&quot;</span> + obj.<span class="title function_">getAttribute</span>(<span class="string">&quot;length&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">nodeArray</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> contain = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;tr&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(contain.<span class="property">length</span>);</span><br><span class="line">    <span class="comment">// 建立一个辅助数组，用来存储要移除的 tr 元素</span></span><br><span class="line">    <span class="keyword">var</span> hidden = [];</span><br><span class="line">    <span class="comment">// 建立一个超空间中的元素，用来存储已移除的 tr 元素</span></span><br><span class="line">    <span class="keyword">var</span> tempRoom = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;table&quot;</span>);</span><br><span class="line">    <span class="comment">// 建立一个类似于关联数组的对象，用来存储已经移除的单个 tr 元素的引用</span></span><br><span class="line">    hiddenPointer = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">    <span class="comment">// 创建一个标记用来记录移除 tr 元素的原始位置，方便以后重新插入</span></span><br><span class="line">    <span class="keyword">var</span> marker = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; contain.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (contain[i].<span class="title function_">getAttribute</span>(<span class="string">&quot;rel&quot;</span>)) &#123;</span><br><span class="line">            <span class="comment">// 把有 rel 属性的要移除的 tr 元素存进辅助数组</span></span><br><span class="line">            hidden.<span class="title function_">push</span>(contain[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果辅助数组有长度，即它仍然包含有元素</span></span><br><span class="line">    <span class="keyword">while</span> (hidden.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> rel = hidden[<span class="number">0</span>].<span class="title function_">getAttribute</span>(<span class="string">&quot;rel&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!hiddenPointer[rel]) &#123;</span><br><span class="line">            hiddenPointer[rel] = [];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// tr 元素的 rel 属性可能为同一值，这样的话，它们会被添加进同一个 hiddenPointer[rel] 数组</span></span><br><span class="line">        <span class="keyword">var</span> relIndex = hiddenPointer[rel].<span class="property">length</span>;</span><br><span class="line">        <span class="comment">// 添加进同一个 hiddenPointer[rel] 数组时，数组长度对应 + 1</span></span><br><span class="line">        hiddenPointer[rel][relIndex] = hidden[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> newMarker = marker.<span class="title function_">cloneNode</span>(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">// 对标记来说，选择一个简单的 ID 命名方案很重要</span></span><br><span class="line">        newMarker.<span class="property">id</span> = rel + relIndex;</span><br><span class="line">        <span class="comment">// 把 tr 元素替换成标识符，同时 tr 元素从文档中移除</span></span><br><span class="line">        hidden[<span class="number">0</span>].<span class="property">parentNode</span>.<span class="title function_">replaceChild</span>(newMarker, hidden[<span class="number">0</span>]);</span><br><span class="line">        <span class="comment">// 把从文档中移除的 tr 元素（虽然被从文档中移除了，但是辅助数组还指向它，所以可以操作）添加进超空间的存储元素中，另外使用 shift() 来更新一下对应的辅助数组（这是真实的数组，不是节点列表，所以不会自动更新）</span></span><br><span class="line">        tempRoom.<span class="title function_">appendChild</span>(hidden.<span class="title function_">shift</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 把这些 tr 重新添加进文档后，指向 tr 的节点列表的 length 会自动更新，所以长度不变</span></span><br><span class="line">    <span class="comment">//document.body.appendChild(tempRoom)</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(contain.<span class="property">length</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="DOM-常用操作节点方法"><a href="#DOM-常用操作节点方法" class="headerlink" title="DOM 常用操作节点方法"></a>DOM 常用操作节点方法</h2><h3 id="创建节点："><a href="#创建节点：" class="headerlink" title="创建节点："></a>创建节点：</h3><ul>
<li><p>createElement()<br>  参数为元素的标签名，为小写。创建出的 Element 节点在没有添加到文档中时，保存于 DOM 超空间中</p>
</li>
<li><p>createTextNode()<br>  不能创建类似于 “&copy;” 或 “&#8212;” 这样的 HTML 实体，遇到这样的需求时只能用 innerHTML 来代替</p>
</li>
<li><p>cloneNode()<br>  它接受一个布尔值作为参数，表示是否同时复制子节点，默认是 false，即不复制子节点。复制 Element 节点时不会复制绑定在其上的事件处理函数，所以对复制出来的节点要重新定义事件</p>
</li>
</ul>
<h3 id="修改节点："><a href="#修改节点：" class="headerlink" title="修改节点："></a>修改节点：</h3><ul>
<li><p>appendChild()<br>  将一个节点插入到指定的父节点的最末尾处</p>
</li>
<li><p>insertBefore()<br>  它接受两个参数，第一个参数是待插入的新节点，第二个参数是当前操作节点的一个子节点，新节点将插在这个子节点的前面。如果第二个参数为 null，则新节点将插在当前操作节点的最后位置，即变成最后一个子节点，相当于 appendChild。</p>
</li>
<li><p>removeChild()<br>  移除后的 Element 节点也保存于 DOM 超空间中，只要有一个指向该节点的引用，它就保持可用，除非该引用设置为 null</p>
</li>
<li><p>replaceChild()<br>  用于将一个新的节点，替换当前节点的某一个子节点。它接受两个参数，第一个参数是用来替换的新节点，第二个参数将要被替换走的子节点。它返回被替换走的那个节点。<br>  以上四种方法返回值都是操作的节点对象</p>
</li>
<li><p>setAttribute()<br>  设置属性值（包括自定义属性）；另外使用 HTML DOM 方法有更好的兼容性（见注），但对元素的自定义属性无效（Firefox 中）</p>
<blockquote>
<p>注：在 IE6 中，不能设置某些属性包括对象属性、事件属性、复合属性，例如 class、onclick、style 等；而应该使用 HTML DOM 方法：<br>      x.className &#x3D; “demo”;<br>      x.onclick &#x3D; handle();<br>      x.style.cssText &#x3D; “font-weight:bold;color:red;”;</p>
</blockquote>
</li>
<li><p>removeAttribute()<br>  删除属性值（包括自定义属性）</p>
</li>
<li><p>normailize()<br>  用于清理当前节点内部的所有 Text 节点。它会去除空的文本节点，并且将毗邻的文本节点合并成一个。</p>
</li>
<li><p>dataset<br>  该属性用于操作 HTML 标签元素的 data-* 属性。目前，IE11 支持。dataset 属性使用驼峰命名法表示属性名，而 data 属性本身只能使用连词号，不能使用驼峰拼写法<br>  <div id="myDiv" data-true-id="myId"></div> &#x3D;&#x3D;&gt; document.getElementById(“myDiv”).dataset.trueId;</p>
</li>
</ul>
<h3 id="比较节点："><a href="#比较节点：" class="headerlink" title="比较节点："></a>比较节点：</h3><ul>
<li><p>contains()<br>  接受一个节点作为参数，返回一个布尔值，表示参数节点是否为当前节点的后代节点。</p>
</li>
<li><p>compareDocumentPosition()<br>  与 contains 方法完全一致，返回一个7个比特位的二进制值，表示参数节点与当前节点的关系。IE9+ 支持</p>
</li>
<li><p>isEqualNode()<br>  返回一个布尔值，用于检查两个节点是否相等。所谓相等的节点，指的是两个节点的类型相同、属性相同、子节点相同。IE9+ 支持</p>
</li>
</ul>
<h3 id="其他方法："><a href="#其他方法：" class="headerlink" title="其他方法："></a>其他方法：</h3><ul>
<li><p>innerHTML<br>  返回该元素包含的 HTML 代码。本来是 IE 的专有属性，但现在所有浏览器都支持，而且在添加结构复杂的元素时，<a target="_blank" rel="noopener" href="http://www.quirksmode.org/dom/innerhtml.html">它比 W3C DOM 方法（createElement()&#x2F;appendChild()）更快</a><br>  这是微软标准优于 W3C 标准的地方之一<br>  而且它和 W3C DOM 方法合作很好，通过其中一种方法的改动结果在另外一种方法中立即可用</p>
<blockquote>
<p>注：如果文本节点中包含 &amp;、小于号（&lt;）和大于号（&gt;），innerHTML 属性会将它们转为实体形式 &amp;amp、&amp;lt、&amp;gt。<br>  注：在 IE 中要特别注意，使用了 innerHTML &#x3D; “” 后，所有后代 Text 节点会被销毁，而不会保存在超空间中</p>
</blockquote>
</li>
<li><p>outerHTML<br>  返回指定元素的所有 HTML 代码，包括它自身和包含的所有子元素。相当于 innerHTML 的内容 + 元素的外围标签。Firefox11 以后版本支持</p>
<blockquote>
<p>注：对它进行赋值，等于替换掉当前元素。</p>
</blockquote>
</li>
<li><p>innerText、outerText<br>  显示 Element 节点的包含文本（只有 Firefox 不支持），对应于 W3C 标准的 textContent 属性（IE9+ 支持）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xText = x.<span class="property">innerText</span> || x.<span class="property">textContent</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：textContent 属性与 innerTex 属性还有些差异：innerText 受 CSS 影响，textcontent 不受；innerText 返回的文本，会过滤掉空格、换行和回车键，textcontent 则不会，只能用正则替换掉。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x.<span class="property">textContent</span>.<span class="title function_">replace</span>(<span class="regexp">/\ \ /g</span>,<span class="string">&quot;&quot;</span>).<span class="title function_">replace</span>(<span class="regexp">/(^\n+)|(\n+$)/g</span>,<span class="string">&quot;&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">appendHtml</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> testdiv = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;testdiv&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!testdiv) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// W3C DOM 方法</span></span><br><span class="line">    <span class="keyword">var</span> para = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;p&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> txt1 = <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="string">&quot;这是一个&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> emph = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;em&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> txt2 = <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="string">&quot;DOM 创建的&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> txt3 = <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="string">&quot;文本内容&quot;</span>);</span><br><span class="line">    para.<span class="title function_">appendChild</span>(txt1);</span><br><span class="line">    emph.<span class="title function_">appendChild</span>(txt2);</span><br><span class="line">    para.<span class="title function_">appendChild</span>(emph);</span><br><span class="line">    para.<span class="title function_">appendChild</span>(txt3);</span><br><span class="line">    testdiv.<span class="title function_">appendChild</span>(para);</span><br><span class="line">    <span class="comment">// innerHTML 方法，更简洁</span></span><br><span class="line">    testdiv.<span class="property">innerHTML</span> += <span class="string">&quot;&lt;p&gt; 这是一个 &lt;em&gt;innerHTML 创建的 &lt;/em&gt; 文本内容 &lt;/p&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> show = testdiv.<span class="property">lastChild</span>.<span class="property">childNodes</span>[<span class="number">1</span>].<span class="property">firstChild</span>.<span class="property">nodeValue</span>;</span><br><span class="line">    <span class="keyword">if</span> (!show) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(show);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showNode</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> obj = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;testdiv&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> temp = obj.<span class="property">parentNode</span>;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    console.log(obj.innerHTML);</span></span><br><span class="line"><span class="comment">    console.log(obj.outerHTML);</span></span><br><span class="line"><span class="comment">    console.log(obj.innerText);</span></span><br><span class="line"><span class="comment">    console.log(obj.textContent);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    // 首先移除 Element 节点，保存在超空间</span></span><br><span class="line"><span class="comment">    var re = temp.removeChild(obj);</span></span><br><span class="line"><span class="comment">    // 移除父元素内容，IE 会把后代 Text 节点销毁，由于刚才已经提前保存在超空间，obj 中的文本反而没有丢失</span></span><br><span class="line"><span class="comment">    temp.innerHTML = &quot;&quot;;</span></span><br><span class="line"><span class="comment">    //obj = null;</span></span><br><span class="line"><span class="comment">    obj.appendChild(document.createTextNode(&quot; 移除后又创建的节点，它保存在于超空间中 &quot;));</span></span><br><span class="line"><span class="comment">    temp.appendChild(obj);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="0-级-DOM-和表单"><a href="#0-级-DOM-和表单" class="headerlink" title="0 级 DOM 和表单"></a>0 级 DOM 和表单</h2><p>随着 W3C DOM 的发展，0 级 DOM 已经渐渐没有用武之地，而被功能更强大、通用性更佳的前者所替代。只有一个例外，那就是对表单和表单域的处理</p>
<p>四个重要区别：<br>0. 0 级 DOM 的节点列表只对有限的几个元素可用，最主要是图片、链接和表单域<br>        document.images[] 相当于 document.getElementsByTagName(“img”)<br>        document.links[]（<a href>） + document.anchors[]（<a name>） 相当于 document.getElementsByTagName(“a”)<br>        document.forms[] 相当于 document.getElementsByTagName(“form”)<br>        document.scripts[] 相当于 document.getElementsByTagName(“script”)<br>0. 0 级 DOM 的节点列表查找元素时，除了可用使用索引数字，还允许使用 name 和 id<br>        document.images[0] 相当于 document.getElementsByTagName(“img”)[0]<br>        另外还可以使用 document.images[“name”]、document.images[“id”] 来查找元素<br>0. 0 级 DOM 的节点列表 options[]，允许添加和移除 option 元素<br>        options[] 不等同于 getElementsByTagName(“option”)，前者可以添加或移除元素；而后者是个普通的 W3C DOM 的只读节点列表<br>0. 0 级 DOM 的节点列表 elements[] 在 W3C DOM 中没有对应的实现<br>        document.forms[0].elements[] 表示第一个表单的所有表单域，而因为表单域通常会有不同的标签名（input、select、textarea），所以不能用 getElementsByTagName() 来把它们全读取到，即使调用多次也不能按表单域在文档中出现的顺序来读取它们，所以这是一个很有用而 W3C DOM 未实现的功能</p>
<h3 id="表单域常见属性"><a href="#表单域常见属性" class="headerlink" title="表单域常见属性"></a>表单域常见属性</h3><ul>
<li>type 表单域类型：text、hidden、textarea、checkbox、radio、select、file、submit、reset，不推荐改变该值，因为不是所有浏览器都支持</li>
<li>form 指向父表单对象，因为表单域的 parentNode 不一定就是 &lt;form&gt; 标签，所以这个属性很有用</li>
<li>disabled 表单域是否可用，禁用的表单域即使有值也不会发回给服务器</li>
<li>name 不推荐改变该值，因为不是所有浏览器都支持</li>
<li>value 这是通常需要的值</li>
</ul>
<p>其中：</p>
<ul>
<li>text、hidden、textarea 的值在 value 属性中</li>
<li>checkbox 的值在 checked 属性中<br>  &#x2F;&#x2F; 读取复选框（checkbox 元素）的 checked 属性有两种方法：<br>      ① .checked<br>          元素的 Property 属性，决定该元素是否为选中状态<br>          true 选择 &#x2F; false 未选<br>      ② .getAttribute(“checked”)<br>          元素的 Attribute 属性<br>          对 IE6、7：true &#x2F; false<br>          对 IE8：checked &#x2F; ‘’<br>          对 IE9+、现代浏览器：真实值 &#x2F; null<br><br>  &#x2F;&#x2F; 对应的，设置复选框的 checked 属性也有两种方法：<br>      ① .checked<br>          true&#x2F;false<br>          注：在 IE9+、现代浏览器中，只能影响 DOM 属性，不会改变 HTML 属性<br>      ② .setAttribute(“checked”)<br>          对 IE：setAttribute(“checked”,”checked”)&#x2F;setAttribute(“checked”,””)<br>          对 Firefox：setAttribute(“checked”,”checked”)&#x2F;removeAttribute(“checked”)</li>
<li>radio 的值也在 checked 属性中，但用起来相对复杂些。同组相关的单选框有相同的 name 属性，可以通过 document.forms[0].elements[“radioName”] 来读取它们<br>  function radio(e) {<br>      var evt &#x3D; e || window.event;<br>      var evtTarget &#x3D; evt.target || evt.srcElement;<br>      &#x2F;&#x2F; 找出成为事件目标对象的单选框，通过 form 查找父表单，通过 name 查找同名单选框<br>      var allRadios &#x3D; evtTarget.form[evtTarget.name];<br>      for (var i &#x3D; 0; i &lt; allRadios.length; i++) {<br>          &#x2F;&#x2F; 然后对整组同名的单选框进行操作<br>      }<br>      return false;<br>  };</li>
<li>select（类型是 select-one）也有 value 值，取自其被选中项的 value 属性（注：当选中项没有 value 属性时，Firefox 会读取对应的 Text 节点，相当于 text 属性）；另外还有个 selectedIndex 属性表示选中项的索引；最后它的 options[] 节点列表包含了所有选项<br>  &#x2F;&#x2F; 添加选项（option 元素）的方法比较特殊，有三种：<br>      ① 0 级 DOM 方法<br>      var newOpt &#x3D; new Option(“来选择”,”1”);<br>      select.options[0] &#x3D; newOpt;<br>      ② W3C DOM 方法<br>      var newOpt &#x3D; document.createElement(“option”);<br>      var oText &#x3D; document.createTextNode(“选择”);<br>      newOpt.appendChild(oText);<br>      newOpt.setAttribute(“value”,”1”);<br>      select.appendChild(newOpt);<br>      ③ 混合方法<br>      var newOpt &#x3D; document.createElement(“option”);<br>      newOpt.text &#x3D; “请选择”;<br>      newOpt.value &#x3D; “1”;<br>      select.options.add(newOpt);<br><br>  &#x2F;&#x2F; 移除选项（option 元素）的方法有两种：<br>      ① 0 级 DOM 方法<br>      select.options[0] &#x3D; null<br>      ② W3C DOM 方法<br>      select.removeChild(select.getElementsByTagName(“option”)[0]);</li>
<li>file 因为安全策略，不允许脚本设置 value 值</li>
<li>submit、reset 的 value 值就是按钮上的文字，而 button 的文字是单独 Text 节点，没有 value 值</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">testSelect</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> elem = <span class="variable language_">document</span>.<span class="property">forms</span>[<span class="number">1</span>].<span class="property">elements</span>;</span><br><span class="line">    <span class="keyword">if</span> (!elem) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//console.log(elem.length);</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; elem.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="comment">//console.log(&quot;类型&quot;+elem[i].type+&quot;；名称&quot;+elem[i].name+&quot;；值&quot;+elem[i].value);</span></span><br><span class="line">        <span class="keyword">if</span> (elem[i].<span class="property">type</span> == <span class="string">&quot;select-one&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> sindex = elem[i].<span class="property">selectedIndex</span>;</span><br><span class="line">            <span class="comment">//console.log(&quot;select 的值：&quot;+elem[i].value+&quot;也是其选中项的值：&quot;+elem[i].options[sindex].value);</span></span><br><span class="line">            <span class="comment">//console.log(elem[i].options[sindex].text);</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//console.log(elem[i].options.length);</span></span><br><span class="line">            <span class="comment">//console.log(elem[i].getElementsByTagName(&quot;option&quot;).length);</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> foo = elem[i].<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;option&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">            elem[i].<span class="title function_">removeChild</span>(foo);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//console.log(elem[i].options.length);</span></span><br><span class="line">            <span class="comment">//console.log(elem[i].getElementsByTagName(&quot;option&quot;).length);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> select = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;select&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> newOpt = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;option&quot;</span>);</span><br><span class="line">    newOpt.<span class="property">innerHTML</span> = <span class="string">&quot;&amp;copy; 选择&quot;</span>;</span><br><span class="line">    newOpt.<span class="title function_">setAttribute</span>(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    select.<span class="title function_">appendChild</span>(newOpt);</span><br><span class="line">    <span class="keyword">var</span> oldOpt = newOpt.<span class="title function_">cloneNode</span>(<span class="literal">true</span>);</span><br><span class="line">    select.<span class="title function_">appendChild</span>(oldOpt);</span><br><span class="line">    select.<span class="property">options</span>.<span class="title function_">add</span>(<span class="keyword">new</span> <span class="title class_">Option</span>(<span class="string">&quot; 来选择 &quot;</span>,<span class="string">&quot;3&quot;</span>));</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;navigation&quot;</span>).<span class="title function_">appendChild</span>(select);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="要点总结"><a href="#要点总结" class="headerlink" title="要点总结"></a>要点总结</h4><pre><code>// 检测一个元素是否在超空间中可以看它是否有 parentNode 属性，因为在超空间的元素属于 “自由漂浮”，不会有父元素，而每个 HTML 元素都有一个 parentNode

// 移去一个元素的所有子节点的方法
while (x.firstChild) &#123;
    x.removeChild(x.firstChild);
&#125;
相当于 x.innerHTML = &quot;&quot;;

// 在 IE6 中，对于 createElement() 创建出的 checkbox 元素，必须先把其添加进文档，然后才能设置 checked 属性

// 在 IE6 中，对于 createElement() 创建出的元素，不能在创建后设置其 name 属性：http://msdn.microsoft.com/en-us/library/ms534184.aspx
// 必须使用 IE 的特殊方法：
var anchor = document.createElement(&quot;&lt;a name=&#39;anchorname&#39;&gt;&lt;/a&gt;&quot;)
// 或直接用 innerHTML

// 在 IE6 中，创建表格元素时特别注意：tr 必须放在 tbody 之下，不能直接在 table 之下；只有 td 支持 innerHTML
</code></pre>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">testCreateElem</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> newField = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">    newField.<span class="property">type</span> = <span class="string">&quot;checkbox&quot;</span>;</span><br><span class="line">    newField.<span class="property">name</span> = <span class="string">&quot;select&quot;</span>;</span><br><span class="line">    newField.<span class="property">value</span> = <span class="string">&quot;复选框&quot;</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;navigation&quot;</span>).<span class="title function_">appendChild</span>(newField);</span><br><span class="line">    newField.<span class="property">checked</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/22/09.ecma06/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="可口可乐">
      <meta itemprop="description" content="Personal Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lizux">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/09/22/09.ecma06/" class="post-title-link" itemprop="url">JavaScript 读书心得之六：事件（Event）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2015-09-22 00:00:00" itemprop="dateCreated datePublished" datetime="2015-09-22T00:00:00+08:00">2015-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-10-26 10:32:58" itemprop="dateModified" datetime="2023-10-26T10:32:58+08:00">2023-10-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="兼容性"><a href="#兼容性" class="headerlink" title="兼容性"></a>兼容性</h2><p>这一部分是最可能出现浏览器兼容性问题的地方</p>
<ul>
<li>事件（用户采取的触发脚本的行为）&#x3D;&#x3D;&#x3D;&gt; 少</li>
<li>绑定事件处理（Attach Event Handler）函数（定义事件发生时执行哪个函数）&#x3D;&#x3D;&#x3D;&gt; 有，多在 W3C 和微软标准间</li>
<li>事件冒泡和捕获（元素和其祖先元素处理相同事件时，事件处理函数的触发顺序）&#x3D;&#x3D;&#x3D;&gt; 少</li>
<li>访问事件对象（该对象保存着脚本需要的事件信息）&#x3D;&#x3D;&#x3D;&gt; 多，某些无法解决</li>
<li>访问目标对象（发生事件的元素）&#x3D;&#x3D;&#x3D;&gt; 少</li>
</ul>
<h2 id="事件列表"><a href="#事件列表" class="headerlink" title="事件列表"></a>事件列表</h2><ul>
<li>鼠标事件：<ul>
<li>click 左键单击</li>
<li>dblclick 左键双击</li>
<li>mouseover&#x2F;mouseout 鼠标移至和移开</li>
<li>mousedown&#x2F;mouseup 鼠标按下和释放</li>
<li>mousemove 鼠标移动</li>
<li>mousewheel 鼠标滚轮滚动</li>
<li>mouseenter&#x2F;mouseleave 鼠标移至和移开（一次触发。IE 优先支持，FF10、Chrome30 才开始支持，这是微软标准优于 W3C 标准的地方之一）。<br>触发顺序：mousedown 首先触发，mouseup 接着触发，click 最后触发</li>
</ul>
</li>
<li>键盘事件：<ul>
<li>keydown&#x2F;keyup 按下和释放按键</li>
<li>keypress 按下按键（只字母、数字键有效，很少用）</li>
</ul>
</li>
<li>接口事件：<ul>
<li>focus&#x2F;blur 获得和失去焦点</li>
<li>change 表单域值改变（在失去焦点后才触发）</li>
<li>input 表单域值改变 (随时触发，IE9+ 支持)</li>
<li>contextmenu 右键菜单</li>
<li>load&#x2F;unload 元素加载和释放</li>
<li>readystatechange 用来支持 XMLHttpRequest</li>
<li>reset&#x2F;submit 重置和提交表单</li>
<li>resize 改变窗口尺寸</li>
<li>scroll 滚动页面</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="http://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/events.html#Events-MutationEvent">W3C 事件</a>、<a target="_blank" rel="noopener" href="https://msdn.microsoft.com/en-us/library/ms533051.aspx">微软事件</a></li>
</ul>
<p>优化 resize 事件，在结束后集中触发</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> resizeCallback = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> delay = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">var</span> executionTimer;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> winX = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientWidth</span>;</span><br><span class="line">        <span class="keyword">var</span> winY = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span>;</span><br><span class="line">        <span class="keyword">if</span> (executionTimer) &#123;</span><br><span class="line">            <span class="built_in">clearTimeout</span>(executionTimer);</span><br><span class="line">        &#125;</span><br><span class="line">        executionTimer = <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;delayEvent&quot;</span>).<span class="property">innerHTML</span> = <span class="string">&quot;尺寸：&quot;</span> + winX + <span class="string">&quot;：&quot;</span> + winY;</span><br><span class="line">        &#125;, delay);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;();</span><br><span class="line"><span class="title function_">addEvent</span>(<span class="variable language_">window</span>, <span class="string">&#x27;resize&#x27;</span>, resizeCallback);</span><br></pre></td></tr></table></figure>

<h3 id="默认操作"><a href="#默认操作" class="headerlink" title="默认操作"></a>默认操作</h3><p>很多事件有个关联的默认操作；一般是事件处理函数先执行，然后默认操作发生，所以事件处理函数可以取消默认操作；唯一例外是 unload，它不能被取消<br>要让事件处理函数取消默认操作，该函数必须返回 false（其他任何值都会默认操作发生），并且要正确绑定</p>
<p>绑定事件并能正确返回值的方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">demo</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;你在点击页面&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 方法①：</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">onclick</span> = demo;</span><br><span class="line"><span class="comment">// 方法②：</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">demo</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 方法③：</span></span><br><span class="line">&lt;body onclick=<span class="string">&quot;return demo()&quot;</span>&gt;&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h2 id="模拟事件的方法"><a href="#模拟事件的方法" class="headerlink" title="模拟事件的方法"></a>模拟事件的方法</h2><p>目前支持</p>
<ul>
<li>focus()</li>
<li>blur()</li>
<li>click()</li>
<li>submit()（无法触发 submit 事件）</li>
<li>reset()</li>
</ul>
<blockquote>
<p>注：Opera 中，当按键按下时只会触发一次 keydown 事件，而在其他浏览器当中则都会按照一定的频率来触发</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="http://www.matts411.com/post/delaying_javascript_event_execution/">延迟事件触发</a> 函数，可以减少事件触发次数，提高性能（闭包的应用）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> onEventEnd = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> delay = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">var</span> executionTimer;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> evt = e || <span class="variable language_">window</span>.<span class="property">event</span>;</span><br><span class="line">        evtX = evt.<span class="property">pageX</span> || evt.<span class="property">clientX</span> + <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollLeft</span>, <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollLeft</span>);</span><br><span class="line">        evtY = evt.<span class="property">pageY</span> || evt.<span class="property">clientY</span> + <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span>, <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollTop</span>);</span><br><span class="line">        <span class="keyword">if</span> (executionTimer) &#123;</span><br><span class="line">            <span class="built_in">clearTimeout</span>(executionTimer);</span><br><span class="line">        &#125;</span><br><span class="line">        executionTimer = <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;delayEvent&quot;</span>).<span class="property">innerHTML</span> = <span class="string">&quot;鼠标位置：&quot;</span> + evtX + <span class="string">&quot;：&quot;</span> + evtY;</span><br><span class="line">        &#125;, delay);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;();</span><br><span class="line"><span class="title function_">addEvent</span>(<span class="variable language_">document</span>,<span class="string">&#x27;mousemove&#x27;</span>,onEventEnd);</span><br></pre></td></tr></table></figure>

<h2 id="绑定事件处理函数"><a href="#绑定事件处理函数" class="headerlink" title="绑定事件处理函数"></a>绑定事件处理函数</h2><h3 id="绑定事件的方法"><a href="#绑定事件的方法" class="headerlink" title="绑定事件的方法"></a>绑定事件的方法</h3><ol start="0">
<li>内联（inline）方式 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;demo()&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">&quot;demo()&quot;</span>&gt;</span></span><br><span class="line">el.setAttribute(&#x27;onclick&#x27;, &#x27;demo()&#x27;);</span><br></pre></td></tr></table></figure>
 缺点：违背了结构和行为分离的原则，不推荐使用</li>
<li>传统方式 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x.<span class="property">onclick</span> = demo;</span><br></pre></td></tr></table></figure>
 注：函数名后无 ()，有了它表示立即执行函数并把返回值赋值给 x 的 onclick 属性<br> 优点：可以通过 x.onclick() 直接执行函数<br> 缺点：不能定义多个函数到一个事件中，后者会覆盖前者</li>
<li>高级方式<br> W3C 和微软都提供了高级的事件处理函数绑定模型来解决覆盖的问题，这些模型允许在同一个事件定义任意数量的事件处理函数<br> W3C 标准使用 <code>addEventListener(type, listener[, useCapture])</code> 和 <code>removeEventListener(type, listener[, useCapture])</code>，微软标准使用 <code>attachEvent()</code> 和 <code>detachEvent()</code>；IE9+、现代浏览器支持前者，IE 支持后者<br> 两者区别：微软标准只支持事件冒泡，不支持事件捕获，不过这个影响不大；微软标准把事件处理函数作为一个全局函数，而不是被绑定元素的一个方法，这会影响到 this 关键字，因为它会永远指向 Window 对象<br> 缺点：不能移除一个事件上所有绑定的事件处理函数，因为高级方式要求必须提供要移除的函数名称；而传统方式可以使用 x.onclick &#x3D; null;<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addEventSimple</span>(<span class="params">obj, evt, fn</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> (obj.<span class="property">addEventListener</span>) &#123;</span><br><span class="line">        obj.<span class="title function_">addEventListener</span>(evt, fn, <span class="literal">false</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (obj.<span class="property">attachEvent</span>) &#123;</span><br><span class="line">        obj.<span class="title function_">attachEvent</span>(<span class="string">&#x27;on&#x27;</span> + evt, fn);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">removeEventSimple</span>(<span class="params">obj, evt, fn</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> (obj.<span class="property">removeEventListener</span>) &#123;</span><br><span class="line">        obj.<span class="title function_">removeEventListener</span>(evt, fn, <span class="literal">false</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (obj.<span class="property">detachEvent</span>) &#123;</span><br><span class="line">        obj.<span class="title function_">detachEvent</span>(<span class="string">&#x27;on&#x27;</span> + evt, fn);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
事件绑定函数 by <a target="_blank" rel="noopener" href="http://www.quirksmode.org/blog/archives/2005/10/_and_the_winner_1.html">John Resig + PPK</a><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addEvent</span>(<span class="params">obj,evt,fn</span>)&#123;<span class="keyword">if</span>(obj.<span class="property">addEventListener</span>)&#123;obj.<span class="title function_">addEventListener</span>(evt,fn,<span class="literal">false</span>)&#125;<span class="keyword">else</span> <span class="keyword">if</span>(obj.<span class="property">attachEvent</span>)&#123;obj[<span class="string">&#x27;e&#x27;</span>+evt+fn]=fn;obj[evt+fn]=<span class="keyword">function</span>(<span class="params"></span>)&#123;obj[<span class="string">&#x27;e&#x27;</span>+evt+fn](<span class="variable language_">window</span>.<span class="property">event</span>)&#125;;obj.<span class="title function_">attachEvent</span>(<span class="string">&#x27;on&#x27;</span>+evt,obj[evt+fn])&#125;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">removeEvent</span>(<span class="params">obj,evt,fn</span>)&#123;<span class="keyword">if</span>(obj.<span class="property">removeEventListener</span>)&#123;obj.<span class="title function_">removeEventListener</span>(evt,fn,<span class="literal">false</span>)&#125;<span class="keyword">else</span> <span class="keyword">if</span>(obj.<span class="property">detachEvent</span>)&#123;obj.<span class="title function_">detachEvent</span>(<span class="string">&#x27;on&#x27;</span>+evt,obj[evt+fn]);obj[evt+fn]=<span class="literal">null</span>;obj[<span class="string">&#x27;e&#x27;</span>+evt+fn]=<span class="literal">null</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">addEvent</span>(<span class="variable language_">window</span>, <span class="string">&#x27;load&#x27;</span>, <span class="keyword">function</span>);</span><br><span class="line"><span class="title function_">removeEvent</span>(<span class="variable language_">window</span>, <span class="string">&#x27;load&#x27;</span>, <span class="keyword">function</span>);</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="一般规则："><a href="#一般规则：" class="headerlink" title="一般规则："></a>一般规则：</h3><ul>
<li>一般不建议使用传统方式，尤其在整个站点由多人开发，会造成事件覆盖</li>
<li>需要大量初始化或事件处理函数可能被反复使用时，使用高级方式 addEventSimple()，但是要特别注意，this 关键字无法正确工作（IE8-）</li>
<li>当需要用到 this 关键字时，可以使用更强大的 addEvent() 函数；或者使用流行库解决（jQuery、Mootools）</li>
</ul>
<h2 id="事件冒泡和捕获"><a href="#事件冒泡和捕获" class="headerlink" title="事件冒泡和捕获"></a>事件冒泡和捕获</h2><ul>
<li>当事件发生时，有多个可选的事件处理函数时，它们都会被触发；而触发的顺序有两种：<ol start="0">
<li>事件冒泡：事件从它的目标开始，触发对应的事件处理函数，然后沿着文档树逐级向上冒泡，直到 Document 对象为止；沿途对每个遇到的元素，都会触发相关的事件处理函数</li>
<li>事件捕获：事件从 Document 对象开始，沿着文档树向下游历，直到事件目标为止；沿途对每个遇到的元素，都会触发相关的事件处理函数</li>
</ol>
</li>
<li>传统方式和微软标准只支持事件冒泡，W3C 标准两者都支持（<code>addEventListener()/removeEventListener()</code> 的第三个参数，true：事件捕获 &#x2F; false：事件冒泡），注：为了避免兼容性问题，推荐只使用事件冒泡</li>
<li>使用事件冒泡，可以把许多元素的事件集中到一个点，只需要在一个元素上设置事件处理函数，这样有事件在它的后代元素上发生时都会冒泡到该元素处，脚本处理就会很简单了</li>
<li>接口事件不冒泡：不是所有的情况都冒泡，blur、focus、load 和 unload 是不冒泡的；另外在某些元素上有些事件是不合法的，比如 change、submit 之类接口事件就不会在 Window 对象或 Document 对象上发生。<br>一般规则：在 Document 对象上，可以捕获鼠标和键盘事件，不能捕获接口事件</li>
<li>取消事件冒泡：W3C 标准使用事件的 <code>stopPropagation()</code> 方法，微软标准使用事件的 <code>cancelBubble</code> 属性；在复杂的动态菜单中，使用了 mouseover 和 mouseout 后，取消它们的传播可以避免一些问题<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">stopBubble</span>(<span class="params">evt</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (evt.<span class="property">stopPropagation</span>) &#123;</span><br><span class="line">        evt.<span class="title function_">stopPropagation</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    evt.<span class="property">cancelBubble</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>取消事件默认操作：W3C 标准使用事件的 preventDefault() 方法，微软标准使用事件的 returnValue 属性<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">stopDefault</span>(<span class="params">evt</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (evt.<span class="property">preventDefault</span>) &#123;</span><br><span class="line">        evt.<span class="title function_">preventDefault</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    evt.<span class="property">returnValue</span> = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="让事件可以到浏览器外也可以触发"><a href="#让事件可以到浏览器外也可以触发" class="headerlink" title="让事件可以到浏览器外也可以触发"></a>让事件可以到浏览器外也可以触发</h3><ul>
<li>微软标准使用对象的 <code>setCapture()</code> 方法，这样对象的事件将会被继承到整个文档进行捕获。当不需要把事件继承到整个文档捕获时，要用 <code>releaseCapture()</code></li>
<li>W3C 标准使用 <code>window.captureEvents(Event.eventType)</code> 和 <code>window.releaseEvents(Event.eventType)</code>，其中 eventType 包括：ABORT、BLUR、CLICK、CHANGE、DBLCLICK、DRAGDROP、ERROR、FOCUS、KEYDOWN、KEYPRESS、KEYUP、LOAD、MOUSEDOWN、MOUSEMOVE、MOUSEOUT、MOUSEOVER、MOUSEUP、MOVE、RESET、RESIZE、SELECT、SUBMIT、UNLOAD<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">alwaysCapture</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj.<span class="property">setCapture</span>) &#123;</span><br><span class="line">        obj.<span class="title function_">setCapture</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">captureEvents</span>) &#123;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="title function_">captureEvents</span>(<span class="title class_">Event</span>.<span class="property">MOUSEMOVE</span> | <span class="title class_">Event</span>.<span class="property">MOUSEUP</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="访问事件对象"><a href="#访问事件对象" class="headerlink" title="访问事件对象"></a>访问事件对象</h2><ul>
<li>当在元素绑定了事件处理函数，就需要访问事件对象了。事件发生时，浏览器会自动创建对象，它包括了事件的各种有用信息：目标对象、事件类型、鼠标位置、按下键值等等</li>
<li>事件对象和其属性备受浏览器兼容性的影响：一些属性名称不一致，一些问题涉及到底层结构，一些属性并非所有浏览器都提供</li>
</ul>
<h3 id="事件对象"><a href="#事件对象" class="headerlink" title="事件对象"></a>事件对象</h3><p>W3C 标准中，事件对象作为第一个参数被传递到当前的事件处理函数中；微软标准中，事件对象总是 window.event</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">handle</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> evt = e || <span class="variable language_">window</span>.<span class="property">event</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="事件对象的属性"><a href="#事件对象的属性" class="headerlink" title="事件对象的属性"></a>事件对象的属性</h3><ul>
<li><p>type 属性：事件类型（click、mouseover、keydown、submit 等）</p>
</li>
<li><p>timeStamp 属性：返回一个毫秒时间戳，表示事件发生的时间。</p>
</li>
<li><p>目标对象（发生事件的元素）：W3C 标准使用 <code>target</code> 属性，微软标准使用 <code>srcElement</code> 属性</p>
</li>
<li><p>鼠标事件（mouseover&#x2F;mouseout）中与目标对象相关的元素：W3C 标准使用 <code>relatedTarget</code> 属性，微软标准使用两个属性：<code>fromElement（mouseover）</code> 指的是鼠标从上移走的元素，<code>toElement（mouseout）</code> 指的是鼠标移到其上的元素</p>
</li>
<li><p>绑定事件处理函数的元素：W3C 标准使用 <code>currentTarget</code> 属性，微软标准的解决方法是使用 <code>this</code> 关键字</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">mover</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> evt = e || <span class="variable language_">window</span>.<span class="property">event</span>;</span><br><span class="line">    <span class="keyword">var</span> evtTarget = evt.<span class="property">target</span> || evt.<span class="property">srcElement</span>;</span><br><span class="line">    <span class="comment">// 修正旧版 Safari 的弊端，它会把目标对象指向其元素包含的文本</span></span><br><span class="line">    <span class="keyword">if</span> (evtTarget.<span class="property">nodeType</span> == <span class="number">3</span>) &#123;</span><br><span class="line">        evtTarget = evtTarget.<span class="property">parentNode</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (evt.<span class="property">type</span> == <span class="string">&quot;mouseover&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> evtRel = evt.<span class="property">relatedTarget</span> || evt.<span class="property">fromElement</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (evt.<span class="property">type</span> == <span class="string">&quot;mouseout&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> evtRel = evt.<span class="property">relatedTarget</span> || evt.<span class="property">toElement</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> evtObj = evt.<span class="property">currentTarget</span> || <span class="variable language_">this</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;target=&quot;</span> + evtTarget.<span class="property">nodeName</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;relatedTarget=&quot;</span> + evtRel.<span class="property">nodeName</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;currentTarget=&quot;</span> + evtObj.<span class="property">nodeName</span>);</span><br><span class="line">    evtObj.<span class="property">style</span>.<span class="property">border</span> = <span class="string">&quot;1px solid #F00&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>鼠标位置，鼠标相对参考点的坐标</p>
<ul>
<li>screenX&#x2F;screenY      参考点：屏幕                        兼容性：所有浏览器</li>
<li>clientX&#x2F;clientY      参考点：视口                        兼容性：所有浏览器</li>
<li>pageX&#x2F;pageY          参考点：页面                        兼容性：所有浏览器，除了 IE8-</li>
<li>offsetX&#x2F;offsetY      参考点：事件目标对象                兼容性：所有浏览器，除了 Firefox39-</li>
<li>layerX&#x2F;layerY        参考点：最近动态定位的祖先元素      兼容性：所有浏览器，除了 IE8-</li>
</ul>
<p>  最有用的是 pageX&#x2F;Y，读取鼠标相对于页面的坐标，但是 IE8- 不支持，但是 IE8- 支持 clientX&#x2F;Y，这是相对于视口的，再加上页面的滚动偏移量 scrollLeft&#x2F;Top，也能得到相同的结果<br>  通用读取鼠标坐标（相对于页面）函数</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">eventPos</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> evt = e || <span class="variable language_">window</span>.<span class="property">event</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(evt.<span class="property">type</span>);</span><br><span class="line">    <span class="keyword">var</span> evtX = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> evtY = <span class="number">0</span>;</span><br><span class="line">    evtX = evt.<span class="property">pageX</span> || evt.<span class="property">clientX</span> + <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollLeft</span>, <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollLeft</span>);</span><br><span class="line">    evtY = evt.<span class="property">pageY</span> || evt.<span class="property">clientY</span> + <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span>, <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollTop</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(evtX+<span class="string">&quot;：&quot;</span>+evtY)</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">onclick</span> = eventPos;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>鼠标按键</p>
<ul>
<li>button 属性，鼠标按键的键值</li>
<li>W3C 标准：左键（0）、中键（1）、右键（2）</li>
<li>微软标准：左键（1）、中键（4）、右键（2，注：Maxthon 中启用鼠标手势后为 0）</li>
<li>IE9+ 支持 W3C 标准，IE8- 支持微软标准</li>
<li>mousedown&#x2F;up 事件支持全部，click 事件仅支持左键<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 禁止鼠标右键菜单，注：某些浏览器有禁用它的选项</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">oncontextmenu</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>键盘按键</p>
<ul>
<li>key 属性：返回一个按下的键名字符串。如果同时按下一个控制键和一个字符键，则返回字符键的键名。IE8-、Chrome 不支持</li>
<li>keyCode 属性：键盘按键的键值（大小写字母不区分）<br>数字键值范围为 48（0）～57（9），字母键值范围为 65（A）～90（Z），而按下 Alt、Ctrl、Shift、Win 键时，对应的 altKey、ctrlKey、shiftKey、metaKey 属性还会为 true</li>
<li>charCode 属性：键盘按键对应的 ASCII 编码（大小写字母对应值不同）。<br>比上个属性多了 97（a）～122（z）<br>注：该属性已经从标准移除，虽然浏览器还支持，但应该尽量不使用。</li>
<li>通过 keydown 和 keyup 事件可以读取 keyCode 值</li>
<li>通过 keypress 事件（仅字母、数字键有效）<ul>
<li>在 Firefox 中可以读取 charCode 值（keyCode 值为 0）；</li>
<li>在 IE8- 中可以读取 keyCode 值（相当于 charCode 值）；</li>
<li>在 IE9+、Chrome 中，可以读取 charCode 值（keyCode 和它一样）</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">showKey</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> evt = e || <span class="variable language_">window</span>.<span class="property">event</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(evt.<span class="property">keyCode</span>);</span><br><span class="line">    <span class="keyword">if</span> (evt.<span class="property">altKey</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;alt&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (evt.<span class="property">ctrlKey</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ctrl&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (evt.<span class="property">shiftKey</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;shift&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">onkeydown</span> = showKey;</span><br></pre></td></tr></table></figure>

<h3 id="访问目标对象"><a href="#访问目标对象" class="headerlink" title="访问目标对象"></a>访问目标对象</h3><ul>
<li>访问目标对象有两种方法：<ul>
<li>使用事件对象的 target&#x2F;srcElement 属性</li>
<li>使用 this 关键字，它一般（并不总是）指向发生事件的元素<br>this 关键字总是指向方法被调用的对象，也就是绑定事件处理函数的元素，相当于 W3C 标准的 currentTarget 属性；而且必须封闭在函数主体中才能正确工作，如：</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">test</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<pre><code>test() 函数是通过全局对象来调用的，所以 test() 内的 this 关键字指向 Window 对象

0. 使用内联方式绑定事件时，函数当作全局函数调用，this 关键字指向 Window 对象；除非直接使用 this 关键字：`&lt;p onclick=&quot;this.style.color=&#39;#000&#39;&quot;&gt;、&lt;p onclick=&quot;setStyle(this)&quot;&gt;`
0. 使用传统方式，函数作为元素的一个方法，this 关键字指向正确的元素
0. 使用 W3C 标准，函数作为元素的一个方法，this 关键字指向正确的元素
0. 使用微软标准，函数当作全局函数调用，this 关键字指向 Window 对象
</code></pre>
<ul>
<li>一般规则：<ol start="0">
<li>当绑定相同的事件处理函数到许多元素或想直接调用该事件处理函数（即使没有事件发生）时，使用 this 关键字</li>
<li>当依赖于事件冒泡使得事件沿文档树由下往上传播时，使用目标对象（target&#x2F;srcElement）属性<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">eventObj</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> obj = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;eventUl&quot;</span>).<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;li&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>;i &lt; obj.<span class="property">length</span>;i++) &#123;</span><br><span class="line">        obj[i].<span class="property">onmouseover</span> = mover;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>
<h2 id="事件绑定的应用："><a href="#事件绑定的应用：" class="headerlink" title="事件绑定的应用："></a>事件绑定的应用：</h2><p>屏蔽 F5 键，防止浏览器刷新页面</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">disableF5</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    e = e || <span class="variable language_">window</span>.<span class="property">event</span>;</span><br><span class="line">    <span class="keyword">if</span> (e.<span class="property">keyCode</span> == <span class="number">116</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">all</span>) &#123;</span><br><span class="line">            e.<span class="property">keyCode</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (e.<span class="property">preventDefault</span>) &#123;</span><br><span class="line">            e.<span class="title function_">preventDefault</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        e.<span class="property">returnValue</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">addEvent</span>(<span class="variable language_">document</span>,<span class="string">&quot;keydown&quot;</span>, disableF5);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>表单验证</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">initForm</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> f = <span class="variable language_">document</span>.<span class="property">forms</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> (!f) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    f.<span class="property">onsubmit</span> = validateForm;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;textarea&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; x.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x[i].<span class="title function_">getAttribute</span>(<span class="string">&#x27;maxlength&#x27;</span>)) &#123;</span><br><span class="line">            <span class="title function_">addEvent</span>(x[i], <span class="string">&quot;change&quot;</span>, checkLength);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkLength</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> evt = e || <span class="variable language_">window</span>.<span class="property">event</span>;</span><br><span class="line">    <span class="comment">//console.log(evt.type);</span></span><br><span class="line">    <span class="comment">//console.log(this.nodeName);</span></span><br><span class="line">    <span class="keyword">var</span> max = <span class="variable language_">this</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;maxlength&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">value</span>.<span class="property">length</span> &gt; max) &#123;</span><br><span class="line">        <span class="keyword">var</span> show = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;span&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> showtext = <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="string">&quot;最多3个字&quot;</span>);</span><br><span class="line">        show.<span class="property">className</span> = <span class="string">&quot;alert&quot;</span>;</span><br><span class="line">        show.<span class="title function_">appendChild</span>(showtext);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">parentNode</span>.<span class="title function_">appendChild</span>(show);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">validateForm</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="variable language_">this</span>.<span class="property">elements</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; x.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x[i].<span class="property">className</span>.<span class="title function_">indexOf</span>(<span class="string">&#x27;required&#x27;</span>) != -<span class="number">1</span> &amp;&amp; !x[i].<span class="property">value</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> show = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;span&quot;</span>);</span><br><span class="line">            <span class="keyword">var</span> showtext = <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="string">&quot;请填写必填项&quot;</span>);</span><br><span class="line">            show.<span class="property">className</span> = <span class="string">&quot;hint&quot;</span>;</span><br><span class="line">            show.<span class="title function_">appendChild</span>(showtext);</span><br><span class="line">            x[i].<span class="property">parentNode</span>.<span class="title function_">appendChild</span>(show);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//alert(isRequired(x[i]));</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isRequired</span>(<span class="params">obj</span>)&#123;</span><br><span class="line">    <span class="keyword">switch</span> (obj.<span class="property">type</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;text&quot;</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;password&quot;</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;textarea&quot;</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;select-one&quot;</span>:</span><br><span class="line">            <span class="keyword">if</span> (obj.<span class="property">value</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;radio&quot;</span>:</span><br><span class="line">            <span class="keyword">var</span> radios = obj.<span class="property">form</span>[obj.<span class="property">name</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; radios.<span class="property">length</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (radios[i].<span class="property">checked</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;checkbox&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> obj.<span class="property">checked</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;submit&quot;</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;reset&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/21/08.ecma05/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="可口可乐">
      <meta itemprop="description" content="Personal Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lizux">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/09/21/08.ecma05/" class="post-title-link" itemprop="url">JavaScript 读书心得之五：浏览器对象模型（BOM）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2015-09-21 00:00:00" itemprop="dateCreated datePublished" datetime="2015-09-21T00:00:00+08:00">2015-09-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-10-26 10:32:58" itemprop="dateModified" datetime="2023-10-26T10:32:58+08:00">2023-10-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>这是核心和 DOM 的中间过渡层，指 JavaScript 的客户端实现，而这个客户端就是 JavaScript 的宿主对象，通常是针对 Web 浏览器，所以称之为 BOM（浏览器对象模型）。<br>BOM 的核心是 Window 对象，JavaScript 的很多对象及其属性、方法并不是 DOM 的一部分，而是定义在了 Window 对象上。<br>标准化方面，核心是 ECMA 标准，DOM 是 W3C 标准，而 BOM 还没有一个事实标准，目前 <a target="_blank" rel="noopener" href="http://www.whatwg.org/">WHAT-WG（Web 超文本应用技术工作组）</a> 正在制定一个规范。不过 BOM 的大部分重要特性都是 Netscape3 事实标准的一部分，可以被所有浏览器支持。</p>
<h2 id="Window-对象"><a href="#Window-对象" class="headerlink" title="Window 对象"></a>Window 对象</h2><p>Window 对象是一个全局对象，它包含了脚本中的所有全局对象及其属性、方法；它还代表了浏览器窗口（viewport，简称视口），因此拥有一些属性、方法对其进行操作；它还包含了重要的 Document 对象，这是 DOM 的基础。</p>
<p>当页面释放（unload）时，Window 对象中的所有对象及其属性、方法被彻底移除，但它本身没有被销毁，指向它的引用依然有效；另外还有一个 closed 属性也保留。这是一个非常重要的特性，可以让脚本进行跨浏览器通信。</p>
<p>每个 Window 对象都是独立的，包括它里面的对象及其属性、方法。</p>
<p>Window 对象还有一个等效的对象 self，即 <code>window.open() 相当于 self.open()、window.name 相当于 self.name</code>。</p>
<h3 id="window-open-方法"><a href="#window-open-方法" class="headerlink" title="window.open() 方法"></a>window.open() 方法</h3><ul>
<li>name 属性用于为链接的 target 属性做引导，另外 window.open() 方法的第二个参数就是 name 属性</li>
<li>opener 属性用于弹出窗口，指向打开它的主窗口；即使弹出窗口加载了新的页面，它的 opener 属性还保存着指向</li>
<li>closed 属性用于表示窗口是否被关闭；页面释放时，所有对象被移除，这是唯一保留的属性</li>
<li>window.close() 方法可以关闭窗口；用户打开的窗口关闭时会让用户确认操作，而脚本打开的窗口可以直接关闭</li>
<li><a target="_blank" rel="noopener" href="http://www.quirksmode.org/js/popup.html">弹出窗口特性列表</a><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> popWindow;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">popup</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// popWindow 为指向弹出窗口对象的变量，popWindow.name 为 “google”，popWindow.opener 为弹出窗口的主窗口</span></span><br><span class="line">    popWindow = <span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&quot;images/test1.html&quot;</span>, <span class="string">&quot;google&quot;</span>, <span class="string">&quot;width=500,height=400&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="跨浏览器通信"><a href="#跨浏览器通信" class="headerlink" title="跨浏览器通信"></a>跨浏览器通信</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">communicate</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> openpop = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;openpop&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!openpop) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    openpop.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">popup</span>();</span><br><span class="line">        <span class="comment">//popWindow.alert(&quot;让弹出窗口进行动作&quot;);</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> newpop = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;newpop&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!newpop) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    newpop.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> child = popWindow.<span class="property">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">        child.<span class="property">innerHTML</span> = <span class="string">&quot;haha，虽然弹出窗口加载了新内容，但是它的内容还是能被改变&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> closepop = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;closepop&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!closepop) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    closepop.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        popWindow.<span class="title function_">close</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>主窗口释放时指向弹出窗口的变量 popWindow 会破坏，所以要让弹出窗口重新恢复 popWindow 对其的指向</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">winExit</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 检测弹出窗口存在与否</span></span><br><span class="line">    <span class="keyword">if</span> (popWindow) &#123;</span><br><span class="line">        popWindow.<span class="title function_">resetParent</span>();</span><br><span class="line">        <span class="comment">//alert(&quot;已经给弹出窗口信息了&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="导航"><a href="#导航" class="headerlink" title="导航"></a>导航</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">navigate</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 假定当前网址为 http://user:passwd@www.example.com:4097/path/a.html?x=111#part1</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> <span class="comment">// &quot;http://user:passwd@www.example.com:4097/path/a.html?x=111#part1&quot;</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">protocol</span> <span class="comment">// &quot;http:&quot;</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">host</span> <span class="comment">// &quot;www.example.com:4097&quot;</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">hostname</span> <span class="comment">// &quot;www.example.com&quot;</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">port</span> <span class="comment">// &quot;4097&quot;</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span> <span class="comment">// &quot;/path/a.html&quot;</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span> <span class="comment">// &quot;?x=111&quot;</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">hash</span> <span class="comment">// &quot;#part1&quot;</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">user</span> <span class="comment">// &quot;user&quot;</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">password</span> <span class="comment">// &quot;passed&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 优先从本地缓存重新加载（默认值），相当于浏览器的 “刷新” 或 “重新载入” 按钮</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="title function_">reload</span>()</span><br><span class="line">    <span class="comment">// 优先从服务器重新加载</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="title function_">reload</span>(<span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 跳转到另一个网址</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="title function_">assign</span>(<span class="string">&#x27;http://www.google.com&#x27;</span>)</span><br><span class="line">    <span class="comment">// 跳转到另一个网址，但当前文档不保留在 history 对象中，即无法用后退按钮，回到当前文档</span></span><br><span class="line">    <span class="comment">// location.replace() 与 location.assign()/location.href 的区别：前者覆盖当前页面，页面历史中只有一个条目；后者相当于点击链接加载新的页面，页面历史中有两个条目</span></span><br><span class="line">    <span class="comment">// 从用户可用性的角度来说，在设置页面自动跳转时，推荐使用后者，避免用户无法使用 “后退” 按钮返回上一个页面，从而会造成类似的死循环</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="title function_">replace</span>(<span class="string">&#x27;http://www.google.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将 location 对象转为字符串，等价于 window.location.href</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="title function_">toString</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 页面历史记录，forward()、back() 方法分别相当于浏览器 “前进”“后退” 按钮，go() 方法可以前进或后退多个页面</span></span><br><span class="line">    <span class="keyword">var</span> his = <span class="variable language_">window</span>.<span class="property">history</span>;</span><br><span class="line">    <span class="comment">// history.length 历史记录的数量</span></span><br><span class="line">    <span class="comment">// his.go(1) 相当于 his.forward();</span></span><br><span class="line">    <span class="comment">// his.go(-1) 相当于 his.back();</span></span><br><span class="line">    <span class="comment">// his.go(0) 相当于 刷新页面;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>location.href 在 IE6 中无效的解决方法：<a target="_blank" rel="noopener" href="http://blog.csdn.net/walksea/archive/2008/02/04/2082244.aspx">参考 1</a>、<a target="_blank" rel="noopener" href="https://support.microsoft.com/en-us/kb/190244">参考 2</a><br>有时候为了实现在页面间跳转，采用如下方法：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:;&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;wopen(&#x27;http://www.google.com/&#x27;);&quot;</span>&gt;</span>google<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">wopen</span>(<span class="params">url</span>)&#123;</span><br><span class="line">    location.<span class="property">href</span> = url;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样的语句在其他浏览器没有问题，但在 IE6 中会失效</p>
<p>解决方法有几个：</p>
<ol>
<li>把 href 值换成 “#”，虽然解决了，但不完美，因为当初用 javascript:;（或者 javascript:void(0)）替换 #的初衷就是避免跳到页面顶端，现在不能重蹈覆辙</li>
<li>在 onclick 值里添加 “return false;”，也解决了，但是如果链接多的话，需要手工添加很多代码</li>
<li>在函数最后面添加 “window.event.returnValue &#x3D; false;”，完美解决</li>
</ol>
<h3 id="几何学"><a href="#几何学" class="headerlink" title="几何学"></a>几何学</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">dimension</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> w = <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">width</span>;<span class="comment">// 屏幕宽度（硬件相关）</span></span><br><span class="line">    <span class="keyword">var</span> h = <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">height</span>;<span class="comment">// 屏幕高度（硬件相关）</span></span><br><span class="line">    <span class="keyword">var</span> aw = <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">availWidth</span>;<span class="comment">// 屏幕有效宽度，相当于屏幕宽度（Safari 还要减去Mac的Dock宽度--居左右时）</span></span><br><span class="line">    <span class="keyword">var</span> ah = <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">availHeight</span>;<span class="comment">// 屏幕有效高度，相当于屏幕高度减去系统任务栏高度（Safari 还要减去Mac的Dock高度--居底时）</span></span><br><span class="line">    <span class="comment">// IE11、Firefox18+、其他现代浏览器、所有移动端浏览器都支持</span></span><br><span class="line">    <span class="keyword">var</span> dpr = <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span>;<span class="comment">// 设备像素比（device pixel ratio）</span></span><br><span class="line">    <span class="comment">// IE8- 中无下面属性</span></span><br><span class="line">    <span class="keyword">var</span> ow = <span class="variable language_">window</span>.<span class="property">outerWidth</span>;<span class="comment">// 浏览器窗口宽度(包括侧边栏和边框)</span></span><br><span class="line">    <span class="keyword">var</span> oh = <span class="variable language_">window</span>.<span class="property">outerHeight</span>;<span class="comment">// 浏览器窗口高度</span></span><br><span class="line">    <span class="keyword">var</span> iw = <span class="variable language_">window</span>.<span class="property">innerWidth</span>;<span class="comment">// 浏览器视口（viewport）宽度（包括滚动条）</span></span><br><span class="line">    <span class="keyword">var</span> ih = <span class="variable language_">window</span>.<span class="property">innerHeight</span>;<span class="comment">// 浏览器视口（viewport）高度</span></span><br><span class="line">    <span class="keyword">var</span> ipx = <span class="variable language_">window</span>.<span class="property">pageXOffset</span>;<span class="comment">// 页面的水平滚动距离</span></span><br><span class="line">    <span class="keyword">var</span> ipy = <span class="variable language_">window</span>.<span class="property">pageYOffset</span>;<span class="comment">// 页面的垂直滚动距离</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置浏览器窗口尺寸的方法，to 是绝对（调整到、移动到、滚动到），by 是相对（调整了、移动了、滚动了）</span></span><br><span class="line">    <span class="comment">// 注：某些浏览器有禁用它的选项；Firefox7+、Chrome 无效；Safari多标签页时无效</span></span><br><span class="line">    <span class="comment">// 注：resizeBy() 可以解决某些浏览器 CSS 渲染问题：当 CSS 变化而不能正确渲染时，可以用 resizeBy(0,1) 来重置页面尺寸，浏览器会重新解析 CSS</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">resizeTo</span>(<span class="number">800</span>, <span class="number">600</span>);</span><br><span class="line">    <span class="comment">// 移动浏览器位置</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">moveTo</span>(<span class="number">200</span>, <span class="number">100</span>);</span><br><span class="line">    <span class="comment">// 滚动页面位置</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">scrollTo</span>(<span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 前置和后置窗口，注：某些浏览器有禁用它的选项</span></span><br><span class="line">    <span class="comment">// blur() 让窗口失去焦点，用来后置窗口；focus() 则相反，让窗口获得焦点，用来前置窗口</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">blur</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="其他对象及方法"><a href="#其他对象及方法" class="headerlink" title="其他对象及方法"></a>其他对象及方法</h3><h4 id="navigator-对象"><a href="#navigator-对象" class="headerlink" title="navigator 对象"></a>navigator 对象</h4><p>它的一些属性表示用户浏览器的相关信息</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;浏览器信息：&quot;</span> + navigator.<span class="property">userAgent</span> + <span class="string">&quot; 浏览器平台：&quot;</span> + navigator.<span class="property">platform</span> + <span class="string">&quot; 浏览器名称：&quot;</span> + navigator.<span class="property">appName</span> + <span class="string">&quot; 浏览器版本：&quot;</span> + navigator.<span class="property">appVersion</span> + <span class="string">&quot; 浏览器插件：&quot;</span> + navigator.<span class="property">plugins</span>);</span><br></pre></td></tr></table></figure>

<h4 id="URL-的编码-解码方法"><a href="#URL-的编码-解码方法" class="headerlink" title="URL 的编码 &#x2F; 解码方法"></a>URL 的编码 &#x2F; 解码方法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="built_in">decodeURI</span>() <span class="comment">// 将已编码字符串中所有能识别的转义序列转换成原字符</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="built_in">decodeURIComponent</span>() <span class="comment">// 将已编码字符串中所有能识别的转义序列转换成原字符</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="built_in">encodeURI</span>() <span class="comment">// 把字符串作为 URI 进行编码。 URI 中具有特殊含义的字符（比如 ：;/?:@&amp;=+$,# 这些用于分隔 URI 组件的标点符号），encodeURI() 函数是不会进行转义的。</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="built_in">encodeURIComponent</span>() <span class="comment">// 把字符串作为 URI 组件进行编码。URI 中具有特殊含义的字符（：;/?:@&amp;=+$,#），都是由一个或多个十六进制的转义序列替换的。</span></span><br><span class="line"><span class="comment">// 请注意 encodeURIComponent() 函数 与 encodeURI() 函数的区别之处，前者假定它的参数是 URI 的一部分（比如协议、主机名、路径或查询字符串）。因此 encodeURIComponent() 函数将转义用于分隔 URI 各个部分的标点符号。</span></span><br></pre></td></tr></table></figure>
<h4 id="其他方法"><a href="#其他方法" class="headerlink" title="其他方法"></a>其他方法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">otherEvent</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 三个弹出对话框的方法</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">alert</span>(<span class="string">&quot;这是 alert&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> c = <span class="variable language_">window</span>.<span class="title function_">confirm</span>(<span class="string">&quot;你想试试吗？&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> p = <span class="variable language_">window</span>.<span class="title function_">prompt</span>(<span class="string">&quot;你输入一个名字吧&quot;</span>);</span><br><span class="line">    <span class="title function_">alert</span>(c);</span><br><span class="line">    <span class="title function_">alert</span>(p);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 延时运行以及移除它的方法</span></span><br><span class="line">    <span class="keyword">var</span> myT1 = <span class="built_in">setTimeout</span>(<span class="string">&quot;fn1()&quot;</span>, <span class="number">2000</span>);</span><br><span class="line">    <span class="keyword">var</span> myT2 = <span class="built_in">setTimeout</span>(fn1, <span class="number">2000</span>);</span><br><span class="line">    <span class="built_in">clearTimeout</span>(myT2);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 重复运行以及移除它的方法</span></span><br><span class="line">    <span class="keyword">var</span> myI = <span class="built_in">setInterval</span>(fn2, <span class="number">1000</span>);</span><br><span class="line">    <span class="built_in">clearInterval</span>(myI);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn1</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;延时运行&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> itest = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn2</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> (itest &lt; <span class="number">10</span>) &#123;</span><br><span class="line">        itest++;</span><br><span class="line">        <span class="title function_">alert</span>(itest);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Document-对象"><a href="#Document-对象" class="headerlink" title="Document 对象"></a>Document 对象</h2><p>Document 对象是 Window 对象中最重要的对象，它代表浏览器窗口包含的 HTML 文档，就是常说的 “页面”。它包含了 DOM 的所有 HTML 元素对应的对象及其属性、方法；但是还有一些不属于 DOM 的部分，用来描述文档的一些整体信息</p>
<h3 id="访问-Document-对象："><a href="#访问-Document-对象：" class="headerlink" title="访问 Document 对象："></a>访问 Document 对象：</h3><ul>
<li>对于正常的网页，直接使用 document。</li>
<li>对于 iframe 载入的网页，使用 iframe 节点的 contentDocument 属性。</li>
<li>对 Ajax 操作返回的文档，使用 XMLHttpRequest 对象的 responseXML 属性。</li>
<li>对于某个节点包含的文档，使用该节点的 ownerDocument 属性。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">docOther</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// activeElement 属性，返回当前文档中获得焦点的那个元素。用户通常可以使用 tab 键移动焦点，使用空格键激活焦点。</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// defaultView 属性，在浏览器中返回 Document 对象所在的 Window 对象，否则返回 null。</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">defaultView</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// documentURI 属性和 URL 属性都返回当前文档的网址。相当于 Window 对象的 location.href（注：IE 不支持前者）</span></span><br><span class="line">    <span class="comment">// documentURI 属性是所有文档都具备的，URL 属性则是 HTML 文档独有的</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;URI 属性为&quot;</span> + <span class="variable language_">document</span>.<span class="property">documentURI</span> + <span class="string">&quot; URL 属性为&quot;</span> + <span class="variable language_">document</span>.<span class="property">URL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// location 属性返回一个只读对象，提供了当前文档的 URL 信息。</span></span><br><span class="line">    <span class="comment">// document.location 属性与 window.location 属性等价，IE 曾经不允许对 document.location 赋值，建议优先使用 window.location。如果只是单纯地获取当前网址，建议使用 document.URL。</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// domain 属性，返回当前文档的域名。可以规避 JavaScript 同源策略中最严格的部分</span></span><br><span class="line">    <span class="comment">// 如：document.domain = &quot;google.com&quot;; 这样的话，help.google.com 的页面和 home.google.com 的页面就可以通信了</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// lastModified 属性，表示文档最后修改时间，注：为了避免浏览器返回的结果（字符串类型）差异，已转换为日期对象</span></span><br><span class="line">    <span class="keyword">var</span> lastUpdate = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="variable language_">document</span>.<span class="property">lastModified</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(lastUpdate);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// referrer 属性，当前页面访问来源</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">referrer</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// title 属性，返回当前文档的标题，该属性是可写的。</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">title</span> = <span class="string">&#x27;新标题&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// doctype 属性，表示文档类型，一般为 document.firstChild。</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">doctype</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// characterSet 属性，返回渲染当前文档的字符集，比如 UTF-8</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">characterSet</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// compatMode 属性，表示当前页面采用的渲染方式（BackCompat－非标准、CSS1Compat－标准）</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">compatMode</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// readyState 属性，返回当前文档的状态，共有三种可能的值，加载 HTML 代码阶段（尚未完成解析）是 “loading”，加载外部资源阶段是 “interactive”，全部加载完成是 “complete”。</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">readyState</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// designMode 属性，控制当前 document 是否可编辑。通常会打开 iframe 的 designMode 属性，将其变为一个所见即所得的编辑器。iframe_node.contentDocument.designMode = &quot;on&quot;;</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">designMode</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="document-write-方法"><a href="#document-write-方法" class="headerlink" title="document.write() 方法"></a>document.write() 方法</h3><ul>
<li>document.write() &#x2F;&#x2F; 曾经是 JavaScript 最重要的方法之一，但随着 W3C DOM 的推广，它已经过时了</li>
<li>document.writeln() &#x2F;&#x2F; 表示写入内容后添加一个换行符，相当于 document.write(内容 +”\n”)<ul>
<li>页面加载和解析的时候，它才能正确工作，另外写入的代码出现在它被调用的地方</li>
</ul>
</li>
<li>document.open() &#x2F;&#x2F; 该方法是移除当前文档内容，同时打开新文档；document.close() 是关闭 open() 打开的文档流，并显示缓存的输出内容<ul>
<li>open() 方法不是必需的，文档关闭（页面完全加载或使用了 close()）后，再次执行 write() 时，浏览器会隐式地调用 open() 移除当前文档内容，并写入新的内容</li>
<li>如果文档未关闭或没有使用 open()，write() 会直接添加内容到当前文档</li>
<li>Firefox 中，如果执行 write() 后没有使用 close()，会一直显示 “正在载入”；而且再次执行 write() 时会忽略 open()，直接添加内容到当前文档</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">debug</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> (oDebug) &#123;</span><br><span class="line">        oDebug.<span class="property">document</span>.<span class="title function_">open</span>();</span><br><span class="line">        oDebug.<span class="property">document</span>.<span class="title function_">write</span>(<span class="string">&quot;节点名称：&quot;</span> + <span class="variable language_">this</span>.<span class="property">nodeName</span> + <span class="string">&quot; 节点文本值：&quot;</span> + <span class="variable language_">this</span>.<span class="property">firstChild</span>.<span class="property">nodeValue</span> + <span class="string">&quot;&lt;br&gt;&quot;</span>);</span><br><span class="line">        oDebug.<span class="property">document</span>.<span class="title function_">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initDebug</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> obj = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;linkList&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!obj) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> link = obj.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; link.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        link[i].<span class="property">newId</span> = i;</span><br><span class="line">        link[i].<span class="property">onclick</span> = debug;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> oDebug = <span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&quot;&quot;</span>, <span class="string">&quot;newWin&quot;</span>, <span class="string">&quot;width=400,height=300&quot;</span>);</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="title function_">initDebug</span>();</span><br></pre></td></tr></table></figure>

<h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><p>HTTP 是一种无状态协议，所以 Web 服务器不会记住任何东西（注：TCP 是有状态协议，要求客户端和服务器交流时维持一个协议状态机，根据网络事件进行状态的转换）<br>而为了记住用户的一些访问状态和记录，Netscape 引入了 cookie，它是存储在用户电脑的小文本文件，与某个 Web 域的某个目录关联。当用户浏览器从目录中请求了页面，cookie 会随着 HTTP 请求自动发送。<br>cookie 传载的信息处理由服务器来决定，也可以用 JavaScript 来设置和检索 cookie</p>
<h3 id="cookie-信息"><a href="#cookie-信息" class="headerlink" title="cookie 信息"></a>cookie 信息</h3><p>cookie 的实际信息存储在名 &#x2F; 值对中，名字是唯一的，如果给相同名字设置了新值，旧值就被覆盖</p>
<ul>
<li>expires：设置 cookie 的过期时间，过期后就会消失，不会和站点关联。默认的过期时间是浏览器关闭时。过期时间按格林尼治标准时间（GMT）设置成如下格式：Thu, 09 Aug 2007 17:16:00 GMT；也叫世界协调时间（UTC）。删除一个 cookie 的简便方法，就是设置 expires 属性等于 0。</li>
<li>max-age：设置 cookie 的有效期，单位为秒</li>
<li>path：设置 cookie 的有效路径（绝对），默认是页面所在的目录，path&#x3D;&#x2F; 即设置为服务器的根目录</li>
<li>domain: 设置 cookie 的有效域（这个和 document 的 domain 作用类似）</li>
<li>secure：设置 cookie 只能在加密协议 HTTPS 下发送到服务器。该属性只是一个开关，不需要设定值。在 HTTPS 协议下设定的 cookie，该开关自动打开。</li>
<li>cookie 的内容由以上几个属性组成，设置语法如下（要求很精确，包括分隔参数的分号和空格以及过期时间的严格格式）：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&quot;ppkcookie=testcookie; expires=Sat, 2 Aug 2008 20:47:11 UTC; path=/; domain=google.com&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">cookie</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">readCookie</span>(<span class="string">&quot;ppkcookie&quot;</span>));</span><br></pre></td></tr></table></figure></li>
<li>cookie 限制：浏览器对 cookie 的数量和长度有限制，但是每个浏览器的规定是不一样的。<ul>
<li>IE6：每个域名 20 个 cookie。</li>
<li>IE7，IE8，Firefox：每个域名 50 个 cookie</li>
<li>Safari，Chrome：没有域名数量的限制。</li>
</ul>
</li>
<li>所有 cookie 的累加长度限制为 4KB。超过这个长度的 cookie，将被忽略，不会被设置。</li>
<li>由于 cookie 的限制，目前推荐使用 HTML5 里的新特性 Window.sessionStorage 和 Window.localStorage（WHATWG DOM Storage）</li>
</ul>
<h3 id="读写方法"><a href="#读写方法" class="headerlink" title="读写方法"></a>读写方法</h3><p>通用创建、读取和移除 cookie 函数 by <a target="_blank" rel="noopener" href="http://www.scottandrew.com/weblog/jsjunk#cookie">Scott Andrew</a>、<a target="_blank" rel="noopener" href="http://www.quirksmode.org/js/cookies.html">PPK</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createCookie</span>(<span class="params">name, value, days</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> (days) &#123;</span><br><span class="line">        <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        date.<span class="title function_">setTime</span>(date.<span class="title function_">getTime</span>() + (days * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>));</span><br><span class="line">        <span class="keyword">var</span> expires = <span class="string">&quot;; expires=&quot;</span> + date.<span class="title function_">toGMTString</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> expires = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">cookie</span> = name + <span class="string">&quot;=&quot;</span> + value + expires + <span class="string">&quot;; path=/&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">readCookie</span>(<span class="params">name</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> nameEQ = name + <span class="string">&quot;=&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> cookies = <span class="variable language_">document</span>.<span class="property">cookie</span>.<span class="title function_">split</span>(<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; cookies.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> coo = cookies[i];</span><br><span class="line">        <span class="keyword">while</span> (coo.<span class="title function_">charAt</span>(<span class="number">0</span>) == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">            coo = coo.<span class="title function_">substring</span>(<span class="number">1</span>, coo.<span class="property">length</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (coo.<span class="title function_">indexOf</span>(nameEQ) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> coo.<span class="title function_">substring</span>(nameEQ.<span class="property">length</span>, coo.<span class="property">length</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">removeCookie</span>(<span class="params">name</span>)&#123;</span><br><span class="line">    <span class="title function_">createCookie</span>(name, <span class="string">&quot;&quot;</span>, -<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Web-Storage"><a href="#Web-Storage" class="headerlink" title="Web Storage"></a>Web Storage</h2><p>Web 应用的发展，使得客户端存储使用得也越来越多。最简单而且兼容性最佳的方案是 Cookie，但是作为真正的客户端存储，Cookie 则存在很多致命伤。<br>针对以上情况，HTML5 中给出了更加理想的解决方案：<br>假如你需要存储复杂的数据则可以使用 Web Database，可以像客户端程序一样使用 SQL（不过 Web Database 标准当前正陷于僵局之中，而且目前已经实现的浏览器很有限）；<br>假如你需要存储的只是简单的 key&#x2F;value 对的数据则可以使用 WHAT-WG 制定的 Web Storage。</p>
<p>与 Cookie 相比，Web Storage 存在不少的优势，概括为以下几点：</p>
<ol>
<li>存储空间更大：IE8 下每个独立的存储空间为 10M，其他浏览器实现略有不同（Chrome 是 2.5MB，Firefox 和 Opera 是 5MB），但都比 Cookie 要大很多。</li>
<li>存储内容不会发送到服务器：当设置了 Cookie 后，Cookie 的内容会随着请求一并发送的服务器，这对于本地存储的数据是一种带宽浪费。而 Web Storage 中的数据则仅仅是存在本地，不会与服务器发生任何交互。</li>
<li>更多丰富易用的接口：Web Storage 提供了一套更为丰富的接口，使得数据操作更为简便。</li>
<li>独立的存储空间：每个域（包括子域）有独立的存储空间，各个存储空间是完全独立的，只有同域下的网页才能读取，因此不会造成数据混乱。</li>
</ol>
<p>Web Storage 是 HTML5 里新引入的浏览器端数据储存机制，共包括两个对象接口。<br>sessionStorage 保存的数据用于浏览器的一次会话，当会话结束（通常是该窗口关闭），数据被清空；<br>localStorage 保存的数据长期存在，下一次访问该网站的时候，网页可以直接读取以前保存的数据。<br>除了保存期限的长短不同，这两个对象的属性和方法完全一样。</p>
<p>通过检查 Window 对象是否包含 sessionStorage 和 localStorage 属性，可以确定浏览器是否支持这两个对象。<br>目前 IE8+、现代浏览器都支持这两个对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">checkStorageSupport</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// sessionStorage</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">sessionStorage</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// localStorage</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">localStorage</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="操作方法"><a href="#操作方法" class="headerlink" title="操作方法"></a>操作方法</h3><h4 id="存入-读取数据"><a href="#存入-读取数据" class="headerlink" title="存入 &#x2F; 读取数据"></a>存入 &#x2F; 读取数据</h4><p>sessionStorage 和 localStorage 保存的数据，都以 “键值对” 的形式存在。也就是说，每一项数据都有一个键名和对应的值。所有的数据都是以文本格式保存。<br>存入数据使用 setItem 方法。它接受两个参数，第一个是键名，第二个是保存的数据。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;value&#x27;</span>);</span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;value&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>读取数据使用 getItem 方法。它只有一个参数，就是键名。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> valueSession = <span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;key&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> valueLocal = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;key&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="清除数据"><a href="#清除数据" class="headerlink" title="清除数据"></a>清除数据</h4><p>removeItem 方法用于清除某个键名对应的数据。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">sessionStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;key&#x27;</span>);</span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;key&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>clear 方法用于清除所有保存的数据。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">sessionStorage</span>.<span class="title function_">clear</span>();</span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">clear</span>();</span><br></pre></td></tr></table></figure>

<h4 id="遍历操作"><a href="#遍历操作" class="headerlink" title="遍历操作"></a>遍历操作</h4><p>利用 length 属性和 key 方法，可以遍历所有的键。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">localStorage</span>.<span class="property">length</span>; i++)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">localStorage</span>.<span class="title function_">key</span>(i));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中的 key 方法，根据位置（从 0 开始）获得键值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">key</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h3 id="storage-事件"><a href="#storage-事件" class="headerlink" title="storage 事件"></a>storage 事件</h3><p>当储存的数据发生变化时，会触发 storage 事件。我们可以指定这个事件的回调函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;storage&#x27;</span>, onStorageChange);</span><br></pre></td></tr></table></figure>
<p>回调函数接受一个 event 对象作为参数。这个 event 对象的 key 属性，保存发生变化的键名。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">onStorageChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">key</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>除了 key 属性，event 对象的属性还有三个：</p>
<ul>
<li>oldValue：更新前的值。如果该键为新增加，则这个属性为 null。</li>
<li>newValue：更新后的值。如果该键被删除，则这个属性为 null。</li>
<li>url：原始触发 storage 事件的那个网页的网址。</li>
</ul>
<p>值得特别注意的是，该事件不在导致数据变化的当前页面触发。如果浏览器同时打开一个域名下面的多个页面，当其中的一个页面改变 sessionStorage 或 localStorage 的数据时，其他所有页面的 storage 事件会被触发，而原始页面并不触发 storage 事件。可以通过这种机制，实现多个窗口之间的通信。所有浏览器之中，只有 IE 浏览器除外，它会在所有页面触发 storage 事件。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/20/07.ecma04/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="可口可乐">
      <meta itemprop="description" content="Personal Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lizux">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/09/20/07.ecma04/" class="post-title-link" itemprop="url">JavaScript 读书心得之四：面向对象编程（OOP）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2015-09-20 00:00:00" itemprop="dateCreated datePublished" datetime="2015-09-20T00:00:00+08:00">2015-09-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-10-26 10:32:58" itemprop="dateModified" datetime="2023-10-26T10:32:58+08:00">2023-10-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>“面向对象编程”（Object Oriented Programming，缩写为 OOP）是目前主流的编程范式。它的核心思想是将真实世界中各种复杂的关系，抽象为一个个对象，然后由对象之间的分工与合作，完成对真实世界的模拟。</p>
<p>传统的计算机程序由一系列函数或指令组成，而面向对象编程的程序由一系列对象组成。每一个对象都是功能中心，具有明确分工，可以完成接受信息、处理数据、发出信息等任务。因此，面向对象编程具有灵活性、代码的可重用性、模块性等特点，容易维护和开发，非常适合多人合作的大型软件项目。</p>
<p>那么，“对象”（object）到底是什么？<br>我们从两个层次来理解。<br>（1）“对象” 是单个实物的抽象。<br>一本书、一辆汽车、一个人都可以是 “对象”，一个数据库、一张网页、一个与远程服务器的连接也可以是 “对象”。当实物被抽象成 “对象”，实物之间的关系就变成了 “对象” 之间的关系，从而就可以模拟现实情况，针对 “对象” 进行编程。<br>（2）“对象” 是一个容器，封装了 “属性”（property）和 “方法”（method）。<br>所谓 “属性”，就是对象的状态；所谓 “方法”，就是对象的行为（完成某种任务）。</p>
<p>虽然不同于传统的面向对象编程语言，但是 JavaScript 具有很强的面向对象编程能力。</p>
<h3 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h3><p>典型的面向对象编程语言（比如 C++ 和 Java），存在 “类”（class）这样一个概念。所谓 “类” 就是对象的模板，对象就是 “类” 的实例。JavaScript 语言没有 “类”，而改用构造函数（constructor）作为对象的模板。<br>所谓 “构造函数”，就是专门用来生成 “对象” 的函数。它提供模板，作为对象的基本结构。一个构造函数，可以生成多个对象，这些对象都有相同的结构。<br>构造函数是一个正常的函数，但是它的特征和用法与普通函数不一样。构造函数的最大特点就是，函数体内部使用了 this 关键字，代表了所要生成的对象实例。生成对象的时候，必需用 new 命令，调用函数。<br>为了保证构造函数必须与 new 命令一起使用，一个解决办法是，在构造函数内部使用严格模式，即第一行加上 “<code>use strict</code>”。由于在严格模式下，函数内部的 this 禁止指向全局对象，其值默认为 undefined，导致不加 new 调用会报错（JavaScript 不允许对 undefined 添加属性）。<br>构造函数的名称为首字母大写，以区别普通函数。</p>
<h3 id="this-关键字"><a href="#this-关键字" class="headerlink" title="this 关键字"></a>this 关键字</h3><p>this 就是指函数当前的运行环境。在 JavaScript 语言之中，所有函数都是在某个运行环境之中运行，this 就是这个环境。对于 JavaScipt 语言来说，一切皆对象，运行环境也是对象，所以可以理解成，所有函数总是在某个对象之中运行，this 就指向这个对象。<br>这本来并不会让用户糊涂，但是 JavaScript 支持运行环境动态切换，也就是说，this 的指向是动态的，没有办法事先确定到底指向哪个对象，这才是最让初学者感到困惑的地方。</p>
<h4 id="运行场景"><a href="#运行场景" class="headerlink" title="运行场景"></a>运行场景</h4><ol>
<li>在全局环境或函数调用（特别注意！）中使用 this，它指的就是全局对象 <code>window</code>。注：严格模式下，函数内部 this 禁止指向全局对象，其值默认为 undefined</li>
<li>构造函数中的 this，指的是实例对象。</li>
<li>对象的方法中的 this，指的是当前运行时所在的对象。注：对象的方法赋值给一个变量，变量执行时，是算函数调用的</li>
<li>在 Node.js 中，this 的指向又分成两种情况：全局环境中，this 指向全局对象 <code>global</code>；模块环境中，this 指向 <code>module.exports</code>。</li>
</ol>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ol>
<li><p>避免多层 this：由于 this 的指向是不确定的，所以切勿在函数中包含多层的 this。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">  <span class="attr">f1</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">    <span class="keyword">var</span> f2 = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> f2</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">o.<span class="title function_">f1</span>()() <span class="comment">// o</span></span><br><span class="line">         <span class="comment">// window</span></span><br></pre></td></tr></table></figure>
<p> 上面代码包含两层 this，结果运行后，第一层指向该对象 (属于对象的方法)，第二层指向全局对象（属于函数调用）</p>
<p> 一个解决方法是在第二层改用一个指向外层 this 的变量。</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> that = <span class="variable language_">this</span>;</span><br><span class="line">o.<span class="title function_">f1</span>()() <span class="comment">// o</span></span><br><span class="line">         <span class="comment">// o</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>数组的 map 和 foreach 方法，允许提供一个函数作为参数。这个函数内部不应该使用 this。</li>
<li>回调函数中的 this 往往会改变指向，最好避免使用。</li>
</ol>
<h4 id="固定-this"><a href="#固定-this" class="headerlink" title="固定 this"></a>固定 this</h4><p>this 的动态切换，固然为 JavaScript 创造了巨大的灵活性，但也使得编程变得困难和模糊。有时，需要把 this 固定下来，避免出现意想不到的情况。JavaScript 提供了 call、apply、bind 这三个方法，来切换 &#x2F; 固定 this 的指向。</p>
<ol>
<li>函数的 call() 方法，可以改变指定该函数内部 this 的指向，然后再调用该函数。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func.<span class="title function_">call</span>(thisValue, arg1, arg2, ...) <span class="comment">// 第一个参数就是 this 所要指向的那个对象，后面的参数则是函数调用时所需的参数。</span></span><br></pre></td></tr></table></figure>
 如前面例子，可以改造为<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">o.<span class="title function_">f1</span>().<span class="title function_">call</span>(o) <span class="comment">// o</span></span><br><span class="line">               <span class="comment">// o</span></span><br></pre></td></tr></table></figure></li>
<li>函数的 apply() 方法，可以改变指定该函数内部 this 的指向，然后再调用该函数。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func.<span class="title function_">apply</span>(thisValue, [arg1, arg2, ...])</span><br></pre></td></tr></table></figure>
 原函数的参数，在 call 方法中必须一个个添加，但是在 apply 方法中，必须以数组形式添加。<br> 利用这一点，可以做一些有趣的应用。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 快速取数组最大和最小值</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">max</span>.<span class="title function_">apply</span>(<span class="literal">null</span>, [<span class="number">10</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">9</span>]) <span class="comment">// 15</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">min</span>.<span class="title function_">apply</span>(<span class="literal">null</span>, [<span class="number">10</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">9</span>]) <span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 数组扁平化</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">concat</span>.<span class="title function_">apply</span>([],  [[<span class="number">0</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>]])</span><br><span class="line"><span class="comment">// 将数组的空元素变为 undefined</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">apply</span>(<span class="literal">null</span>, [<span class="string">&quot;a&quot;</span>,,<span class="string">&quot;b&quot;</span>])</span><br></pre></td></tr></table></figure>
 空元素与 undefined 的差别在于，数组的 foreach 方法会跳过空元素，但是不会跳过 undefined。</li>
<li>函数的 bind() 方法，用于将函数体内的 this 绑定到某个对象，然后返回一个新函数。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func.<span class="title function_">bind</span>(thisValue, arg1, arg2,...)</span><br></pre></td></tr></table></figure>
 bind() 比 call() 方法和 apply() 方法更进一步的是，除了绑定 this 以外，还可以绑定原函数的参数；另外可以不立即执行。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> add = <span class="keyword">function</span> (<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x * <span class="variable language_">this</span>.<span class="property">m</span> + y * <span class="variable language_">this</span>.<span class="property">n</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">m</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">n</span>: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> newAdd = add.<span class="title function_">call</span>(obj, <span class="number">5</span>, <span class="number">6</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newAdd);</span><br><span class="line"><span class="keyword">var</span> newAdd2 = add.<span class="title function_">bind</span>(obj, <span class="number">5</span>);</span><br><span class="line"><span class="title function_">newAdd2</span>(<span class="number">6</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：</p>
</blockquote>
</li>
<li>每一次返回一个新函数。这样事件绑定 bind 方法生成的一个匿名函数，会导致无法取消绑定，必须提前赋值到变量。</li>
<li>绑定函数运行时所在的对象，还可以使用 jQuery 的 $.proxy 方法，它与 bind 方法的作用基本相同。</li>
</ol>
<h2 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h2><h3 id="prototype-对象"><a href="#prototype-对象" class="headerlink" title="prototype 对象"></a>prototype 对象</h3><p>JavaScript 通过构造函数生成新对象，因此构造函数可以视为对象的模板。实例对象的属性和方法，可以定义在构造函数内部。<br>但是，这样做是对系统资源的浪费，因为同一个构造函数的对象实例之间，无法共享属性。</p>
<p>在 JavaScript 语言中，每一个对象都有一个对应的原型对象，被称为 prototype 对象。定义在原型对象上的所有属性和方法，都能被派生对象继承。这就是 JavaScript 继承机制的基本设计。<br>除了这种方法，JavaScript 还提供了另一种定义实例对象的方法。我们知道，构造函数是一个函数，同时也是一个对象，也有自己的属性和方法，其中有一个 prototype 属性指向另一个对象，一般称为 prototype 对象。该对象非常特别，只要定义在它上面的属性和方法，能被所有实例对象共享。<br>更特别的是，只要修改 prototype 对象，变动就立刻会体现在实例对象。这是因为，当实例对象自身没有某个属性或方法的时候，它会到构造函数的 prototype 对象去寻找该属性或方法。这就是 prototype 对象的特殊之处。<br>如果实例对象自身就有某个属性或方法，它就不会再去 prototype 对象寻找这个属性或方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Animal</span> (name) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">color</span> = <span class="string">&quot;white&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> cat = <span class="keyword">new</span> <span class="title class_">Animal</span>(<span class="string">&#x27;mm&#x27;</span>);</span><br><span class="line">cat.<span class="property">color</span> = <span class="string">&#x27;black&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(cat.<span class="property">color</span>);</span><br></pre></td></tr></table></figure>
<p>总而言之，prototype 对象的作用，就是定义所有实例对象共享的属性和方法，所以它也被称为实例对象的原型，而实例对象可以视作从 prototype 对象衍生出来的。</p>
<h3 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h3><p>由于 JavaScript 的所有对象都有构造函数，而所有构造函数都有 prototype 属性（其实是所有函数都有 prototype 属性），所以所有对象都有自己的 prototype 原型对象。<br>因此，一个对象的属性和方法，有可能是定义它自身上面，也有可能定义在它的原型对象上面。由于原型本身也是对象，又有自己的原型，所以形成了一条原型链（prototype chain）。以此类推，追根溯源，最源头的对象都是从 Object 构造函数生成（使用 new Object() 命令），所以如果一层层地上溯，所有对象的原型最终都可以上溯到 Object.prototype。那么，Object.prototype 有没有原型呢？回答可以是有，也可以是没有，因为 Object.prototype 的原型是没有任何属性和方法的 null。<br>“原型链” 的作用在于，当读取对象的某个属性时，JavaScript 引擎先寻找对象自身的属性，如果找不到，就到它的原型去找，如果还是找不到，就到原型的原型去找。以此类推，如果直到最顶层的 Object.prototype 还是找不到，则返回 undefined。<br>如果让某个函数的 prototype 属性指向一个数组，就意味着该函数可以用作数组的构造函数，因为它生成的实例对象都可以通过 prototype 属性调用数组方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">MyArray</span> ()&#123;&#125;</span><br><span class="line"><span class="title class_">MyArray</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line"><span class="keyword">var</span> mine = <span class="keyword">new</span> <span class="title class_">MyArray</span>();</span><br><span class="line">mine.<span class="title function_">push</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">mine.<span class="property">length</span> <span class="comment">// 3</span></span><br><span class="line">mine <span class="keyword">instanceof</span> <span class="title class_">Array</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>从上可以看到 instanceof 运算符的实质，它依次与实例对象的所有原型对象的 constructor 属性进行比较，只要有一个符合就返回 true，否则返回 false。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mine <span class="keyword">instanceof</span> <span class="title class_">Array</span></span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line">(<span class="title class_">Array</span> === <span class="title class_">MyArray</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span>) || (<span class="title class_">Array</span> === <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span>) || (<span class="title class_">Array</span> === <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span>)</span><br></pre></td></tr></table></figure>

<h3 id="constructor-属性"><a href="#constructor-属性" class="headerlink" title="constructor 属性"></a>constructor 属性</h3><p>prototype 对象有一个 constructor 属性，默认指向 prototype 对象所在的构造函数。由于 constructor 属性定义在 prototype 对象上面，意味着可以被所有实例对象继承。<br>constructor 属性的作用是分辨 prototype 对象到底定义在哪个构造函数上面。</p>
<h3 id="其他方法"><a href="#其他方法" class="headerlink" title="其他方法"></a>其他方法</h3><ul>
<li>Object.getPrototypeOf() &#x2F;&#x2F; 返回一个对象的原型。<br>  辨析：<br>  Object.getPrototypeOf(对象) &#x3D;&#x3D;&#x3D; 原型（构造函数.prototype）<br>  对象 instanceof 构造函数<br>  原型（构造函数.prototype）.isPrototypeOf(对象)<br>  对象.constructor &#x3D;&#x3D;&#x3D; 构造函数</li>
<li>Object.create() &#x2F;&#x2F; 用于生成新的对象，可以替代 new 命令。它接受一个原型对象作为参数，返回一个新对象，后者完全继承前者的属性。<br>  如果想要生成一个不继承任何属性（比如 toString 和 valueOf 方法）的对象，可以将 Object.create 的参数设为 null。<br>  由于不使用构造函数，所以不能用 instanceof 运算符判断，对象是哪一个构造函数的实例。这时，可以使用 <code>Object.prototype.isPrototypeOf()</code> 方法，判断原型是哪一个对象。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为 Object 增加 create 方法（优先使用原生方法）</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="title class_">Object</span>.<span class="property">create</span> !==<span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="property">create</span> = <span class="keyword">function</span>(<span class="params">o</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> F = <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;;</span><br><span class="line">        F.<span class="property"><span class="keyword">prototype</span></span> = o;</span><br><span class="line">        returen <span class="keyword">new</span> <span class="title function_">F</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Dog</span>(<span class="params">name</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> spot = <span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&quot;Spot&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">isPrototypeOf</span>(spot));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(spot.<span class="property">constructor</span> === <span class="title class_">Dog</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(spot) === <span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line">spot <span class="keyword">instanceof</span> <span class="title class_">Dog</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><p>JavaScript 通过构造函数生成实例对象，所以要实现对象的继承，就是要实现构造函数的继承。</p>
<h3 id="构造函数的继承"><a href="#构造函数的继承" class="headerlink" title="构造函数的继承"></a>构造函数的继承</h3><p>构造函数的继承分成两部分，一部分是子类调用父类构造方法，另一部分是子类的原型指向父类的原型。</p>
<h3 id="proto-属性"><a href="#proto-属性" class="headerlink" title="__proto__属性"></a>__proto__属性</h3><p>IE11+、现代浏览器都在 Object 对象的实例上，部署了一个非标准的 __proto__属性（曾经写入 ES6 草案），指向该对象的原型对象，即构造函数的 prototype 属性。<br>    <code> 对象.__proto__ === 构造函数. prototype</code></p>
<h3 id="属性的继承：属性分成两种。一种是对象的自有属性，另一种是继承自原型的继承属性。"><a href="#属性的继承：属性分成两种。一种是对象的自有属性，另一种是继承自原型的继承属性。" class="headerlink" title="属性的继承：属性分成两种。一种是对象的自有属性，另一种是继承自原型的继承属性。"></a>属性的继承：属性分成两种。一种是对象的自有属性，另一种是继承自原型的继承属性。</h3><p>对象的自有属性，可以用 <code>Object.getOwnPropertyNames()</code> 方法获得。只获取那些可以枚举的自有属性，使用 <code>Object.keys()</code> 方法。判断对象是否具有某个自有属性，使用 <code>hasOwnProperty()</code> 方法。<br>用 <code>Object.create()</code> 方法创造的对象，会继承所有原型对象的属性。<br>判断一个对象是否具有某个属性（不管是自有的还是继承的），使用 in 运算符。<br>获得对象的所有可枚举属性（不管是自有的还是继承的），可以使用 for…in 循环。</p>
<p>如果要复制一个对象，需要做到下面两件事情：</p>
<ul>
<li>确保复制后的对象，与原对象具有同样的 prototype 原型对象。</li>
<li>确保复制后的对象，与原对象具有同样的属性。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">deepClone</span>(<span class="params">target</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> clone = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(target));</span><br><span class="line">    <span class="title function_">copyOwnPropertiesFrom</span>(clone, target);</span><br><span class="line">    <span class="keyword">return</span> clone;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">copyOwnPropertiesFrom</span>(<span class="params">result, source</span>) &#123;</span><br><span class="line">    <span class="title class_">Object</span></span><br><span class="line">        .<span class="title function_">getOwnPropertyNames</span>(source)</span><br><span class="line">        .<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">propKey</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> desc = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(source, propKey);</span><br><span class="line">            <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(result, propKey, desc);</span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="模块化编程"><a href="#模块化编程" class="headerlink" title="模块化编程"></a>模块化编程</h2><ol>
<li>使用构造函数封装私有变量<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">StringBuilder</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> buffer = [];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">add</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">        buffer.<span class="title function_">push</span>(str);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">toString</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> buffer.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
 这种方法将私有变量封装在构造函数中，违反了构造函数与实例对象相分离的原则。并且，非常耗费内存。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">StringBuilder</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_buffer</span> = [];</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">StringBuilder</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">    <span class="attr">constructor</span>: <span class="title class_">StringBuilder</span>,</span><br><span class="line">    <span class="attr">add</span>: <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_buffer</span>.<span class="title function_">push</span>(str);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">toString</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_buffer</span>.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
 这种方法将私有变量放入实例对象中，好处是看上去更自然，但是它的私有变量可以从外部读写，不是很安全。</li>
<li>IIFE 封装私有变量<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="comment">// open IIFE</span></span><br><span class="line">    <span class="comment">// public</span></span><br><span class="line">    <span class="keyword">var</span> self = &#123;</span><br><span class="line">        <span class="attr">publicMethod</span>: <span class="keyword">function</span>(<span class="params">...</span>) &#123;</span><br><span class="line">            privateData = ...;</span><br><span class="line">            <span class="title function_">privateFunction</span>(...);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">publicData</span>: ...</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private</span></span><br><span class="line">    <span class="keyword">var</span> privateData = ...;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">privateFunction</span>(<span class="params">...</span>) &#123;</span><br><span class="line">        privateData = ...;</span><br><span class="line">        self.<span class="property">publicData</span> = ...;</span><br><span class="line">        self.<span class="title function_">publicMethod</span>(...);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> self;</span><br><span class="line">&#125;(); <span class="comment">// close IIFE</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="函数式编程"><a href="#函数式编程" class="headerlink" title="函数式编程"></a>函数式编程</h2><p>一种 “编程范式”（programming paradigm），也就是如何编写程序的方法论。它属于 “结构化编程” 的一种，主要思想是把运算过程尽量写成一系列嵌套的函数调用。<br>对于表达式：<br>    <code>(1 + 2) * 3 - 4</code><br>传统的过程式编程：<br>    <code>var a = 1 + 2;     var b = a * 3;     var c = b - 4;</code><br>函数式编程要求使用函数：<br>    <code>var result = subtract(multiply(add(1, 2), 3), 4);</code></p>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ol>
<li>函数是 “第一等公民”<br>指的是函数与其他数据类型一样，处于平等地位，可以赋值给其他变量，也可以作为参数，传入另一个函数，或者作为别的函数的返回值。</li>
<li>只用 “表达式”，不用 “语句”<br>“表达式”（expression）是一个单纯的运算过程，总是有返回值；“语句”（statement）是执行某种操作，没有返回值。函数式编程要求，只使用表达式，不使用语句。也就是说，每一步都是单纯的运算，而且都有返回值。<br>原因是函数式编程的开发动机，一开始就是为了处理运算（computation），不考虑系统的读写（I&#x2F;O）。“语句” 属于对系统的读写操作，所以就被排斥在外。</li>
<li>没有 “副作用”<br>所谓 “副作用”（side effect），指的是函数内部与外部互动（最典型的情况，就是修改全局变量的值），产生运算以外的其他结果。<br>函数式编程强调没有 “副作用”，意味着函数要保持独立，所有功能就是返回一个新的值，没有其他行为，尤其是不得修改外部变量的值。</li>
<li>不修改状态<br>上一点已经提到，函数式编程只是返回新的值，不修改系统变量。因此，不修改变量，也是它的一个重要特点。<br>在其他类型的语言中，变量往往用来保存 “状态”（state）。不修改变量，意味着状态不能保存在变量中。函数式编程使用参数保存状态，最好的例子就是递归。</li>
<li>引用透明<br>引用透明（Referential transparency），指的是函数的运行不依赖于外部变量或 “状态”，只依赖于输入的参数，任何时候只要参数相同，引用函数所得到的返回值总是相同的。<br>有了上面的第三点和第四点，这点是很显然的。其他类型的语言，函数的返回值往往与系统状态有关，不同的状态之下，返回值是不一样的。这就叫 “引用不透明”，很不利于观察和理解程序的行为。</li>
</ol>
<h3 id="意义"><a href="#意义" class="headerlink" title="意义"></a>意义</h3><ol>
<li>代码简洁，易于敏捷开发</li>
<li>接近自然语言，易于理解</li>
<li>更方便的代码管理，易于模块化</li>
<li>不锁线程，易于 “并发编程”</li>
<li>没有副作用，易于代码的热升级</li>
</ol>
<h3 id="应用要点"><a href="#应用要点" class="headerlink" title="应用要点"></a>应用要点</h3><p>递归、闭包、柯里化 Currying、模块化、惰性求值</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/19/06.ecma03/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="可口可乐">
      <meta itemprop="description" content="Personal Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lizux">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/09/19/06.ecma03/" class="post-title-link" itemprop="url">JavaScript 读书心得之三：核心（二）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2015-09-19 00:00:00" itemprop="dateCreated datePublished" datetime="2015-09-19T00:00:00+08:00">2015-09-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-10-26 10:32:58" itemprop="dateModified" datetime="2023-10-26T10:32:58+08:00">2023-10-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h2><p>对象是一种数据的无序集合，由键值对（key-value）组成。每个键值对包括键名与键值，之间用冒号分隔；多个键值对之间用逗号分隔。最后一个属性后面的逗号，ES3 不允许加，ES5 允许加。<br>    键名，又称之为属性（Property），可以不加引号，如果键名不符合标识符的条件，而且不是正整数，则必须加上引号。<br>    键值，可以存储任何数据类型，如果为函数，就称之为方法。</p>
<blockquote>
<p>注：对于 JSON 字符串，规范要求键名必须加双引号，键值中的字符串必须用双引号</p>
</blockquote>
<ul>
<li>读取对象的属性，有两种方法，一种是使用点运算符 o.p，还有一种是使用方括号运算符 o[‘p’]。<blockquote>
<p>注：[] 比 . 更加灵活，点运算符只能使用字面量属性，而方括号运算符可以使用变量属性。</p>
</blockquote>
  检查变量是否声明：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable language_">window</span>.<span class="property">a</span>) &#123;...&#125; <span class="comment">// 有漏洞，如果 a 属性是一个空字符串（或其他对应的布尔值为 false 的情况），则无法起到检查变量是否声明的作用。</span></span><br></pre></td></tr></table></figure>

<pre><code>正确的写法是使用 in 运算符：
</code></pre>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;a&#x27;</span> <span class="keyword">in</span> <span class="variable language_">window</span>) &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>写入同上。JavaScript 允许属性的 “后绑定”，也就是说，你可以在任意时刻新增属性，没必要在定义对象的时候，就定义好。</li>
<li>查看一个对象的自有属性，可以使用 Object.keys() 方法。</li>
<li>删除对象的属性使用 delete 运算符，它可以删除对象的自有属性，不能删除继承属性<br>  如果删除一个不存在的属性，delete 不报错，而且返回 true。<br>  如果 delete 命令会返回 false，那就是该属性存在，且不得删除。<br>  如果设置属性为 undefined 或者 null 并不能真正的删除属性，而仅仅是移除了属性和值的关联。</li>
<li>对象的引用：如果不同的变量名指向同一个对象，那么它们都是这个对象的引用，也就是说指向同一个内存地址。修改其中一个变量，会影响到其他所有变量。<br>  但是，这种引用只局限于对象，对于基础类型的数据则是传值引用，也就是说，都是值的复制。</li>
<li>in 运算符：用于检查对象是否包含某个属性（注意，检查的是键名，不是键值），如果包含就返回 true。<br>  in 运算符对继承属性也有效。<br>  in 运算符只能用来检验可枚举（enumerable）的属性。</li>
<li>for…in 循环：用来遍历一个对象的全部属性。<br>  注意，for…in 循环遍历的是对象所有可枚举的属性，其中不仅包括对象的自有属性，还包括继承属性。<br>  如果只想遍历对象的自有属性，可以使用 hasOwnProperty() 方法，在循环内部做一个判断然后过滤掉。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> person) &#123;</span><br><span class="line">    <span class="keyword">if</span> (person.<span class="title function_">hasOwnProperty</span>(key)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Object-类"><a href="#Object-类" class="headerlink" title="Object 类"></a>Object 类</h3><p>是 JavaScript 中的基础类，所有的其他类都继承自该类，所以 Object 类的属性、方法都会出现在其他类中。</p>
<p>给 Object 对象部署方法有两种：</p>
<ol>
<li>部署在 Object 对象自身。这就是 “构造函数的方法”，调用 Object.方法() 来使用。</li>
<li>部署在 Object.prototype 对象。所有构造函数都有一个 prototype 属性，指向一个原型对象。凡是定义在 Object.prototype 对象上面的属性和方法，将被所有实例对象共享。这就是 “实例对象的方法”，调用 对象.方法() 来使用。</li>
</ol>
<h3 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>() <span class="comment">// 返回一个由指定对象的所有可枚举自有属性名组成的数组。</span></span><br><span class="line"><span class="comment">// 用 for...in 循环也能实现同样效果（还会获取到原型链上的可枚举属性，不过可以使用 hasOwnProperty() 方法过滤掉）</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">getOwnPropertyNames</span>() <span class="comment">// 返回一个由指定对象的所有自有属性名组成的数组，包括不可枚举属性。</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">observe</span>() <span class="comment">// 用于观察对象属性的变化。注：仅 Chrome 浏览器的最新版本才支持</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span> <span class="comment">// 该属性表示原型对象，但是谨记对象实例自身并没有该属性，而只有其构造函数才有此属性。构造函数的 prototype 属性，表示对象的原型对象（而原型对象的 constructor 属性就是构造函数本身），通过该属性（即原型方法）可以向对象实例添加属性和方法</span></span><br><span class="line"><span class="comment">// 对任何对象来讲，通过追溯原型链都可以追溯到 Object 类，而对于 Object 类而言，其构造函数其实还是空的对象 &#123;&#125;，空的对象的 constructor 属性所指的构造函数还会是 Object</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> <span class="comment">// 该属性表示创建对象的构造函数，对于 Object 类而言，该引用指向本地 Object() 方法</span></span><br><span class="line"><span class="comment">// null 和 undefined 没有 constructor，Number 和 String 数据类型的字面量，也没有 constructor，但 Number 和 String 数据类型的变量有 constructor（在寻找 constructor 属性时，会自动转换成 Number 或 String 对象）</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">hasOwnProperty</span>(property) <span class="comment">// 检测对象是否拥有某个自有属性。</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">isPrototypeOf</span>(object) <span class="comment">// 检测对象是否是另一对象的原型。只要该对象处在另一对象原型链上，都返回 true。</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">propertyIsEnumerable</span>(property) <span class="comment">// 检测某个属性是否可枚举。</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">valueOf</span>() <span class="comment">// 返回对象对应的值，默认情况下就是对象本身。valueOf 方法的主要用途是，JavaScript 自动类型转换时会默认调用该方法。</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">toString</span>() <span class="comment">// 返回对象的字符串形式。使用 call() 方法，可以在任意值上（除了 null 和 undefined）调用该方法，从而帮助我们判断这个值的类型。</span></span><br><span class="line"><span class="keyword">var</span> type = <span class="keyword">function</span> (<span class="params">o</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(o).<span class="title function_">match</span>(<span class="regexp">/\[object (.*)\]/</span>)[<span class="number">1</span>].<span class="title function_">toLowerCase</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">instanceof</span> 运算符 <span class="comment">// 可以检测某个对象是不是某个构造函数（对象）的实例，注意其左右操作数都必须为对象（所以不适合检测基础变量的类型）</span></span><br></pre></td></tr></table></figure>
<h4 id="方法示例"><a href="#方法示例" class="headerlink" title="方法示例"></a>方法示例</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">testObj</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> testObj = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">    testObj.<span class="property">a</span> = <span class="number">2</span>;</span><br><span class="line">    testObj.<span class="property">b</span> = <span class="string">&quot;3&quot;</span>;</span><br><span class="line">    testObj.<span class="property">c</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span> + <span class="variable language_">this</span>.<span class="property">b</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(testObj.<span class="property">constructor</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(testObj.<span class="title function_">hasOwnProperty</span>(<span class="string">&quot;c&quot;</span>));</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">getOwnPropertyNames</span>(testObj));</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">keys</span>(testObj));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> testObj) &#123;</span><br><span class="line">        <span class="keyword">if</span> (testObj.<span class="title function_">hasOwnProperty</span>(prop)) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(prop + <span class="string">&quot; = &quot;</span> + testObj[prop]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> time = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(time.<span class="title function_">valueOf</span>());</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(time.<span class="title function_">toString</span>());</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">getOwnPropertyNames</span>(<span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>));</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span> <span class="keyword">instanceof</span> <span class="title class_">Number</span>); <span class="comment">// false</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(&#123;&#125; <span class="keyword">instanceof</span> <span class="title class_">Object</span>); <span class="comment">// true</span></span><br><span class="line">    <span class="keyword">var</span> string = <span class="string">&quot;0123456789&quot;</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> string);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(string <span class="keyword">instanceof</span> <span class="title class_">String</span>);<span class="comment">// false</span></span><br><span class="line">    <span class="keyword">var</span> show = <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;show&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> show);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(show <span class="keyword">instanceof</span> <span class="title class_">String</span>);<span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//console.log(void testObj);</span></span><br><span class="line">    <span class="keyword">delete</span> testObj.<span class="property">b</span>;</span><br><span class="line">    <span class="comment">//console.log(testObj.b);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Dog</span>(<span class="params">name</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">respondTo</span> = <span class="keyword">function</span>(<span class="params">name</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">name</span> == name) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Woof&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> spot = <span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&quot;Spot&quot;</span>);</span><br><span class="line">    <span class="comment">// 构造函数 Dog 的 prototype 属性是 spot 的原型对象</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">isPrototypeOf</span>(spot));</span><br><span class="line">    <span class="comment">// 上面说过，原型对象 Dog.prototype 的 constructor 属性就是构造函数其本身</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> === <span class="title class_">Dog</span>);</span><br><span class="line">    <span class="comment">// 而 spot 从 Dog.prototype 那里继承了 constructor 属性</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(spot.<span class="property">constructor</span> === <span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span>);</span><br><span class="line">    <span class="comment">// 所以</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(spot.<span class="property">constructor</span> === <span class="title class_">Dog</span>);</span><br><span class="line">    <span class="comment">// 但是 spot 本身并不拥有 constructor 属性</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(spot.<span class="title function_">hasOwnProperty</span>(<span class="string">&quot;constructor&quot;</span>));</span><br><span class="line">    <span class="comment">// 而 Dog.prototype 是拥有 constructor 属性的</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">hasOwnProperty</span>(<span class="string">&quot;constructor&quot;</span>));</span><br><span class="line">    <span class="comment">// 查看原型链的追溯</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">isPrototypeOf</span>(spot) + <span class="string">&quot;.\n&quot;</span> + spot.<span class="property">constructor</span> + <span class="string">&quot;.\n&quot;</span> + <span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">isPrototypeOf</span>(<span class="title class_">Dog</span>) + <span class="string">&quot;.&quot;</span> + <span class="title class_">Dog</span>.<span class="property">constructor</span> + <span class="string">&quot;.&quot;</span> + <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">isPrototypeOf</span>(<span class="title class_">Function</span>) + <span class="string">&quot;.&quot;</span> + <span class="title class_">Function</span>.<span class="property">constructor</span> + <span class="string">&quot;.&quot;</span> + <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="创建对象的方法"><a href="#创建对象的方法" class="headerlink" title="创建对象的方法"></a>创建对象的方法</h3><ol start="0">
<li>使用工厂方法（Object 构造函数）创建对象<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> testObj = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">testObj.<span class="property">a</span> = <span class="number">2</span>;</span><br><span class="line">testObj.<span class="property">b</span> = <span class="string">&quot;3&quot;</span>;</span><br><span class="line">testObj.<span class="property">c</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span> + <span class="variable language_">this</span>.<span class="property">b</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
 Object 作为构造函数使用时，可以接受一个参数。如果该参数是一个对象，则直接返回这个对象；如果是一个原始类型的值，则返回该值对应的包装对象。</li>
<li>使用对象字面量，相当于方法①的快捷表示法<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> testObj = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">b</span>: <span class="string">&quot;3&quot;</span>,</span><br><span class="line">    <span class="attr">c</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span> + <span class="variable language_">this</span>.<span class="property">b</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>使用构造函数创建类，然后实例化对象<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">CreateObj</span>(<span class="params">x, y</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">a</span> = x;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">b</span> = y;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">c</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span> + <span class="variable language_">this</span>.<span class="property">b</span>)</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> testObj = <span class="keyword">new</span> <span class="title class_">CreateObj</span>(<span class="number">2</span>, <span class="string">&quot;3&quot;</span>);</span><br></pre></td></tr></table></figure>
缺点：上面的三种方法，创建对象时，构造函数每一次被调用，都会产生一个函数对象集合，多个对象构造会产生大量的独立函数对象集合。这样初始化过程将会变慢，更多的内存资源被浪费</li>
<li>使用构造函数 + 原型混合方式，在构造函数内创建对象的属性，用原型方法创建对象的方法，因为原型对象只会随着函数对象的创建被创建初始化一次。可以避免上面几种方法的缺点<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">CreateObj</span>(<span class="params">x, y</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">a</span> = x;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">b</span> = y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">CreateObj</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">c</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span> + <span class="variable language_">this</span>.<span class="property">b</span>)</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> testObj = <span class="keyword">new</span> <span class="title class_">CreateObj</span>(<span class="number">2</span>,<span class="string">&quot;3&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="对象检测"><a href="#对象检测" class="headerlink" title="对象检测"></a>对象检测</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">objCheck</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 使用 DOM 方法要事先检测</span></span><br><span class="line">    <span class="keyword">var</span> <span class="variable constant_">W3CDOM</span> = <span class="variable language_">document</span>.<span class="property">getElementsByTagName</span> &amp;&amp; <span class="variable language_">document</span>.<span class="property">createElement</span>;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable constant_">W3CDOM</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;浏览器不支持 DOM 标准&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 待操作的对象要事先检测</span></span><br><span class="line">    <span class="keyword">var</span> obj = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;obj&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!obj) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;当前文档不存在这个对象&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><p>数组（Array）是按次序排列的一组值，单个值称为元素，它们的位置都有编号（从 0 开始）。整个数组用方括号表示。</p>
<p>数组只是一种特殊的对象，所以 typeof 运算符返回数组的类型是 object。数组的特殊性体现在，它的键名默认是按次序排列的整数（0，1，2…）。此外，对象以字符串来识别键名，非字符串的键名会被转为字符串，所以使用数值或字符串作为键名，都能读取数组的成员。</p>
<p>数组是一种动态的数据结构，可以随时增减数组的成员。<br>数组的 length 属性是可写的。其数字键不需要连续，length 属性的值总是比最大的那个整数键大 1。</p>
<blockquote>
<p>如果人为设置 length 属性小于当前成员个数，成员自动减少；大于当前成员个数，不会产生影响（见注）。<br>    将数组清空的一个有效方法，就是将 length 属性设为 0。<br>    注：在 Firebug 中查看数组时，会发现以 undefined 自动填充空位，但是这个结果并不准确；如果你在 Chrome 的控制台查看结果，会发现数组还是原来的成员。因为在 JavaScript 中 undefined 是一个变量，注意不是关键字，因此上面两个结果的意义是完全不相同的。<br>    为了验证，我们来执行下面代码，看序号 5 的成员是否存在于 foo 中。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span> <span class="keyword">in</span> foo; <span class="comment">// 不管在 Firebug 或者 Chrome 都返回 false</span></span><br><span class="line">foo[<span class="number">5</span>] = <span class="literal">undefined</span>;</span><br><span class="line"><span class="number">5</span> <span class="keyword">in</span> foo; <span class="comment">// 不管在 Firebug 或者 Chrome 都返回 true</span></span><br></pre></td></tr></table></figure>

<p>可以使用 Array.isArray() 方法来检测是否为数组 (ES5 标准，IE9+ 支持)</p>
<h3 id="创建数组的方法"><a href="#创建数组的方法" class="headerlink" title="创建数组的方法"></a>创建数组的方法</h3><ol start="0">
<li>使用数组字面量（推荐）<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [];</span><br></pre></td></tr></table></figure></li>
<li>使用 Array 构造函数<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> lennon = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line">lennon[<span class="string">&quot;name&quot;</span>] = <span class="string">&quot;John&quot;</span>;</span><br><span class="line">lennon[<span class="string">&quot;year&quot;</span>] = <span class="number">1940</span>;</span><br><span class="line">lennon[<span class="string">&quot;living&quot;</span>] = <span class="literal">false</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(lennon.<span class="property">length</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>上面是一个关联数组，本质还是一个对象。下标 [“*”] 是对象的属性，lennon[“name”] &#x3D; “John” 相当于 lennon.name &#x3D; “John”，而数组本身并没有元素，所以 lennon 的 length 为 0</p>
</blockquote>
</li>
</ol>
<p>for…in 循环，可以用来遍历（枚举）对象的属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> lennon) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i + <span class="string">&quot;:&quot;</span> + lennon[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>多维数组</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> beatles = [];</span><br><span class="line">beatles[<span class="number">0</span>] = lennon;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(beatles[<span class="number">0</span>][<span class="string">&quot;name&quot;</span>]);</span><br></pre></td></tr></table></figure>

<h3 id="常用方法-1"><a href="#常用方法-1" class="headerlink" title="常用方法"></a>常用方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">push</span>(element1, ...) <span class="comment">// 把元素添加进数组的尾部，并返回添加后的数组的长度</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">unshift</span>(element1, ...) <span class="comment">// 把元素添加进数组的头部，并返回添加后的数组的长度</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">pop</span>() <span class="comment">// 删除数组的最后一个元素，并返回该元素</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">shift</span>() <span class="comment">// 删除数组的第一个元素，并返回该元素</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">concat</span>(array1, array2, ...) <span class="comment">// 将新数组添加到原数组的尾部，然后作为新数组返回，原数组不变。常用于连接多个数组</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">join</span>(separator) =&gt;string <span class="comment">// 以参数作为分隔符，将所有元素组成一个字符串返回。默认逗号。</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">slice</span>(begin[, end]) <span class="comment">// 返回指定位置的元素组成的新数组，原数组不变。第一个参数为起始位置（从 0 开始），第二个参数为终止位置（但该位置的元素本身不包括在内）。常用于截取数组中元素</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">splice</span>(index , howMany[, element1[, ...]]) <span class="comment">// 用新元素替换旧元素，返回值是被删除的元素，原数组改变。常用于删除数组中元素，注：Array.prototype.splice(0, 0, element) 相当于 Array.prototype.unshift(element)</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">reverse</span>() <span class="comment">// 用于颠倒数组中元素的顺序，原数组改变，并返回。</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">sort</span>() <span class="comment">// 对数组元素进行排序，默认是按照字典顺序排序，原数组改变，并返回。</span></span><br><span class="line"><span class="comment">// 如果想让 sort() 方法按照大小排序，可以传入一个函数作为参数，表示自定义排序。该函数本身又接受两个参数，表示进行比较的两个元素。如果返回值大于 0，表示第一个元素排在第二个元素后面；其他情况下，则相反。</span></span><br><span class="line">[<span class="number">10111</span>,<span class="number">1101</span>,<span class="number">111</span>].<span class="title function_">sort</span>(<span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a - b;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">valueOf</span>() <span class="comment">// 返回数组本身</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">toString</span>() <span class="comment">// 返回数组的字符串形式</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">ES5</span> 新增了 <span class="number">9</span> 个数组实例的方法，分别是 map、forEach、filter、every、some、reduce、reduceRight、indexOf 和 lastIndexOf。其中，前 <span class="number">7</span> 个与函数式编程（functional programming）有关。</span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">map</span>(<span class="keyword">function</span>(<span class="params">item, index, arr</span>)&#123;参数下同&#125;) <span class="comment">// 对所有元素依次调用一个函数，根据函数结果返回一个新数组。</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">forEach</span>() <span class="comment">// 对所有元素依次执行一个函数，它与 map 的区别在于不返回新数组，而是对原数组的成员执行某种操作，甚至可能改变原数组的值。</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">filter</span>() <span class="comment">// 依次对所有元素调用一个测试函数，返回结果为 true 的成员组成一个新数组返回。</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">some</span>() <span class="comment">// 对所有元素调用一个测试函数，只要有一个元素通过该测试，就返回 true，否则返回 false。</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">every</span>() <span class="comment">// 对所有元素调用一个测试函数，只有所有元素通过该测试，才返回 true，否则返回 false。</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">reduce</span>() 和 <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">reduceRight</span>() <span class="comment">// 是依次处理数组的每个元素，最终累计为一个值。这两个方法的差别在于，reduce 对数组元素的处理顺序是从左到右，reduceRight 则是从右到左，其他地方完全一样。</span></span><br><span class="line">    <span class="title function_">reduce</span>() 方法的第一个参数是一个处理函数。该函数接受四个参数，分别是：</span><br><span class="line">    <span class="number">1.</span> 用来累计的变量（即当前状态），默认值为数组第一个元素，所以 reduce 运行次数比前面 <span class="number">5</span> 个方法少一次，直接从第二个元素开始计算。</span><br><span class="line">    <span class="number">2.</span> 数组的当前元素</span><br><span class="line">    <span class="number">3.</span> 当前元素在数组中的序号（从 <span class="number">0</span> 开始）</span><br><span class="line">    <span class="number">4.</span> 原数组</span><br><span class="line">    这四个参数之中，只有前两个是必须的，后两个则是可选的。</span><br><span class="line">    <span class="title function_">reduce</span>() 方法的第二个参数可以设置累计变量的初始值。</span><br></pre></td></tr></table></figure>
<p>这些数组方法之中，有不少返回的还是数组，所以可以链式使用。</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">showArray</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> t1 = [<span class="number">0</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;three&quot;</span>, <span class="literal">false</span>];</span><br><span class="line">    <span class="keyword">var</span> t2 = [<span class="number">1</span>, <span class="string">&#x27;3&#x27;</span>];</span><br><span class="line">    <span class="keyword">var</span> t3 = t1.<span class="title function_">concat</span>(t2);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(t1);</span><br><span class="line">    t1.<span class="title function_">push</span>(<span class="number">3</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(t1);</span><br><span class="line">    <span class="keyword">var</span> a1 = t1[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">var</span> a2 = t1.<span class="title function_">shift</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a1 + <span class="string">&quot;==&quot;</span> + a2);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(t1);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">    <span class="keyword">var</span> b = a.<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">elem, index, arr</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> elem * elem;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line">    a.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">elem, index, arr</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (elem &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        arr[index] = elem += <span class="number">10</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> c = a.<span class="title function_">reduce</span>(<span class="keyword">function</span>(<span class="params">total, elem, index, arr</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> total + elem;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h3 id="创建函数的方法"><a href="#创建函数的方法" class="headerlink" title="创建函数的方法"></a>创建函数的方法</h3><ol start="0">
<li><p>声明式函数（函数声明 Function Declaration），return 用来结束函数执行，也可以返回结果。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;1&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>赋值式函数（函数表达式 Function Expression），函数名可选（如下 “fact”）。如果提供了可以用于函数的递归调用；如果没有就是个匿名函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> factorial = <span class="keyword">function</span> <span class="title function_">fact</span>(<span class="params">x</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> x &lt;= <span class="number">1</span> ? <span class="number">1</span> : x * <span class="title function_">fact</span>(x - <span class="number">1</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p> 递归非常耗费内存，因为需要同时保存成千上百个调用记录，很容易发生 “栈溢出”（stack overflow）错误。但对于尾递归来说，由于只存在一个调用记录，所以永远不会发生 “栈溢出” 错误。<br> 使用尾递归优化后：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> factor = <span class="keyword">function</span>(<span class="params">x, init</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> x &lt;= <span class="number">1</span> ? init : <span class="title function_">factor</span>(x - <span class="number">1</span>, x * init);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p> 声明式函数与赋值式函数的区别在于：在 Javascript 的预编译期，声明式函数将会先被提取出来，然后才按顺序执行 Javascript 代码。<br> 匿名函数还有另外一种方式创建 (在第一个括号内)，第二个括号用于调用该匿名函数，并传入参数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params">x, y</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x + y);</span><br><span class="line">&#125;)(<span class="number">2</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<p> 匿名函数最大的用途是创建闭包（这是 JavaScript 语言的特性之一），并且还可以构建命名空间，以减少全局变量的使用。</p>
</li>
<li><p>使用工厂方法（Function 构造函数），把参数列表和函数体都作为字符串，很不方便。这种方式效率比较低，不建议使用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo2 = <span class="keyword">new</span> <span class="title class_">Function</span>(<span class="string">&quot;x&quot;</span>, <span class="string">&quot;console.log(x);&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ol>
<p>另外，函数可以作为值传送，相当于方法②</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hoho = test;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;把函数传递给变量 &quot;</span> + hoho);</span><br><span class="line"><span class="keyword">var</span> haha = <span class="title function_">foo</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;执行函数并把函数返回结果传递给变量 &quot;</span> + haha);</span><br></pre></td></tr></table></figure>

<h3 id="函数的声明及参数"><a href="#函数的声明及参数" class="headerlink" title="函数的声明及参数"></a>函数的声明及参数</h3><p>JavaScript 引擎将函数名视同变量名，所以采用声明式函数时，整个函数会被提升到代码头部，如果先调用函数，再声明函数，也可以正确执行。但是，如果采用赋值式函数，JavaScript 就会报错。因此，如果同时采用声明式和赋值式定义同一个函数，最后总是采用赋值式的定义。</p>
<p>根据 ECMAScript 的规范，不能在条件语句中（if 和 try 语句）声明函数。</p>
<p>函数的 toString() 方法返回函数的源代码。</p>
<p>在函数内部可以使用 arguments 对象访问函数的实参（实际调用时传入的参数），arguments.callee 对象访问对应的原函数，而函数的 length 属性表示形参（函数定义时参数）个数。</p>
<blockquote>
<p>注：JavaScript 不会验证函数的参数个数，函数可以接受任何个数的参数（最多 25 个），实参少于形参的参数都会默认为 undefined，多余的参数则会被忽略<br>注：在严格模式下，禁止访问 arguments.callee</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">testFunc</span>(<span class="params">x</span>)&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">    x = <span class="number">10</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x, <span class="variable language_">arguments</span>[<span class="number">0</span>]);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;实参：&#x27;</span> + <span class="variable language_">arguments</span>.<span class="property">length</span> + <span class="string">&#x27;=== 形参：&#x27;</span> + <span class="variable language_">arguments</span>.<span class="property">callee</span>.<span class="property">length</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">testFunc</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;形参&quot;</span>+testFunc.<span class="property">length</span>+<span class="string">&quot;个&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>arguments 对象不是一个数组，尽管在语法上它有数组相关的属性 length。因此，无法对 arguments 对象使用标准的数组方法，比如 push、pop 或 slice。为了更好的使用数组方法，最好把它转化为一个真正的数组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>);</span><br></pre></td></tr></table></figure>

<h3 id="立即调用的函数表达式（IIFE）"><a href="#立即调用的函数表达式（IIFE）" class="headerlink" title="立即调用的函数表达式（IIFE）"></a>立即调用的函数表达式（IIFE）</h3><p>在 Javascript 中，一对圆括号 “()” 是一种运算符，跟在函数名之后，表示调用该函数。有时，我们需要在定义函数之后，立即调用该函数。可以这样写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="comment">/* code */</span>&#125;());</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="comment">/* code */</span>&#125;)();</span><br></pre></td></tr></table></figure>

<p>这样 JavaScript 引擎就知道，圆括号前面的部分不是函数定义语句，而是一个表达式，可以对此进行运算。这就叫做 “立即调用的函数表达式”（Immediately-Invoked Function Expression），简称 IIFE。</p>
<blockquote>
<p>注：结尾都必须加上分号。</p>
</blockquote>
<p>通常情况下，只对匿名函数使用这种 “立即执行的函数表达式”。它的目的有两个：一是不必为函数命名，避免了污染全局变量；二是 IIFE 内部形成了一个单独的作用域，可以封装一些外部无法读取的私有变量。</p>
<h3 id="函数作用域研究"><a href="#函数作用域研究" class="headerlink" title="函数作用域研究"></a>函数作用域研究</h3><ul>
<li>变量作用域：函数内部的参数和变量（使用 var 声明）为局部变量，其他都为全局变量。<br> var 命令声明的变量，不管在什么位置，变量声明都会被提升到函数体的头部。</li>
<li>函数作用域：函数本身也是一个值，也有自己的作用域。它的作用域绑定其声明时所在的作用域。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">bar</span>(); <span class="comment">// 会报错</span></span><br><span class="line"><span class="keyword">var</span> bar = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(someValue);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> someValue = <span class="number">42</span>;</span><br><span class="line"><span class="title function_">foo</span>(); <span class="comment">// 不会报错，因为声明式函数会提升到头部</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(someValue);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>来自 Nettuts + 的变量声明提升示例</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myvar = <span class="string">&#x27;my value&#x27;</span>;</span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(myvar); <span class="comment">// undefined</span></span><br><span class="line">    <span class="keyword">var</span> myvar = <span class="string">&#x27;local value&#x27;</span>;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>注：很多情况下，不想让 setTimeout（作为第一个参数的函数将会在全局作用域中执行）中的 this 指向 window，可以考虑这样写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scope = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;google&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> f = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    f.<span class="title function_">call</span>(scope);</span><br><span class="line">&#125;, <span class="number">100000</span>);</span><br></pre></td></tr></table></figure>
<p>这样 this 就指向 scope 了</p>
<p>setTimeout 作用域研究</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> tmx = <span class="number">4</span>,</span><br><span class="line">    timeoutObj = &#123;</span><br><span class="line">        <span class="attr">tmx</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="attr">bar</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> tmx = <span class="number">2</span>;</span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> tmx = <span class="number">1</span>; <span class="comment">// 注释后，会影响后面结果</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(tmx)</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">tmx</span>);</span><br><span class="line">            &#125;, <span class="number">1000</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(tmx)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">tmx</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">timeoutObj.<span class="title function_">bar</span>();</span><br></pre></td></tr></table></figure>

<p>给函数类扩展一个 bind() 方法（来源于 Prototype 框架），可以指定函数的作用域；它跟 call() 一样可以改变函数执行的上下文。不同之处在于 bind() 返回的是函数引用可以备用，而不是 call() 的立即执行而产生的最终结果</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">bind</span>) &#123;</span><br><span class="line">    <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">bind</span> = <span class="keyword">function</span>(<span class="params">obj</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> method = <span class="variable language_">this</span>, temp = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> method.<span class="title function_">apply</span>(obj, <span class="variable language_">arguments</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="函数闭包研究"><a href="#函数闭包研究" class="headerlink" title="函数闭包研究"></a>函数闭包研究</h3><p>闭包 closure，就是函数的嵌套，内层的函数可以使用外层函数的所有变量，即使外层函数已经执行完毕（这点涉及 JavaScript 作用域链）. 这是 JavaScript 中非常重要的一部分知识，因为使用闭包可以大大减少代码量，使代码看上去更加清晰等等</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">checkClosure</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">&#x27;demo&#x27;</span>;</span><br><span class="line">    <span class="built_in">setTimeout</span>(</span><br><span class="line">        <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(str); &#125; <span class="comment">// 这是一个匿名函数</span></span><br><span class="line">    , <span class="number">20000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">checkClosure</span>();</span><br></pre></td></tr></table></figure>
<p>分析下闭包的执行过程是有许多知识点的：checkClosure 函数的执行是瞬间的（也许用时只是 0.00001 毫秒），在 checkClosure 的函数体内创建了一个变量 str，在 checkClosure 执行完毕之后 str 并没有被释放，这是因为 setTimeout 内的匿名函数存在这对 str 的引用。待到 20 秒后函数体内的匿名函数被执行完毕, str 才被释放。</p>
<ul>
<li>闭包的应用——优化代码：下面的 delay 函数十分难以阅读，也不容易编写，但如果使用闭包就可以让代码更加清晰<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">forTimeout</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x + y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">delay</span>(<span class="params">x, y, time</span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&#x27;forTimeout(&#x27;</span> +  x + <span class="string">&#x27;,&#x27;</span> +  y + <span class="string">&#x27;)&#x27;</span> , time); <span class="comment">// 注：setTimeout 支持第一个参数为字符串的这个特性尽量不要使用，因为它在内部使用了 eval。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  优化后：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">forTimeout</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x + y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">delay</span>(<span class="params">x, y, time</span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">forTimeout</span>(x, y)</span><br><span class="line">    &#125;, time);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>闭包的应用——减少全局变量：下面代码中函数 addEvent 和 removeEvent 都是局部变量，但可以通过全局变量 oEvent 使用它，这就大大减少了全局变量的使用，增强了网页的安全性<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> oEvent = &#123;&#125;;</span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">addEvent</span>(<span class="params"></span>)&#123;&#125;;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">removeEvent</span>(<span class="params"></span>)&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    oEvent.<span class="property">addEvent</span> = addEvent;</span><br><span class="line">    oEvent.<span class="property">removeEvent</span> = removeEvent;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure></li>
<li>闭包的应用——访问局部变量：下面代码中的变量 one 是一个局部变量（因为它被定义在一个函数之内），因此外部是不可以访问的。但是这里创建了 inner 函数，inner 函数是可以访问变量 one 的；又将全局变量 outer 引用了 inner，所以三次调用 outer 会弹出递增的结果。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> outer;</span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> one = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">inner</span> ()&#123;</span><br><span class="line">        one += <span class="number">1</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(one);</span><br><span class="line">    &#125;</span><br><span class="line">    outer = inner;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="title function_">outer</span>();    <span class="comment">//2</span></span><br><span class="line"><span class="title function_">outer</span>();    <span class="comment">//3</span></span><br><span class="line"><span class="title function_">outer</span>();    <span class="comment">//4</span></span><br></pre></td></tr></table></figure></li>
<li>闭包的应用——小技巧：创建了一个变量 demo，并通过直接调用匿名函数初始化为 5，这种小技巧有时十分实用。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> demo = (<span class="keyword">function</span>(<span class="params">x , y</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;)(<span class="number">2</span> , <span class="number">3</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="eval-命令"><a href="#eval-命令" class="headerlink" title="eval 命令"></a>eval 命令</h2><p>eval 命令的作用是，将字符串当作语句执行。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;var a = 1;&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>上面代码将字符串当作语句运行，生成了变量 a。</p>
<p>放在 eval 中的字符串，应该有独自存在的意义，不能用来与 eval 以外的命令配合使用。举例来说，下面的代码将会报错。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;return;&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>由于 eval 没有自己的作用域，都在当前作用域内执行，因此可能会修改其他外部变量的值，造成安全问题。<br>所以 eval 有安全风险，无法做到作用域隔离，最好不要使用。此外，eval 的命令字符串不会得到 JavaScript 引擎的优化，运行速度较慢，也是另一个不应该使用它的理由。</p>
<p>通常情况下，eval 最常见的场合是解析 JSON 数据字符串，正确的做法是应该使用浏览器提供的 JSON.parse() 方法。</p>
<h2 id="其他特殊对象"><a href="#其他特殊对象" class="headerlink" title="其他特殊对象"></a>其他特殊对象</h2><h3 id="Math-对象"><a href="#Math-对象" class="headerlink" title="Math 对象"></a>Math 对象</h3><p>是 JavaScript 的内置对象，提供一系列数学常数和数学方法。<br>该对象不是构造函数，所以不能生成实例，所有的属性和方法都必须在 Math 对象上调用。</p>
<h4 id="常用常数"><a href="#常用常数" class="headerlink" title="常用常数"></a>常用常数</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Math</span>.<span class="property">E</span> <span class="comment">// 2.718281828459045</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">LN2</span> <span class="comment">// 0.6931471805599453</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">LN10</span> <span class="comment">// 2.302585092994046</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">LOG2E</span> <span class="comment">// 1.4426950408889634</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">LOG10E</span> <span class="comment">// 0.4342944819032518</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">PI</span> <span class="comment">// 3.141592653589793</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">SQRT1_2</span> <span class="comment">// 0.7071067811865476</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">SQRT2</span> <span class="comment">// 1.4142135623730951</span></span><br></pre></td></tr></table></figure>
<h4 id="常用方法-2"><a href="#常用方法-2" class="headerlink" title="常用方法"></a>常用方法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Math</span>.<span class="title function_">round</span>(num) <span class="comment">// 四舍五入</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">abs</span>(num) <span class="comment">// 返回参数值的绝对值</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">max</span>(([value1[, value2[, ...]]]) <span class="comment">// 返回最大的参数</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">min</span>(([value1[, value2[, ...]]]) <span class="comment">// 返回最小的参数</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">floor</span>(num) <span class="comment">// 返回小于参数值的最大整数</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">ceil</span>(num) <span class="comment">// 返回大于参数值的最小整数</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">pow</span>(base, exponent) <span class="comment">// 返回第一个参数为底数、第二个参数为幂的指数值</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">sqrt</span>(num) <span class="comment">// 返回参数值的平方根。如果参数是一个负值，则返回 NaN。</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">random</span>() <span class="comment">// 返回 0 &lt;= x &lt; 1 之间的一个伪随机数</span></span><br></pre></td></tr></table></figure>

<h3 id="Date-对象"><a href="#Date-对象" class="headerlink" title="Date 对象"></a>Date 对象</h3><p>是 JavaScript 提供的日期和时间的操作接口。它有多种用法。<br>0. Date() 生成当前时间的字符串<br>0. new Date(params) 作为一个构造函数，会返回一个 Date 对象的实例。没有参数的话，默认为当前时间。<br>    参数为 milliseconds 时，传入一个数值，表示为从 1970 年 1 月 1 日 00:00:00 UTC 开始计算的毫秒。Date 对象能够表示的日期范围是 1970 年 1 月 1 日前后各一亿天。<br>    参数为 datestring 时，传入一个可以被 Date.parse() 方法解析的日期字符串，表示对应的日期<br>    参数为 year, month [, day, hours, minutes, seconds, ms] 时，在多个参数的情况下，Date 对象将其分别视作对应的年、月、日、小时、分钟、秒和毫秒，年月必填，其他默认为 0</p>
<p>类型转换时，Date 对象的实例如果转为数值，则等于对应的毫秒数；如果转为字符串，则等于对应的日期字符串。所以，两个日期对象进行减法运算，返回的就是它们间隔的毫秒数；进行加法运算，返回的就是连接后的两个字符串。</p>
<h4 id="常用方法-3"><a href="#常用方法-3" class="headerlink" title="常用方法"></a>常用方法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Date</span>.<span class="title function_">now</span>() <span class="comment">// 返回当前距离 1970 年 1 月 1 日 00:00:00 UTC 的毫秒数</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="title function_">parse</span>(str)：用来解析日期字符串，返回距离 <span class="number">1970</span> 年 <span class="number">1</span> 月 <span class="number">1</span> 日 <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> 的毫秒数。日期字符串的格式应该完全或者部分符合 <span class="variable constant_">RFC</span> <span class="number">2822</span> 和 <span class="variable constant_">ISO</span> <span class="number">8061</span>，即 <span class="variable constant_">YYYY</span>-<span class="variable constant_">MM</span>-<span class="attr">DDTHH</span>:<span class="attr">mm</span>:ss.<span class="property">sssZ</span> 格式，其中最后的 Z 表示时区，是可选的。</span><br><span class="line"><span class="title class_">Date</span>.<span class="title function_">UTC</span>() <span class="comment">// 默认情况下，Date 对象返回的都是当前时区的时间。Date.UTC 方法可以返回 UTC 时间（世界标准时间）。该方法接受年、月、日等变量作为参数，返回当前距离 1970 年 1 月 1 日 00:00:00 UTC 的毫秒数。</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">toString</span>() <span class="comment">// 返回一个完整的时间字符串。</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">toLocaleString</span>() <span class="comment">// 返回一个字符串，代表日期和时间的当地写法。</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">getTime</span>() <span class="comment">// 返回实例对象距离 1970 年 1 月 1 日 00:00:00 的毫秒数，等同于 valueOf() 方法。</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">getFullYear</span>() <span class="comment">// 返回四位的年份。</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">getMonth</span>() <span class="comment">// 返回月份（0 表示 1 月，11 表示 12 月）。</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">getDate</span>() <span class="comment">// 返回日期（从 1 开始）。</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">getDay</span>() <span class="comment">// 返回星期（0 表示周日，1 表示周一）。</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">getHours</span>() <span class="comment">// 返回小时（0-23）。</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">getMinutes</span>() <span class="comment">// 返回分钟（0-59）。</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">getSeconds</span>() <span class="comment">// 返回秒（0-59）。</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">getMilliseconds</span>() <span class="comment">// 返回毫秒（0-999）。</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">getTimezoneOffset</span>() <span class="comment">// 返回当前时间与 UTC 的时区差异，以分钟表示，返回结果考虑到了夏令时因素。</span></span><br><span class="line">上面的 get 方法也有对应的 set 方法</span><br><span class="line"></span><br><span class="line"><span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">toJSON</span>() <span class="comment">// 返回 JSON 格式的日期对象。</span></span><br><span class="line">    <span class="keyword">var</span> t = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2004-05-06&#x27;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(t.<span class="title function_">toString</span>());</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Date</span>());</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>());</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(t.<span class="title function_">getTime</span>());</span><br><span class="line">    <span class="keyword">var</span> json = (<span class="keyword">new</span> <span class="title class_">Date</span>()).<span class="title function_">toJSON</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(json);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Date</span>.<span class="title function_">parse</span>(json));</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="string">&#x27;2004-05-06&#x27;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="RegExp-对象"><a href="#RegExp-对象" class="headerlink" title="RegExp 对象"></a>RegExp 对象</h3><p>正则表达式（regular expression）是一种表达文本模式的方法，常常用作按照 “给定模式” 匹配文本的工具。JavaScript 的正则表达式体系是参照 Perl 5 建立的。</p>
<p>新建正则表达式有两种方法。<br>0. 一种是使用字面量，以斜杠表示开始和结束 &#x2F;xyz&#x2F;i<br>0. 另一种是使用 RegExp 构造函数 new RegExp(“xyz”, “i”); 第二个参数，表示修饰符（i 表示忽略大小写，g 表示全局匹配，m 表示支持多行）</p>
<p>正则对象生成后有两种使用方法：<br>0. 使用正则对象本身的方法，将字符串作为参数，如 regex.test(str)<br>0. 使用字符串对象的方法，将正则对象作为参数，如 str.match(regex)</p>
<h4 id="常用方法-4"><a href="#常用方法-4" class="headerlink" title="常用方法"></a>常用方法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">RegExp</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">test</span>(str) <span class="comment">// 返回布尔值，用来验证字符串是否符合某个模式。</span></span><br><span class="line"><span class="title class_">RegExp</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">exec</span>(str) <span class="comment">// 返回匹配结果。与 String.prototype.match 类似</span></span><br></pre></td></tr></table></figure>
<h4 id="匹配规则"><a href="#匹配规则" class="headerlink" title="匹配规则"></a>匹配规则</h4><ul>
<li>一般字符属于 “字面量字符”（literal characters）。</li>
<li>一些特殊字符属于 “元字符”（metacharacters）<ul>
<li>点字符（.）匹配除回车（\r）、换行 (\n) 、行分隔符（\u2028）和段分隔符（\u2029）以外的所有单个字符。</li>
<li>位置字符<br>  ^ 表示字符串的行首。<br>  $ 表示字符串的行尾。</li>
<li>选择符（|）在正则表达式中表示 “或关系”（OR）</li>
</ul>
</li>
<li>字符类（class）表示有一系列字符可供选择，只要匹配其中一个就可以了。所有可供选择的字符都放在方括号内。<ul>
<li>脱字符（^）：如果方括号内的第一个字符是 [^]，则表示除了字符类之中的字符，其他字符都可以匹配。如果方括号内没有其他字符，即只有 [^]，就表示匹配一切字符，其中包括换行符，而点号（.）是不包括换行符的。</li>
<li>连字符（-）：某些情况下，对于连续序列的字符，用来提供简写形式。比如，[abc] 可以写成 [a-c]，[0123456789] 可以写成 [0-9]，同理 [A-Z] 表示 26 个大写字母。</li>
</ul>
</li>
<li>重复类 {} 表示模式的重复次数。<br>  {n} 表示重复 n 次。<br>  {n,} 表示至少重复 n 次。<br>  {n,m} 表示重复不少于 n 次，不多于 m 次。</li>
<li>量词符<br>  ? 表示某个模式出现 1 次或 0 次，等同于 {0, 1}。 最多 1 次<br>  * 表示某个模式出现 0 次或多次，等同于 {0,}。 可有可无<br>  + 表示某个模式出现 1 次或多次，等同于 {1,}。 最少 1 次<br>  默认为贪婪模式，可以在量词符后面加一个问号，可以改为非贪婪模式 &#x2F;a+?&#x2F; 将会只匹配 “a”。<br>  *?：表示某个模式出现 0 次或多次，匹配时采用非贪婪模式。<br>  +?：表示某个模式出现 1 次或多次，匹配时采用非贪婪模式。</li>
<li>转义符<br>  正则表达式中那些有特殊含义的字符，如果要匹配它们本身，就需要在它们前面要加上反斜杠。<br>  需要用斜杠转义的，一共有 12 个字符：^ . [$ () | * + ? { \。需要特别注意的是，如果使用 RegExp 方法生成正则对象，转义需要使用两个斜杠，因为字符串内部会先转义一次。</li>
<li>预定义模式<br>  指的是某些常见模式的简写方式。<br>  \d 匹配 0-9 之间的任一数字，相当于 [0-9]<br>  \D 匹配所有 0-9 以外的字符，相当于 [^0-9]<br>  \w 匹配任意的字母、数字和下划线，相当于 [A-Za-z0-9_]<br>  \W 除所有字母、数字和下划线以外的字符，相当于 &#x2F;[^A-Za-z0-9_]&#x2F;<br>  \s 匹配空格（包括制表符、空格符、断行符等），相等于 [\t\r\n\v\f]<br>  \S 匹配非空格的字符，相当于 [^\t\r\n\v\f]<br>  \b 匹配词的边界。<br>  \B 匹配非词边界，即在词的内部。</li>
<li>特殊字符<br>  对一些不能打印的特殊字符，提供了表达形式。<br>  \cX 表示 Ctrl-X<br>  [\b] 匹配退格键 (U+0008)，不要与 \ b 混淆<br>  \n 匹配换行键<br>  \r 匹配回车键<br>  \t 匹配制表符 tab（U+0009）<br>  \v 匹配垂直制表符（U+000B）<br>  \f 匹配换页符（U+000C）<br>  \0 匹配 null 字符（U+0000）<br>  \xhh 匹配一个以两位十六进制数表示的字符<br>  \uhhhh 匹配一个以四位十六进制数表示的 unicode 字符</li>
</ul>
<h4 id="常用正则表达式"><a href="#常用正则表达式" class="headerlink" title="常用正则表达式"></a>常用正则表达式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 以数字开头后面跟 . 的行</span></span><br><span class="line">[<span class="number">0</span>-<span class="number">9</span>]&#123;<span class="number">1</span>,<span class="number">3</span>&#125;[.]</span><br><span class="line">^\d+\.\s*</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以 // 开头，包含 () 的行</span></span><br><span class="line">^\/\/.*\(.*\)</span><br></pre></td></tr></table></figure>

<h3 id="JSON-对象"><a href="#JSON-对象" class="headerlink" title="JSON 对象"></a>JSON 对象</h3><p><a target="_blank" rel="noopener" href="http://www.json.org/json-zh.html">JSON</a> 格式（JavaScript Object Notation）是一种用于数据交换的文本格式，2001 年由 Douglas Crockford 提出，目的是取代繁琐笨重的 XML 格式。<br>相比 XML 格式，JSON 格式有两个显著的优点：书写简单，一目了然；符合 JavaScript 原生语法，可以由解释引擎直接处理，不用另外添加代码。所以，JSON 迅速被接受，并成为 ES5 标准的一部分。</p>
<p>简单说，JSON 格式就是一种表示一系列的 “值” 的方法，这些值包含在数组或对象之中，是它们的成员。</p>
<p>JSON 有如下几点格式规定：</p>
<ul>
<li>数组或对象的每个成员的值，可以是简单值，也可以是复合值。</li>
<li>简单值分为四种：字符串、数值（必须以十进制表示）、布尔值和 null（NaN, Infinity, -Infinity 和 undefined 都会被转为 null）。</li>
<li>复合值分为两种：符合 JSON 格式的对象和符合 JSON 格式的数组。</li>
<li>数组或对象最后一个成员的后面，不能加逗号。</li>
<li>数组或对象之中的字符串必须使用双引号，不能使用单引号。</li>
<li>对象的成员名称必须使用双引号。</li>
</ul>
<h4 id="常用方法-5"><a href="#常用方法-5" class="headerlink" title="常用方法"></a>常用方法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj) <span class="comment">// 用于将一个值转为字符串。该字符串符合 JSON 格式，并且可以被 JSON.parse 方法还原。如果处理的对象，包含一个 toJSON 方法，则会优先使用这个方法得到一个值，然后再转成字符串，而忽略其他成员。</span></span><br><span class="line"><span class="keyword">var</span> json = &#123;</span><br><span class="line">  <span class="string">&quot;toJSON&quot;</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;a&quot;</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="string">&quot;b&quot;</span>: <span class="string">&#x27;cool&#x27;</span>,</span><br><span class="line">  <span class="string">&quot;c&quot;</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(json)</span><br><span class="line"></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">parse</span>(str) <span class="comment">// 用于将 JSON 字符串转化成对象。</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">可口可乐</p>
  <div class="site-description" itemprop="description">Personal Blog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">53</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">可口可乐</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
